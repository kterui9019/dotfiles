var me=Object.create;var _=Object.defineProperty;var ye=Object.getOwnPropertyDescriptor;var be=Object.getOwnPropertyNames;var Pe=Object.getPrototypeOf,we=Object.prototype.hasOwnProperty;var B=t=>_(t,"__esModule",{value:!0});var W=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Re=(t,e)=>{for(var n in e)_(t,n,{get:e[n],enumerable:!0})},K=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of be(e))!we.call(t,i)&&(n||i!=="default")&&_(t,i,{get:()=>e[i],enumerable:!(r=ye(e,i))||r.enumerable});return t},q=(t,e)=>K(B(_(t!=null?me(Pe(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t),xe=(t=>(e,n)=>t&&t.get(e)||(n=K(B({}),e,1),t&&t.set(e,n),n))(typeof WeakMap!="undefined"?new WeakMap:0);var U=W(R=>{R.parse=R.decode=Se;R.stringify=R.encode=N;R.safe=O;R.unsafe=k;var T=typeof process<"u"&&process.platform==="win32"?`\r
`:`
`;function N(t,e){var n=[],r="";typeof e=="string"?e={section:e,whitespace:!1}:(e=e||{},e.whitespace=e.whitespace===!0);var i=e.whitespace?" = ":"=";return Object.keys(t).forEach(function(s,o,c){var u=t[s];u&&Array.isArray(u)?u.forEach(function(f){r+=O(s+"[]")+i+O(f)+`
`}):u&&typeof u=="object"?n.push(s):r+=O(s)+i+O(u)+T}),e.section&&r.length&&(r="["+O(e.section)+"]"+T+r),n.forEach(function(s,o,c){var u=D(s).join("\\."),f=(e.section?e.section+".":"")+u,a=N(t[s],{section:f,whitespace:e.whitespace});r.length&&a.length&&(r+=T),r+=a}),r}function D(t){return t.replace(/\1/g,"LITERAL\\1LITERAL").replace(/\\\./g,"").split(/\./).map(function(e){return e.replace(/\1/g,"\\.").replace(/\2LITERAL\\1LITERAL\2/g,"")})}function Se(t){var e={},n=e,r=null,i=/^\[([^\]]*)\]$|^([^=]+)(=(.*))?$/i,s=t.split(/[\r\n]+/g);return s.forEach(function(o,c,u){if(!(!o||o.match(/^\s*[;#]/))){var f=o.match(i);if(!!f){if(f[1]!==void 0){if(r=k(f[1]),r==="__proto__"){n={};return}n=e[r]=e[r]||{};return}var a=k(f[2]);if(a!=="__proto__"){var p=f[3]?k(f[4]):!0;switch(p){case"true":case"false":case"null":p=JSON.parse(p)}if(a.length>2&&a.slice(-2)==="[]"){if(a=a.substring(0,a.length-2),a==="__proto__")return;n[a]?Array.isArray(n[a])||(n[a]=[n[a]]):n[a]=[]}Array.isArray(n[a])?n[a].push(p):n[a]=p}}}}),Object.keys(e).filter(function(o,c,u){if(!e[o]||typeof e[o]!="object"||Array.isArray(e[o]))return!1;var f=D(o),a=e,p=f.pop(),h=p.replace(/\\\./g,".");return f.forEach(function(d,y,g){d!=="__proto__"&&((!a[d]||typeof a[d]!="object")&&(a[d]={}),a=a[d])}),a===e&&h===p?!1:(a[h]=e[o],!0)}).forEach(function(o,c,u){delete e[o]}),e}function J(t){return t.charAt(0)==='"'&&t.slice(-1)==='"'||t.charAt(0)==="'"&&t.slice(-1)==="'"}function O(t){return typeof t!="string"||t.match(/[=\r\n]/)||t.match(/^\[/)||t.length>1&&J(t)||t!==t.trim()?JSON.stringify(t):t.replace(/;/g,"\\;").replace(/#/g,"\\#")}function k(t,e){if(t=(t||"").trim(),J(t)){t.charAt(0)==="'"&&(t=t.substr(1,t.length-2));try{t=JSON.parse(t)}catch{}}else{for(var n=!1,r="",i=0,s=t.length;i<s;i++){var o=t.charAt(i);if(n)"\\;#".indexOf(o)!==-1?r+=o:r+="\\"+o,n=!1;else{if(";#".indexOf(o)!==-1)break;o==="\\"?n=!0:r+=o}}return n&&(r+="\\"),r.trim()}return t}});var M=W((Je,H)=>{"use strict";var V=require("fs"),z=require("os"),L=require("path");H.exports=function(t,e){typeof t!="string"&&(e=t,t=null);let n=Object.assign({cwd:process.cwd(),type:t},e),r;if(n.type==="global"?r=L.join(z.homedir(),".gitconfig"):r=L.resolve(n.cwd,".git/config"),!V.existsSync(r)){if(typeof n.type=="string")return null;r=L.join(z.homedir(),".config/git/config")}return V.existsSync(r)?r:null}});var te=W((Ue,ee)=>{"use strict";var $=require("fs"),Oe=require("os"),v=require("path"),Q=require("util"),ve=U(),$e=M(),X=t=>t?t.replace(/^~/,Oe.homedir()):"",m=(t,e)=>(typeof t=="function"&&(e=t,t=null),typeof e!="function"?m.promise(t):m.promise(t).then(n=>e(null,n)).catch(e));m.promise=t=>{let e=m.resolveConfigPath(t),n=Q.promisify($.readFile),r=Q.promisify($.stat);return e?r(e).then(()=>n(e,"utf8")).then(i=>(t&&t.include===!0&&(i=Z(i,v.resolve(v.dirname(e)))),Y(i,t))):Promise.resolve(null)};m.sync=t=>{let e=m.resolveConfigPath(t);if(e&&$.existsSync(e)){let n=$.readFileSync(e,"utf8");if(t&&t.include===!0){let r=v.resolve(v.dirname(e));n=Z(n,r)}return Y(n,t)}return{}};m.resolveConfigPath=t=>{typeof t=="string"&&(t={type:t});let e=Object.assign({cwd:process.cwd()},t),n=e.path?X(e.path):$e(e.type);return n?v.resolve(e.cwd,n):null};m.resolve=t=>m.resolveConfigPath(t);m.expandKeys=t=>{for(let e of Object.keys(t)){let n=/(\S+) "(.*)"/.exec(e);if(!n)continue;let r=n[1];t[r]=t[r]||{},t[r][n[2]]=t[e],delete t[e]}return t};function Y(t,e){let n=Object.assign({},e);t=t.replace(/\[(\S+) "(.*)"\]/g,(i,s,o)=>s&&o?`[${s} "${o.split(".").join("\\.")}"]`:i);let r=ve.parse(t);return n.expandKeys===!0?m.expandKeys(r):r}function Z(t,e){let n=t.split(`
`).filter(s=>s.trim()!==""),r=n.length,i=[];for(let s=0;s<r;s++){let o=n[s];if(o.indexOf("[include]")===0){let c=n[s+1].replace(/^\s*path\s*=\s*/,""),u=v.resolve(e,X(c));i.push($.readFileSync(u))}else i.push(o)}return i.join(`
`)}ee.exports=m});var se=W((Ve,oe)=>{"use strict";var ne=require("url"),re={};oe.exports=function(e){return re[e]||(re[e]=_e(e))};function _e(t){if(typeof t!="string"||!t.length||t.indexOf("git@gist")!==-1||t.indexOf("//gist")!==-1)return null;var e=ne.parse(t);if(typeof e.path!="string"||!e.path.length||typeof e.pathname!="string"||!e.pathname.length)return null;!e.host&&/^git@/.test(t)===!0&&(e.host=ne.parse("http://"+t).host),e.path=ie(e.path),e.pathname=ie(e.pathname),e.filepath=null,e.path.indexOf("repos")===0&&(e.path=e.path.slice(6));var n=e.path.split("/").filter(Boolean),r=n[2]==="blob";r&&!We(n[3])&&(e.branch=n[3],n.length>4&&(e.filepath=n.slice(4).join("/")));var i=t.indexOf("blob");i!==-1&&(e.blob=t.slice(i+5));var s=t.indexOf("tree");if(s!==-1){var o=s+5,c=t.slice(o),u=c.indexOf("/");u!==-1&&(c=c.slice(0,u)),e.branch=c}if(e.owner=Ie(n[0]),e.name=Ce(n[1]),n.length>1&&e.owner&&e.name)e.repo=e.owner+"/"+e.name;else{var f=e.href.split(":");if(f.length===2&&e.href.indexOf("//")===-1){e.repo=e.repo||f[f.length-1];var a=e.repo.split("/");e.owner=a[0],e.name=a[1]}else{var p=e.href.match(/\/([^\/]*)$/);e.owner=p?p[1]:null,e.repo=null}if(e.repo&&(!e.owner||!e.name)){var h=e.repo.split("/");h.length===2&&(e.owner=h[0],e.name=h[1])}}return e.branch||(e.branch=n[2]||ke(e.path,e),n.length>3&&(e.filepath=n.slice(3).join("/"))),e.host=e.host||"github.com",e.owner=e.owner||null,e.name=e.name||null,e.repository=e.repo,e}function We(t){return/^[a-f0-9]{40}$/i.test(t)}function ke(t,e){var n=t.split("#"),r;return n.length>1&&(r=n[n.length-1]),!r&&e.hash&&e.hash.charAt(0)==="#"&&(r=e.hash.slice(1)),r||"master"}function ie(t){return t.charAt(0)==="/"?t.slice(1):t}function Ce(t){return t?t.replace(/^\W+|\.git$/g,""):null}function Ie(t){if(!t)return null;var e=t.indexOf(":");return e>-1?t.slice(e+1):t}});var qe={};Re(qe,{default:()=>he});var l=require("@raycast/api"),pe=require("react");var P=require("@raycast/api"),x=require("react"),C=require("os"),S=q(require("path")),b=q(require("fs")),ae=require("util"),ce=require("child_process"),j=(0,ae.promisify)(ce.exec),Te=te(),Le=se(),A=S.default.join(P.environment.supportPath,"cache.json"),E=class{constructor(){Ge(),this.repos=[];try{b.default.accessSync(A,b.default.constants.R_OK)}catch{return}let e=b.default.readFileSync(A).toString();if(e.length>0){let n=JSON.parse(e);this.repos=n.repos}}save(){let e=JSON.stringify(this,null,2)+`
`;b.default.writeFileSync(A,e)}setRepos(e){this.repos=e}clear(){this.repos=[],this.save()}};function Ae(t){return t.length>0&&t[0]==="~"?S.default.join((0,C.homedir)(),t.slice(1)):t}function le(t){let e=S.default.normalize(t)+S.default.sep;return(e.indexOf((0,C.homedir)())===0?e.replace((0,C.homedir)()+S.default.sep,`~${S.default.sep}`):e).slice(0,-1)}function Ge(){b.default.mkdirSync(P.environment.supportPath,{recursive:!0})}async function je(){return(0,P.getPreferenceValues)()}function ue(t){let e=[],n=Te.sync({cwd:t,path:".git/config",expandKeys:!0});if(n.remote!=null)for(let r in n.remote){let i=n.remote[r],s=Le(i.url);s?.host&&s?.repo&&(e=e.concat({name:r,host:s?.host,url:`https://${s?.host}/${s?.repo}`}))}return e}function Ee(t){let e=[],n=[];return t.split(":").map(i=>{if(i=i.trim(),i.length===0)return;let s=Ae(i.trim());try{b.default.accessSync(s,b.default.constants.R_OK),e.push(s)}catch{n.push(i)}}),[e,n]}function G(t,e,n=!1){return n?e.filter(r=>b.default.existsSync(r)).map(r=>{let i=r;return{name:`${i.split("/").pop()??"unknown"}`,icon:"git-submodule-icon.png",fullPath:i}}):e.map(r=>{let i=r.replace("/.git","");return{name:i.split("/").pop()??"unknown",icon:"git-icon.png",fullPath:i}})}async function Fe(t,e,n){let r=new E,i=[];return await Promise.allSettled(t.map(async s=>{let o=`find -L ${s} -maxdepth ${e} -name .git -type d`,{stdout:c,stderr:u}=await j(o);if(u)return(0,P.showToast)(P.Toast.Style.Failure,"Find Failed",u),console.error(`error: ${u}`),[];let f=c.split(`
`).filter(h=>h),a=G(s,f,!1);if(n){let h=[];await Promise.allSettled(a.map(async y=>{let g=await Be(y.fullPath);g.length>0&&(h=h.concat(g))}));let d=G(s,h,!0);i=i.concat(a.concat(d))}else i=i.concat(a);(await Ke(s,e)).forEach(function(h){i.findIndex(y=>y.fullPath===h.fullPath)===-1&&i.push(h)})})),i.sort((s,o)=>{let c=s.name.toLowerCase(),u=o.name.toLowerCase();return c<u?-1:c>u?1:0}),r.setRepos(i),r.save(),i}async function Be(t){let{stdout:e}=await j(`grep "\\[submodule"  ${t+"/.gitmodules"} | sed "s%\\[submodule \\"%\${1%/.git}/%g" | sed "s/\\"]//g"`);return e.split(`
`).filter(i=>i).map(i=>`${t}${i}`)}async function Ke(t,e){let n=[],r=`find -L ${t} -maxdepth ${e} -name .git -type f`,{stdout:i,stderr:s}=await j(r);if(!s){let o=i.split(`
`).filter(u=>u),c=G(t,o,!1);n=n.concat(c),n.map(u=>u.icon="git-worktree-icon.png")}return n}function fe(t){let[e,n]=(0,x.useState)(),[r,i]=(0,x.useState)(),[s,o]=(0,x.useState)(!0),[c,u]=(0,x.useState)(!1),f=new E,a=!1,p=f.repos;function h(d,y){return d.filter(g=>g.name.toLocaleLowerCase().includes(y.toLowerCase()))}return(0,x.useEffect)(()=>{async function d(){if(!(a||c)){i(void 0);try{let g=await je();if(g.repoScanPath.length==0){i("Directories to scan has not been defined in settings");return}let[de,I]=Ee(g.repoScanPath);I.length>0&&i(`Director${I.length===1?"y":"ies"} not found: ${I}`);let ge=await Fe(de,g.repoScanDepth??3,g.includeSubmodules??!1);if(!a){let w=ge,F=`${w.length} Repo${w.length!=1?"s":""}`;t&&t?.length>0&&(w=h(w,t),F=`${w.length} Repo${w.length!=1?"s":""} Found`),n({sectionTitle:F,repos:w}),u(!0)}}catch(g){a||i(g)}finally{a||o(!1)}}}let y=`${p.length} Repo${p.length!=1?"s":""}`;return t&&t.length>0&&(p=h(p,t),y=`${p.length} Repo${p.length!=1?"s":""} Found`),f.repos.length>0&&n({sectionTitle:y,repos:p}),c||d(),()=>{a=!0}},[t]),{response:e,error:r,isLoading:s}}function he(){let t=(0,l.getPreferenceValues)(),[e,n]=(0,pe.useState)(),{response:r,error:i,isLoading:s}=fe(e);return i&&(0,l.showToast)(l.Toast.Style.Failure,"",i),_jsx(l.List,{onSearchTextChange:n,isLoading:s},_jsx(l.List.Section,{title:r?.sectionTitle},r?.repos?.map(o=>_jsx(l.List.Item,{key:o.fullPath,id:o.fullPath,title:o.name,icon:o.icon,accessoryTitle:le(o.fullPath),keywords:[o.name],actions:_jsx(l.ActionPanel,null,_jsx(l.ActionPanel.Section,null,_jsx(l.Action.Open,{title:`Open in ${t.openWith1.name}`,icon:{fileIcon:t.openWith1.path},target:o.fullPath,application:t.openWith1.bundleId}),_jsx(l.Action.Open,{title:`Open in ${t.openWith2.name}`,icon:{fileIcon:t.openWith2.path},target:o.fullPath,application:t.openWith2.bundleId}),t.openWith3&&_jsx(l.Action.Open,{title:`Open in ${t.openWith3.name}`,icon:{fileIcon:t.openWith3.path},target:o.fullPath,application:t.openWith3.bundleId,shortcut:{modifiers:["opt"],key:"return"}}),t.openWith4&&_jsx(l.Action.Open,{title:`Open in ${t.openWith4.name}`,icon:{fileIcon:t.openWith4.path},target:o.fullPath,application:t.openWith4.bundleId,shortcut:{modifiers:["ctrl"],key:"return"}}),t.openWith5&&_jsx(l.Action.Open,{title:`Open in ${t.openWith5.name}`,icon:{fileIcon:t.openWith5.path},target:o.fullPath,application:t.openWith5.bundleId,shortcut:{modifiers:["shift"],key:"return"}}),_jsx(l.Action.OpenWith,{path:o.fullPath,shortcut:{modifiers:["cmd"],key:"o"}})),_jsx(l.ActionPanel.Section,null,ue(o.fullPath).map(c=>{let u;switch(c.name){case"origin":u={modifiers:["shift","cmd"],key:"o"};break;case"upstream":u={modifiers:["shift","cmd"],key:"u"};break;default:break}let f,a=c.host;switch(c.host){case"github.com":f={source:"github-icon.png",tintColor:l.Color.PrimaryText},a="GitHub";break;case"gitlab.com":f={source:"gitlab-icon.png",tintColor:l.Color.PrimaryText},a="GitLab";break;case"bitbucket.org":f={source:"bitbucket-icon.png",tintColor:l.Color.PrimaryText},a="Bitbucket";break;default:break}return c.host==="github.com"?_jsx(l.ActionPanel.Submenu,{title:`Open ${c.name} on ${a}`,key:`GitHub_${c.name}`,icon:f??l.Icon.Globe,shortcut:u},_jsx(l.Action.OpenInBrowser,{title:"Code",key:`code ${c.name}`,url:c.url,icon:{source:"github-code-icon.png",tintColor:l.Color.PrimaryText},shortcut:{modifiers:["shift","cmd"],key:"c"}}),_jsx(l.Action.OpenInBrowser,{title:"Issues",key:`issues ${c.name}`,url:`${c.url}/issues`,icon:{source:"github-issues-icon.png",tintColor:l.Color.PrimaryText},shortcut:{modifiers:["shift","cmd"],key:"i"}}),_jsx(l.Action.OpenInBrowser,{title:"Pull Requests",key:`pulls ${c.name}`,url:`${c.url}/pulls`,icon:{source:"github-pulls-icon.png",tintColor:l.Color.PrimaryText},shortcut:{modifiers:["shift","cmd"],key:"p"}})):_jsx(l.Action.OpenInBrowser,{title:`Open ${c.name} on ${a}`,key:`open remote ${c.name}`,url:c.url,shortcut:u,icon:f??l.Icon.Globe})}),_jsx(l.Action.CopyToClipboard,{title:"Copy Path to Clipboard",content:o.fullPath,shortcut:{modifiers:["cmd"],key:"."}})))}))))}module.exports=xe(qe);0&&(module.exports={});
/*!
 * git-config-path <https://github.com/jonschlinkert/git-config-path>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */
/*!
 * parse-git-config <https://github.com/jonschlinkert/parse-git-config>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */
/*!
 * parse-github-url <https://github.com/jonschlinkert/parse-github-url>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
