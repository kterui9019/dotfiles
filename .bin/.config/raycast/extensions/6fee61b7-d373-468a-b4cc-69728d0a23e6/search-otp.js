var Jd=Object.create;var Ai=Object.defineProperty;var eh=Object.getOwnPropertyDescriptor;var th=Object.getOwnPropertyNames;var rh=Object.getPrototypeOf,ah=Object.prototype.hasOwnProperty;var Cl=e=>Ai(e,"__esModule",{value:!0});var mn=(e,t)=>()=>(e&&(t=e(e=0)),t);var ae=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Sl=(e,t)=>{for(var a in t)Ai(e,a,{get:t[a],enumerable:!0})},El=(e,t,a,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of th(t))!ah.call(e,n)&&(a||n!=="default")&&Ai(e,n,{get:()=>t[n],enumerable:!(r=eh(t,n))||r.enumerable});return e},dt=(e,t)=>El(Cl(Ai(e!=null?Jd(rh(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),nh=(e=>(t,a)=>e&&e.get(t)||(a=El(Cl({}),t,1),e&&e.set(t,a),a))(typeof WeakMap!="undefined"?new WeakMap:0);var bl=(e,t,a)=>{if(!t.has(e))throw TypeError("Cannot "+a)};var Re=(e,t,a)=>(bl(e,t,"read from private field"),a?a.call(e):t.get(e)),wt=(e,t,a)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,a)},vt=(e,t,a,r)=>(bl(e,t,"write to private field"),r?r.call(e,a):t.set(e,a),a);var Al=ae((_i,Tl)=>{(function(e,t){typeof _i=="object"&&typeof Tl!="undefined"?t(_i):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis!="undefined"?globalThis:e||self,t(e.WebStreamsPolyfill={}))})(_i,function(e){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:o=>`Symbol(${o})`;function a(){}function r(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global}let n=r();function i(o){return typeof o=="object"&&o!==null||typeof o=="function"}let s=a,u=Promise,f=Promise.prototype.then,c=Promise.resolve.bind(u),d=Promise.reject.bind(u);function h(o){return new u(o)}function C(o){return c(o)}function E(o){return d(o)}function v(o,l,p){return f.call(o,l,p)}function _(o,l,p){v(v(o,l,p),void 0,s)}function S(o,l){_(o,l)}function b(o,l){_(o,void 0,l)}function A(o,l,p){return v(o,l,p)}function w(o){v(o,void 0,s)}let P=(()=>{let o=n&&n.queueMicrotask;if(typeof o=="function")return o;let l=C(void 0);return p=>v(l,p)})();function k(o,l,p){if(typeof o!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(o,l,p)}function N(o,l,p){try{return C(k(o,l,p))}catch(x){return E(x)}}let G=16384;class q{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(l){let p=this._back,x=p;p._elements.length===G-1&&(x={_elements:[],_next:void 0}),p._elements.push(l),x!==p&&(this._back=x,p._next=x),++this._size}shift(){let l=this._front,p=l,x=this._cursor,R=x+1,U=l._elements,O=U[x];return R===G&&(p=l._next,R=0),--this._size,this._cursor=R,l!==p&&(this._front=p),U[x]=void 0,O}forEach(l){let p=this._cursor,x=this._front,R=x._elements;for(;(p!==R.length||x._next!==void 0)&&!(p===R.length&&(x=x._next,R=x._elements,p=0,R.length===0));)l(R[p]),++p}peek(){let l=this._front,p=this._cursor;return l._elements[p]}}function Y(o,l){o._ownerReadableStream=l,l._reader=o,l._state==="readable"?xe(o):l._state==="closed"?Te(o):Pe(o,l._storedError)}function H(o,l){let p=o._ownerReadableStream;return Mt(p,l)}function re(o){o._ownerReadableStream._state==="readable"?Ue(o,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):Z(o,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),o._ownerReadableStream._reader=void 0,o._ownerReadableStream=void 0}function K(o){return new TypeError("Cannot "+o+" a stream using a released reader")}function xe(o){o._closedPromise=h((l,p)=>{o._closedPromise_resolve=l,o._closedPromise_reject=p})}function Pe(o,l){xe(o),Ue(o,l)}function Te(o){xe(o),$t(o)}function Ue(o,l){o._closedPromise_reject!==void 0&&(w(o._closedPromise),o._closedPromise_reject(l),o._closedPromise_resolve=void 0,o._closedPromise_reject=void 0)}function Z(o,l){Pe(o,l)}function $t(o){o._closedPromise_resolve!==void 0&&(o._closedPromise_resolve(void 0),o._closedPromise_resolve=void 0,o._closedPromise_reject=void 0)}let fr=t("[[AbortSteps]]"),qe=t("[[ErrorSteps]]"),Oe=t("[[CancelSteps]]"),Me=t("[[PullSteps]]"),Qe=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},Xe=Math.trunc||function(o){return o<0?Math.ceil(o):Math.floor(o)};function Ze(o){return typeof o=="object"||typeof o=="function"}function Ie(o,l){if(o!==void 0&&!Ze(o))throw new TypeError(`${l} is not an object.`)}function Ae(o,l){if(typeof o!="function")throw new TypeError(`${l} is not a function.`)}function Je(o){return typeof o=="object"&&o!==null||typeof o=="function"}function je(o,l){if(!Je(o))throw new TypeError(`${l} is not an object.`)}function Be(o,l,p){if(o===void 0)throw new TypeError(`Parameter ${l} is required in '${p}'.`)}function He(o,l,p){if(o===void 0)throw new TypeError(`${l} is required in '${p}'.`)}function ze(o){return Number(o)}function $e(o){return o===0?0:o}function et(o){return $e(Xe(o))}function Ye(o,l){let p=0,x=Number.MAX_SAFE_INTEGER,R=Number(o);if(R=$e(R),!Qe(R))throw new TypeError(`${l} is not a finite number`);if(R=et(R),R<p||R>x)throw new TypeError(`${l} is outside the accepted range of ${p} to ${x}, inclusive`);return!Qe(R)||R===0?0:R}function Es(o,l){if(!_r(o))throw new TypeError(`${l} is not a ReadableStream.`)}function ma(o){return new tn(o)}function hu(o,l){o._reader._readRequests.push(l)}function bs(o,l,p){let R=o._reader._readRequests.shift();p?R._closeSteps():R._chunkSteps(l)}function Qn(o){return o._reader._readRequests.length}function pu(o){let l=o._reader;return!(l===void 0||!br(l))}class tn{constructor(l){if(Be(l,1,"ReadableStreamDefaultReader"),Es(l,"First parameter"),Ir(l))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Y(this,l),this._readRequests=new q}get closed(){return br(this)?this._closedPromise:E(jn("closed"))}cancel(l=void 0){return br(this)?this._ownerReadableStream===void 0?E(K("cancel")):H(this,l):E(jn("cancel"))}read(){if(!br(this))return E(jn("read"));if(this._ownerReadableStream===void 0)return E(K("read from"));let l,p,x=h((U,O)=>{l=U,p=O});return rn(this,{_chunkSteps:U=>l({value:U,done:!1}),_closeSteps:()=>l({value:void 0,done:!0}),_errorSteps:U=>p(U)}),x}releaseLock(){if(!br(this))throw jn("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");re(this)}}}Object.defineProperties(tn.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(tn.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function br(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_readRequests")?!1:o instanceof tn}function rn(o,l){let p=o._ownerReadableStream;p._disturbed=!0,p._state==="closed"?l._closeSteps():p._state==="errored"?l._errorSteps(p._storedError):p._readableStreamController[Me](l)}function jn(o){return new TypeError(`ReadableStreamDefaultReader.prototype.${o} can only be used on a ReadableStreamDefaultReader`)}let yu=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class gu{constructor(l,p){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=l,this._preventCancel=p}next(){let l=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?A(this._ongoingPromise,l,l):l(),this._ongoingPromise}return(l){let p=()=>this._returnSteps(l);return this._ongoingPromise?A(this._ongoingPromise,p,p):p()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let l=this._reader;if(l._ownerReadableStream===void 0)return E(K("iterate"));let p,x,R=h((O,X)=>{p=O,x=X});return rn(l,{_chunkSteps:O=>{this._ongoingPromise=void 0,P(()=>p({value:O,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,re(l),p({value:void 0,done:!0})},_errorSteps:O=>{this._ongoingPromise=void 0,this._isFinished=!0,re(l),x(O)}}),R}_returnSteps(l){if(this._isFinished)return Promise.resolve({value:l,done:!0});this._isFinished=!0;let p=this._reader;if(p._ownerReadableStream===void 0)return E(K("finish iterating"));if(!this._preventCancel){let x=H(p,l);return re(p),A(x,()=>({value:l,done:!0}))}return re(p),C({value:l,done:!0})}}let mu={next(){return vu(this)?this._asyncIteratorImpl.next():E(Cu("next"))},return(o){return vu(this)?this._asyncIteratorImpl.return(o):E(Cu("return"))}};yu!==void 0&&Object.setPrototypeOf(mu,yu);function P0(o,l){let p=ma(o),x=new gu(p,l),R=Object.create(mu);return R._asyncIteratorImpl=x,R}function vu(o){if(!i(o)||!Object.prototype.hasOwnProperty.call(o,"_asyncIteratorImpl"))return!1;try{return o._asyncIteratorImpl instanceof gu}catch{return!1}}function Cu(o){return new TypeError(`ReadableStreamAsyncIterator.${o} can only be used on a ReadableSteamAsyncIterator`)}let Su=Number.isNaN||function(o){return o!==o};function an(o){return o.slice()}function Eu(o,l,p,x,R){new Uint8Array(o).set(new Uint8Array(p,x,R),l)}function Tm(o){return o}function $n(o){return!1}function bu(o,l,p){if(o.slice)return o.slice(l,p);let x=p-l,R=new ArrayBuffer(x);return Eu(R,0,o,l,x),R}function D0(o){return!(typeof o!="number"||Su(o)||o<0)}function xu(o){let l=bu(o.buffer,o.byteOffset,o.byteOffset+o.byteLength);return new Uint8Array(l)}function xs(o){let l=o._queue.shift();return o._queueTotalSize-=l.size,o._queueTotalSize<0&&(o._queueTotalSize=0),l.value}function Ts(o,l,p){if(!D0(p)||p===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");o._queue.push({value:l,size:p}),o._queueTotalSize+=p}function U0(o){return o._queue.peek().value}function xr(o){o._queue=new q,o._queueTotalSize=0}class nn{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!As(this))throw ws("view");return this._view}respond(l){if(!As(this))throw ws("respond");if(Be(l,1,"respond"),l=Ye(l,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");$n(this._view.buffer),ei(this._associatedReadableByteStreamController,l)}respondWithNewView(l){if(!As(this))throw ws("respondWithNewView");if(Be(l,1,"respondWithNewView"),!ArrayBuffer.isView(l))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");$n(l.buffer),ti(this._associatedReadableByteStreamController,l)}}Object.defineProperties(nn.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(nn.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class va{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Qr(this))throw on("byobRequest");return Bs(this)}get desiredSize(){if(!Qr(this))throw on("desiredSize");return Nu(this)}close(){if(!Qr(this))throw on("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let l=this._controlledReadableByteStream._state;if(l!=="readable")throw new TypeError(`The stream (in ${l} state) is not in the readable state and cannot be closed`);sn(this)}enqueue(l){if(!Qr(this))throw on("enqueue");if(Be(l,1,"enqueue"),!ArrayBuffer.isView(l))throw new TypeError("chunk must be an array buffer view");if(l.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(l.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let p=this._controlledReadableByteStream._state;if(p!=="readable")throw new TypeError(`The stream (in ${p} state) is not in the readable state and cannot be enqueued to`);Jn(this,l)}error(l=void 0){if(!Qr(this))throw on("error");qt(this,l)}[Oe](l){Tu(this),xr(this);let p=this._cancelAlgorithm(l);return Zn(this),p}[Me](l){let p=this._controlledReadableByteStream;if(this._queueTotalSize>0){let R=this._queue.shift();this._queueTotalSize-=R.byteLength,Bu(this);let U=new Uint8Array(R.buffer,R.byteOffset,R.byteLength);l._chunkSteps(U);return}let x=this._autoAllocateChunkSize;if(x!==void 0){let R;try{R=new ArrayBuffer(x)}catch(O){l._errorSteps(O);return}let U={buffer:R,bufferByteLength:x,byteOffset:0,byteLength:x,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(U)}hu(p,l),jr(this)}}Object.defineProperties(va.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(va.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Qr(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_controlledReadableByteStream")?!1:o instanceof va}function As(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_associatedReadableByteStreamController")?!1:o instanceof nn}function jr(o){if(!q0(o))return;if(o._pulling){o._pullAgain=!0;return}o._pulling=!0;let p=o._pullAlgorithm();_(p,()=>{o._pulling=!1,o._pullAgain&&(o._pullAgain=!1,jr(o))},x=>{qt(o,x)})}function Tu(o){Is(o),o._pendingPullIntos=new q}function _s(o,l){let p=!1;o._state==="closed"&&(p=!0);let x=Au(l);l.readerType==="default"?bs(o,x,p):H0(o,x,p)}function Au(o){let l=o.bytesFilled,p=o.elementSize;return new o.viewConstructor(o.buffer,o.byteOffset,l/p)}function Yn(o,l,p,x){o._queue.push({buffer:l,byteOffset:p,byteLength:x}),o._queueTotalSize+=x}function _u(o,l){let p=l.elementSize,x=l.bytesFilled-l.bytesFilled%p,R=Math.min(o._queueTotalSize,l.byteLength-l.bytesFilled),U=l.bytesFilled+R,O=U-U%p,X=R,oe=!1;O>x&&(X=O-l.bytesFilled,oe=!0);let pe=o._queue;for(;X>0;){let Se=pe.peek(),Ee=Math.min(X,Se.byteLength),We=l.byteOffset+l.bytesFilled;Eu(l.buffer,We,Se.buffer,Se.byteOffset,Ee),Se.byteLength===Ee?pe.shift():(Se.byteOffset+=Ee,Se.byteLength-=Ee),o._queueTotalSize-=Ee,Iu(o,Ee,l),X-=Ee}return oe}function Iu(o,l,p){p.bytesFilled+=l}function Bu(o){o._queueTotalSize===0&&o._closeRequested?(Zn(o),yn(o._controlledReadableByteStream)):jr(o)}function Is(o){o._byobRequest!==null&&(o._byobRequest._associatedReadableByteStreamController=void 0,o._byobRequest._view=null,o._byobRequest=null)}function wu(o){for(;o._pendingPullIntos.length>0;){if(o._queueTotalSize===0)return;let l=o._pendingPullIntos.peek();_u(o,l)&&(Xn(o),_s(o._controlledReadableByteStream,l))}}function O0(o,l,p){let x=o._controlledReadableByteStream,R=1;l.constructor!==DataView&&(R=l.constructor.BYTES_PER_ELEMENT);let U=l.constructor,O=l.buffer,X={buffer:O,bufferByteLength:O.byteLength,byteOffset:l.byteOffset,byteLength:l.byteLength,bytesFilled:0,elementSize:R,viewConstructor:U,readerType:"byob"};if(o._pendingPullIntos.length>0){o._pendingPullIntos.push(X),Pu(x,p);return}if(x._state==="closed"){let oe=new U(X.buffer,X.byteOffset,0);p._closeSteps(oe);return}if(o._queueTotalSize>0){if(_u(o,X)){let oe=Au(X);Bu(o),p._chunkSteps(oe);return}if(o._closeRequested){let oe=new TypeError("Insufficient bytes to fill elements in the given buffer");qt(o,oe),p._errorSteps(oe);return}}o._pendingPullIntos.push(X),Pu(x,p),jr(o)}function F0(o,l){let p=o._controlledReadableByteStream;if(Rs(p))for(;Du(p)>0;){let x=Xn(o);_s(p,x)}}function V0(o,l,p){if(Iu(o,l,p),p.bytesFilled<p.elementSize)return;Xn(o);let x=p.bytesFilled%p.elementSize;if(x>0){let R=p.byteOffset+p.bytesFilled,U=bu(p.buffer,R-x,R);Yn(o,U,0,U.byteLength)}p.bytesFilled-=x,_s(o._controlledReadableByteStream,p),wu(o)}function Ru(o,l){let p=o._pendingPullIntos.peek();Is(o),o._controlledReadableByteStream._state==="closed"?F0(o):V0(o,l,p),jr(o)}function Xn(o){return o._pendingPullIntos.shift()}function q0(o){let l=o._controlledReadableByteStream;return l._state!=="readable"||o._closeRequested||!o._started?!1:!!(pu(l)&&Qn(l)>0||Rs(l)&&Du(l)>0||Nu(o)>0)}function Zn(o){o._pullAlgorithm=void 0,o._cancelAlgorithm=void 0}function sn(o){let l=o._controlledReadableByteStream;if(!(o._closeRequested||l._state!=="readable")){if(o._queueTotalSize>0){o._closeRequested=!0;return}if(o._pendingPullIntos.length>0&&o._pendingPullIntos.peek().bytesFilled>0){let x=new TypeError("Insufficient bytes to fill elements in the given buffer");throw qt(o,x),x}Zn(o),yn(l)}}function Jn(o,l){let p=o._controlledReadableByteStream;if(o._closeRequested||p._state!=="readable")return;let x=l.buffer,R=l.byteOffset,U=l.byteLength,O=x;if(o._pendingPullIntos.length>0){let X=o._pendingPullIntos.peek();$n(X.buffer),X.buffer=X.buffer}if(Is(o),pu(p))if(Qn(p)===0)Yn(o,O,R,U);else{o._pendingPullIntos.length>0&&Xn(o);let X=new Uint8Array(O,R,U);bs(p,X,!1)}else Rs(p)?(Yn(o,O,R,U),wu(o)):Yn(o,O,R,U);jr(o)}function qt(o,l){let p=o._controlledReadableByteStream;p._state==="readable"&&(Tu(o),xr(o),Zn(o),il(p,l))}function Bs(o){if(o._byobRequest===null&&o._pendingPullIntos.length>0){let l=o._pendingPullIntos.peek(),p=new Uint8Array(l.buffer,l.byteOffset+l.bytesFilled,l.byteLength-l.bytesFilled),x=Object.create(nn.prototype);K0(x,o,p),o._byobRequest=x}return o._byobRequest}function Nu(o){let l=o._controlledReadableByteStream._state;return l==="errored"?null:l==="closed"?0:o._strategyHWM-o._queueTotalSize}function ei(o,l){let p=o._pendingPullIntos.peek();if(o._controlledReadableByteStream._state==="closed"){if(l!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(l===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(p.bytesFilled+l>p.byteLength)throw new RangeError("bytesWritten out of range")}p.buffer=p.buffer,Ru(o,l)}function ti(o,l){let p=o._pendingPullIntos.peek();if(o._controlledReadableByteStream._state==="closed"){if(l.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(l.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(p.byteOffset+p.bytesFilled!==l.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(p.bufferByteLength!==l.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(p.bytesFilled+l.byteLength>p.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let R=l.byteLength;p.buffer=l.buffer,Ru(o,R)}function Lu(o,l,p,x,R,U,O){l._controlledReadableByteStream=o,l._pullAgain=!1,l._pulling=!1,l._byobRequest=null,l._queue=l._queueTotalSize=void 0,xr(l),l._closeRequested=!1,l._started=!1,l._strategyHWM=U,l._pullAlgorithm=x,l._cancelAlgorithm=R,l._autoAllocateChunkSize=O,l._pendingPullIntos=new q,o._readableStreamController=l;let X=p();_(C(X),()=>{l._started=!0,jr(l)},oe=>{qt(l,oe)})}function M0(o,l,p){let x=Object.create(va.prototype),R=()=>{},U=()=>C(void 0),O=()=>C(void 0);l.start!==void 0&&(R=()=>l.start(x)),l.pull!==void 0&&(U=()=>l.pull(x)),l.cancel!==void 0&&(O=oe=>l.cancel(oe));let X=l.autoAllocateChunkSize;if(X===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Lu(o,x,R,U,O,p,X)}function K0(o,l,p){o._associatedReadableByteStreamController=l,o._view=p}function ws(o){return new TypeError(`ReadableStreamBYOBRequest.prototype.${o} can only be used on a ReadableStreamBYOBRequest`)}function on(o){return new TypeError(`ReadableByteStreamController.prototype.${o} can only be used on a ReadableByteStreamController`)}function ku(o){return new un(o)}function Pu(o,l){o._reader._readIntoRequests.push(l)}function H0(o,l,p){let R=o._reader._readIntoRequests.shift();p?R._closeSteps(l):R._chunkSteps(l)}function Du(o){return o._reader._readIntoRequests.length}function Rs(o){let l=o._reader;return!(l===void 0||!$r(l))}class un{constructor(l){if(Be(l,1,"ReadableStreamBYOBReader"),Es(l,"First parameter"),Ir(l))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Qr(l._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Y(this,l),this._readIntoRequests=new q}get closed(){return $r(this)?this._closedPromise:E(ri("closed"))}cancel(l=void 0){return $r(this)?this._ownerReadableStream===void 0?E(K("cancel")):H(this,l):E(ri("cancel"))}read(l){if(!$r(this))return E(ri("read"));if(!ArrayBuffer.isView(l))return E(new TypeError("view must be an array buffer view"));if(l.byteLength===0)return E(new TypeError("view must have non-zero byteLength"));if(l.buffer.byteLength===0)return E(new TypeError("view's buffer must have non-zero byteLength"));if($n(l.buffer),this._ownerReadableStream===void 0)return E(K("read from"));let p,x,R=h((O,X)=>{p=O,x=X});return Uu(this,l,{_chunkSteps:O=>p({value:O,done:!1}),_closeSteps:O=>p({value:O,done:!0}),_errorSteps:O=>x(O)}),R}releaseLock(){if(!$r(this))throw ri("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");re(this)}}}Object.defineProperties(un.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(un.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function $r(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_readIntoRequests")?!1:o instanceof un}function Uu(o,l,p){let x=o._ownerReadableStream;x._disturbed=!0,x._state==="errored"?p._errorSteps(x._storedError):O0(x._readableStreamController,l,p)}function ri(o){return new TypeError(`ReadableStreamBYOBReader.prototype.${o} can only be used on a ReadableStreamBYOBReader`)}function ln(o,l){let{highWaterMark:p}=o;if(p===void 0)return l;if(Su(p)||p<0)throw new RangeError("Invalid highWaterMark");return p}function ai(o){let{size:l}=o;return l||(()=>1)}function ni(o,l){Ie(o,l);let p=o==null?void 0:o.highWaterMark,x=o==null?void 0:o.size;return{highWaterMark:p===void 0?void 0:ze(p),size:x===void 0?void 0:z0(x,`${l} has member 'size' that`)}}function z0(o,l){return Ae(o,l),p=>ze(o(p))}function W0(o,l){Ie(o,l);let p=o==null?void 0:o.abort,x=o==null?void 0:o.close,R=o==null?void 0:o.start,U=o==null?void 0:o.type,O=o==null?void 0:o.write;return{abort:p===void 0?void 0:G0(p,o,`${l} has member 'abort' that`),close:x===void 0?void 0:Q0(x,o,`${l} has member 'close' that`),start:R===void 0?void 0:j0(R,o,`${l} has member 'start' that`),write:O===void 0?void 0:$0(O,o,`${l} has member 'write' that`),type:U}}function G0(o,l,p){return Ae(o,p),x=>N(o,l,[x])}function Q0(o,l,p){return Ae(o,p),()=>N(o,l,[])}function j0(o,l,p){return Ae(o,p),x=>k(o,l,[x])}function $0(o,l,p){return Ae(o,p),(x,R)=>N(o,l,[x,R])}function Ou(o,l){if(!Ca(o))throw new TypeError(`${l} is not a WritableStream.`)}function Y0(o){if(typeof o!="object"||o===null)return!1;try{return typeof o.aborted=="boolean"}catch{return!1}}let X0=typeof AbortController=="function";function Z0(){if(X0)return new AbortController}class fn{constructor(l={},p={}){l===void 0?l=null:je(l,"First parameter");let x=ni(p,"Second parameter"),R=W0(l,"First parameter");if(Vu(this),R.type!==void 0)throw new RangeError("Invalid type is specified");let O=ai(x),X=ln(x,1);dd(this,R,X,O)}get locked(){if(!Ca(this))throw li("locked");return Sa(this)}abort(l=void 0){return Ca(this)?Sa(this)?E(new TypeError("Cannot abort a stream that already has a writer")):ii(this,l):E(li("abort"))}close(){return Ca(this)?Sa(this)?E(new TypeError("Cannot close a stream that already has a writer")):Yt(this)?E(new TypeError("Cannot close an already-closing stream")):qu(this):E(li("close"))}getWriter(){if(!Ca(this))throw li("getWriter");return Fu(this)}}Object.defineProperties(fn.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(fn.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function Fu(o){return new cn(o)}function J0(o,l,p,x,R=1,U=()=>1){let O=Object.create(fn.prototype);Vu(O);let X=Object.create(Ea.prototype);return Gu(O,X,o,l,p,x,R,U),O}function Vu(o){o._state="writable",o._storedError=void 0,o._writer=void 0,o._writableStreamController=void 0,o._writeRequests=new q,o._inFlightWriteRequest=void 0,o._closeRequest=void 0,o._inFlightCloseRequest=void 0,o._pendingAbortRequest=void 0,o._backpressure=!1}function Ca(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_writableStreamController")?!1:o instanceof fn}function Sa(o){return o._writer!==void 0}function ii(o,l){var p;if(o._state==="closed"||o._state==="errored")return C(void 0);o._writableStreamController._abortReason=l,(p=o._writableStreamController._abortController)===null||p===void 0||p.abort();let x=o._state;if(x==="closed"||x==="errored")return C(void 0);if(o._pendingAbortRequest!==void 0)return o._pendingAbortRequest._promise;let R=!1;x==="erroring"&&(R=!0,l=void 0);let U=h((O,X)=>{o._pendingAbortRequest={_promise:void 0,_resolve:O,_reject:X,_reason:l,_wasAlreadyErroring:R}});return o._pendingAbortRequest._promise=U,R||Ls(o,l),U}function qu(o){let l=o._state;if(l==="closed"||l==="errored")return E(new TypeError(`The stream (in ${l} state) is not in the writable state and cannot be closed`));let p=h((R,U)=>{let O={_resolve:R,_reject:U};o._closeRequest=O}),x=o._writer;return x!==void 0&&o._backpressure&&l==="writable"&&Ms(x),hd(o._writableStreamController),p}function ed(o){return h((p,x)=>{let R={_resolve:p,_reject:x};o._writeRequests.push(R)})}function Ns(o,l){if(o._state==="writable"){Ls(o,l);return}ks(o)}function Ls(o,l){let p=o._writableStreamController;o._state="erroring",o._storedError=l;let x=o._writer;x!==void 0&&Ku(x,l),!id(o)&&p._started&&ks(o)}function ks(o){o._state="errored",o._writableStreamController[qe]();let l=o._storedError;if(o._writeRequests.forEach(R=>{R._reject(l)}),o._writeRequests=new q,o._pendingAbortRequest===void 0){si(o);return}let p=o._pendingAbortRequest;if(o._pendingAbortRequest=void 0,p._wasAlreadyErroring){p._reject(l),si(o);return}let x=o._writableStreamController[fr](p._reason);_(x,()=>{p._resolve(),si(o)},R=>{p._reject(R),si(o)})}function td(o){o._inFlightWriteRequest._resolve(void 0),o._inFlightWriteRequest=void 0}function rd(o,l){o._inFlightWriteRequest._reject(l),o._inFlightWriteRequest=void 0,Ns(o,l)}function ad(o){o._inFlightCloseRequest._resolve(void 0),o._inFlightCloseRequest=void 0,o._state==="erroring"&&(o._storedError=void 0,o._pendingAbortRequest!==void 0&&(o._pendingAbortRequest._resolve(),o._pendingAbortRequest=void 0)),o._state="closed";let p=o._writer;p!==void 0&&Yu(p)}function nd(o,l){o._inFlightCloseRequest._reject(l),o._inFlightCloseRequest=void 0,o._pendingAbortRequest!==void 0&&(o._pendingAbortRequest._reject(l),o._pendingAbortRequest=void 0),Ns(o,l)}function Yt(o){return!(o._closeRequest===void 0&&o._inFlightCloseRequest===void 0)}function id(o){return!(o._inFlightWriteRequest===void 0&&o._inFlightCloseRequest===void 0)}function sd(o){o._inFlightCloseRequest=o._closeRequest,o._closeRequest=void 0}function od(o){o._inFlightWriteRequest=o._writeRequests.shift()}function si(o){o._closeRequest!==void 0&&(o._closeRequest._reject(o._storedError),o._closeRequest=void 0);let l=o._writer;l!==void 0&&Vs(l,o._storedError)}function Ps(o,l){let p=o._writer;p!==void 0&&l!==o._backpressure&&(l?Sd(p):Ms(p)),o._backpressure=l}class cn{constructor(l){if(Be(l,1,"WritableStreamDefaultWriter"),Ou(l,"First parameter"),Sa(l))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=l,l._writer=this;let p=l._state;if(p==="writable")!Yt(l)&&l._backpressure?ci(this):Xu(this),fi(this);else if(p==="erroring")qs(this,l._storedError),fi(this);else if(p==="closed")Xu(this),vd(this);else{let x=l._storedError;qs(this,x),$u(this,x)}}get closed(){return Yr(this)?this._closedPromise:E(Xr("closed"))}get desiredSize(){if(!Yr(this))throw Xr("desiredSize");if(this._ownerWritableStream===void 0)throw dn("desiredSize");return cd(this)}get ready(){return Yr(this)?this._readyPromise:E(Xr("ready"))}abort(l=void 0){return Yr(this)?this._ownerWritableStream===void 0?E(dn("abort")):ud(this,l):E(Xr("abort"))}close(){if(!Yr(this))return E(Xr("close"));let l=this._ownerWritableStream;return l===void 0?E(dn("close")):Yt(l)?E(new TypeError("Cannot close an already-closing stream")):Mu(this)}releaseLock(){if(!Yr(this))throw Xr("releaseLock");this._ownerWritableStream!==void 0&&Hu(this)}write(l=void 0){return Yr(this)?this._ownerWritableStream===void 0?E(dn("write to")):zu(this,l):E(Xr("write"))}}Object.defineProperties(cn.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(cn.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Yr(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_ownerWritableStream")?!1:o instanceof cn}function ud(o,l){let p=o._ownerWritableStream;return ii(p,l)}function Mu(o){let l=o._ownerWritableStream;return qu(l)}function ld(o){let l=o._ownerWritableStream,p=l._state;return Yt(l)||p==="closed"?C(void 0):p==="errored"?E(l._storedError):Mu(o)}function fd(o,l){o._closedPromiseState==="pending"?Vs(o,l):Cd(o,l)}function Ku(o,l){o._readyPromiseState==="pending"?Zu(o,l):Ed(o,l)}function cd(o){let l=o._ownerWritableStream,p=l._state;return p==="errored"||p==="erroring"?null:p==="closed"?0:Qu(l._writableStreamController)}function Hu(o){let l=o._ownerWritableStream,p=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Ku(o,p),fd(o,p),l._writer=void 0,o._ownerWritableStream=void 0}function zu(o,l){let p=o._ownerWritableStream,x=p._writableStreamController,R=pd(x,l);if(p!==o._ownerWritableStream)return E(dn("write to"));let U=p._state;if(U==="errored")return E(p._storedError);if(Yt(p)||U==="closed")return E(new TypeError("The stream is closing or closed and cannot be written to"));if(U==="erroring")return E(p._storedError);let O=ed(p);return yd(x,l,R),O}let Wu={};class Ea{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Ds(this))throw Fs("abortReason");return this._abortReason}get signal(){if(!Ds(this))throw Fs("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(l=void 0){if(!Ds(this))throw Fs("error");this._controlledWritableStream._state==="writable"&&ju(this,l)}[fr](l){let p=this._abortAlgorithm(l);return oi(this),p}[qe](){xr(this)}}Object.defineProperties(Ea.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ea.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Ds(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_controlledWritableStream")?!1:o instanceof Ea}function Gu(o,l,p,x,R,U,O,X){l._controlledWritableStream=o,o._writableStreamController=l,l._queue=void 0,l._queueTotalSize=void 0,xr(l),l._abortReason=void 0,l._abortController=Z0(),l._started=!1,l._strategySizeAlgorithm=X,l._strategyHWM=O,l._writeAlgorithm=x,l._closeAlgorithm=R,l._abortAlgorithm=U;let oe=Os(l);Ps(o,oe);let pe=p(),Se=C(pe);_(Se,()=>{l._started=!0,ui(l)},Ee=>{l._started=!0,Ns(o,Ee)})}function dd(o,l,p,x){let R=Object.create(Ea.prototype),U=()=>{},O=()=>C(void 0),X=()=>C(void 0),oe=()=>C(void 0);l.start!==void 0&&(U=()=>l.start(R)),l.write!==void 0&&(O=pe=>l.write(pe,R)),l.close!==void 0&&(X=()=>l.close()),l.abort!==void 0&&(oe=pe=>l.abort(pe)),Gu(o,R,U,O,X,oe,p,x)}function oi(o){o._writeAlgorithm=void 0,o._closeAlgorithm=void 0,o._abortAlgorithm=void 0,o._strategySizeAlgorithm=void 0}function hd(o){Ts(o,Wu,0),ui(o)}function pd(o,l){try{return o._strategySizeAlgorithm(l)}catch(p){return Us(o,p),1}}function Qu(o){return o._strategyHWM-o._queueTotalSize}function yd(o,l,p){try{Ts(o,l,p)}catch(R){Us(o,R);return}let x=o._controlledWritableStream;if(!Yt(x)&&x._state==="writable"){let R=Os(o);Ps(x,R)}ui(o)}function ui(o){let l=o._controlledWritableStream;if(!o._started||l._inFlightWriteRequest!==void 0)return;if(l._state==="erroring"){ks(l);return}if(o._queue.length===0)return;let x=U0(o);x===Wu?gd(o):md(o,x)}function Us(o,l){o._controlledWritableStream._state==="writable"&&ju(o,l)}function gd(o){let l=o._controlledWritableStream;sd(l),xs(o);let p=o._closeAlgorithm();oi(o),_(p,()=>{ad(l)},x=>{nd(l,x)})}function md(o,l){let p=o._controlledWritableStream;od(p);let x=o._writeAlgorithm(l);_(x,()=>{td(p);let R=p._state;if(xs(o),!Yt(p)&&R==="writable"){let U=Os(o);Ps(p,U)}ui(o)},R=>{p._state==="writable"&&oi(o),rd(p,R)})}function Os(o){return Qu(o)<=0}function ju(o,l){let p=o._controlledWritableStream;oi(o),Ls(p,l)}function li(o){return new TypeError(`WritableStream.prototype.${o} can only be used on a WritableStream`)}function Fs(o){return new TypeError(`WritableStreamDefaultController.prototype.${o} can only be used on a WritableStreamDefaultController`)}function Xr(o){return new TypeError(`WritableStreamDefaultWriter.prototype.${o} can only be used on a WritableStreamDefaultWriter`)}function dn(o){return new TypeError("Cannot "+o+" a stream using a released writer")}function fi(o){o._closedPromise=h((l,p)=>{o._closedPromise_resolve=l,o._closedPromise_reject=p,o._closedPromiseState="pending"})}function $u(o,l){fi(o),Vs(o,l)}function vd(o){fi(o),Yu(o)}function Vs(o,l){o._closedPromise_reject!==void 0&&(w(o._closedPromise),o._closedPromise_reject(l),o._closedPromise_resolve=void 0,o._closedPromise_reject=void 0,o._closedPromiseState="rejected")}function Cd(o,l){$u(o,l)}function Yu(o){o._closedPromise_resolve!==void 0&&(o._closedPromise_resolve(void 0),o._closedPromise_resolve=void 0,o._closedPromise_reject=void 0,o._closedPromiseState="resolved")}function ci(o){o._readyPromise=h((l,p)=>{o._readyPromise_resolve=l,o._readyPromise_reject=p}),o._readyPromiseState="pending"}function qs(o,l){ci(o),Zu(o,l)}function Xu(o){ci(o),Ms(o)}function Zu(o,l){o._readyPromise_reject!==void 0&&(w(o._readyPromise),o._readyPromise_reject(l),o._readyPromise_resolve=void 0,o._readyPromise_reject=void 0,o._readyPromiseState="rejected")}function Sd(o){ci(o)}function Ed(o,l){qs(o,l)}function Ms(o){o._readyPromise_resolve!==void 0&&(o._readyPromise_resolve(void 0),o._readyPromise_resolve=void 0,o._readyPromise_reject=void 0,o._readyPromiseState="fulfilled")}let Ju=typeof DOMException!="undefined"?DOMException:void 0;function bd(o){if(!(typeof o=="function"||typeof o=="object"))return!1;try{return new o,!0}catch{return!1}}function xd(){let o=function(p,x){this.message=p||"",this.name=x||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return o.prototype=Object.create(Error.prototype),Object.defineProperty(o.prototype,"constructor",{value:o,writable:!0,configurable:!0}),o}let Td=bd(Ju)?Ju:xd();function el(o,l,p,x,R,U){let O=ma(o),X=Fu(l);o._disturbed=!0;let oe=!1,pe=C(void 0);return h((Se,Ee)=>{let We;if(U!==void 0){if(We=()=>{let ee=new Td("Aborted","AbortError"),de=[];x||de.push(()=>l._state==="writable"?ii(l,ee):C(void 0)),R||de.push(()=>o._state==="readable"?Mt(o,ee):C(void 0)),mt(()=>Promise.all(de.map(we=>we())),!0,ee)},U.aborted){We();return}U.addEventListener("abort",We)}function Kt(){return h((ee,de)=>{function we(xt){xt?ee():v(Ta(),we,de)}we(!1)})}function Ta(){return oe?C(!0):v(X._readyPromise,()=>h((ee,de)=>{rn(O,{_chunkSteps:we=>{pe=v(zu(X,we),void 0,a),ee(!1)},_closeSteps:()=>ee(!0),_errorSteps:de})}))}if(cr(o,O._closedPromise,ee=>{x?Bt(!0,ee):mt(()=>ii(l,ee),!0,ee)}),cr(l,X._closedPromise,ee=>{R?Bt(!0,ee):mt(()=>Mt(o,ee),!0,ee)}),ct(o,O._closedPromise,()=>{p?Bt():mt(()=>ld(X))}),Yt(l)||l._state==="closed"){let ee=new TypeError("the destination writable stream closed before all data could be piped to it");R?Bt(!0,ee):mt(()=>Mt(o,ee),!0,ee)}w(Kt());function Br(){let ee=pe;return v(pe,()=>ee!==pe?Br():void 0)}function cr(ee,de,we){ee._state==="errored"?we(ee._storedError):b(de,we)}function ct(ee,de,we){ee._state==="closed"?we():S(de,we)}function mt(ee,de,we){if(oe)return;oe=!0,l._state==="writable"&&!Yt(l)?S(Br(),xt):xt();function xt(){_(ee(),()=>dr(de,we),Aa=>dr(!0,Aa))}}function Bt(ee,de){oe||(oe=!0,l._state==="writable"&&!Yt(l)?S(Br(),()=>dr(ee,de)):dr(ee,de))}function dr(ee,de){Hu(X),re(O),U!==void 0&&U.removeEventListener("abort",We),ee?Ee(de):Se(void 0)}})}class ba{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!di(this))throw yi("desiredSize");return Ks(this)}close(){if(!di(this))throw yi("close");if(!xa(this))throw new TypeError("The stream is not in a state that permits close");pn(this)}enqueue(l=void 0){if(!di(this))throw yi("enqueue");if(!xa(this))throw new TypeError("The stream is not in a state that permits enqueue");return pi(this,l)}error(l=void 0){if(!di(this))throw yi("error");Tr(this,l)}[Oe](l){xr(this);let p=this._cancelAlgorithm(l);return hi(this),p}[Me](l){let p=this._controlledReadableStream;if(this._queue.length>0){let x=xs(this);this._closeRequested&&this._queue.length===0?(hi(this),yn(p)):hn(this),l._chunkSteps(x)}else hu(p,l),hn(this)}}Object.defineProperties(ba.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(ba.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function di(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_controlledReadableStream")?!1:o instanceof ba}function hn(o){if(!tl(o))return;if(o._pulling){o._pullAgain=!0;return}o._pulling=!0;let p=o._pullAlgorithm();_(p,()=>{o._pulling=!1,o._pullAgain&&(o._pullAgain=!1,hn(o))},x=>{Tr(o,x)})}function tl(o){let l=o._controlledReadableStream;return!xa(o)||!o._started?!1:!!(Ir(l)&&Qn(l)>0||Ks(o)>0)}function hi(o){o._pullAlgorithm=void 0,o._cancelAlgorithm=void 0,o._strategySizeAlgorithm=void 0}function pn(o){if(!xa(o))return;let l=o._controlledReadableStream;o._closeRequested=!0,o._queue.length===0&&(hi(o),yn(l))}function pi(o,l){if(!xa(o))return;let p=o._controlledReadableStream;if(Ir(p)&&Qn(p)>0)bs(p,l,!1);else{let x;try{x=o._strategySizeAlgorithm(l)}catch(R){throw Tr(o,R),R}try{Ts(o,l,x)}catch(R){throw Tr(o,R),R}}hn(o)}function Tr(o,l){let p=o._controlledReadableStream;p._state==="readable"&&(xr(o),hi(o),il(p,l))}function Ks(o){let l=o._controlledReadableStream._state;return l==="errored"?null:l==="closed"?0:o._strategyHWM-o._queueTotalSize}function Ad(o){return!tl(o)}function xa(o){let l=o._controlledReadableStream._state;return!o._closeRequested&&l==="readable"}function rl(o,l,p,x,R,U,O){l._controlledReadableStream=o,l._queue=void 0,l._queueTotalSize=void 0,xr(l),l._started=!1,l._closeRequested=!1,l._pullAgain=!1,l._pulling=!1,l._strategySizeAlgorithm=O,l._strategyHWM=U,l._pullAlgorithm=x,l._cancelAlgorithm=R,o._readableStreamController=l;let X=p();_(C(X),()=>{l._started=!0,hn(l)},oe=>{Tr(l,oe)})}function _d(o,l,p,x){let R=Object.create(ba.prototype),U=()=>{},O=()=>C(void 0),X=()=>C(void 0);l.start!==void 0&&(U=()=>l.start(R)),l.pull!==void 0&&(O=()=>l.pull(R)),l.cancel!==void 0&&(X=oe=>l.cancel(oe)),rl(o,R,U,O,X,p,x)}function yi(o){return new TypeError(`ReadableStreamDefaultController.prototype.${o} can only be used on a ReadableStreamDefaultController`)}function Id(o,l){return Qr(o._readableStreamController)?wd(o):Bd(o)}function Bd(o,l){let p=ma(o),x=!1,R=!1,U=!1,O=!1,X,oe,pe,Se,Ee,We=h(ct=>{Ee=ct});function Kt(){return x?(R=!0,C(void 0)):(x=!0,rn(p,{_chunkSteps:mt=>{P(()=>{R=!1;let Bt=mt,dr=mt;U||pi(pe._readableStreamController,Bt),O||pi(Se._readableStreamController,dr),x=!1,R&&Kt()})},_closeSteps:()=>{x=!1,U||pn(pe._readableStreamController),O||pn(Se._readableStreamController),(!U||!O)&&Ee(void 0)},_errorSteps:()=>{x=!1}}),C(void 0))}function Ta(ct){if(U=!0,X=ct,O){let mt=an([X,oe]),Bt=Mt(o,mt);Ee(Bt)}return We}function Br(ct){if(O=!0,oe=ct,U){let mt=an([X,oe]),Bt=Mt(o,mt);Ee(Bt)}return We}function cr(){}return pe=Hs(cr,Kt,Ta),Se=Hs(cr,Kt,Br),b(p._closedPromise,ct=>{Tr(pe._readableStreamController,ct),Tr(Se._readableStreamController,ct),(!U||!O)&&Ee(void 0)}),[pe,Se]}function wd(o){let l=ma(o),p=!1,x=!1,R=!1,U=!1,O=!1,X,oe,pe,Se,Ee,We=h(ee=>{Ee=ee});function Kt(ee){b(ee._closedPromise,de=>{ee===l&&(qt(pe._readableStreamController,de),qt(Se._readableStreamController,de),(!U||!O)&&Ee(void 0))})}function Ta(){$r(l)&&(re(l),l=ma(o),Kt(l)),rn(l,{_chunkSteps:de=>{P(()=>{x=!1,R=!1;let we=de,xt=de;if(!U&&!O)try{xt=xu(de)}catch(Aa){qt(pe._readableStreamController,Aa),qt(Se._readableStreamController,Aa),Ee(Mt(o,Aa));return}U||Jn(pe._readableStreamController,we),O||Jn(Se._readableStreamController,xt),p=!1,x?cr():R&&ct()})},_closeSteps:()=>{p=!1,U||sn(pe._readableStreamController),O||sn(Se._readableStreamController),pe._readableStreamController._pendingPullIntos.length>0&&ei(pe._readableStreamController,0),Se._readableStreamController._pendingPullIntos.length>0&&ei(Se._readableStreamController,0),(!U||!O)&&Ee(void 0)},_errorSteps:()=>{p=!1}})}function Br(ee,de){br(l)&&(re(l),l=ku(o),Kt(l));let we=de?Se:pe,xt=de?pe:Se;Uu(l,ee,{_chunkSteps:_a=>{P(()=>{x=!1,R=!1;let Ia=de?O:U;if(de?U:O)Ia||ti(we._readableStreamController,_a);else{let vl;try{vl=xu(_a)}catch(Ws){qt(we._readableStreamController,Ws),qt(xt._readableStreamController,Ws),Ee(Mt(o,Ws));return}Ia||ti(we._readableStreamController,_a),Jn(xt._readableStreamController,vl)}p=!1,x?cr():R&&ct()})},_closeSteps:_a=>{p=!1;let Ia=de?O:U,Ti=de?U:O;Ia||sn(we._readableStreamController),Ti||sn(xt._readableStreamController),_a!==void 0&&(Ia||ti(we._readableStreamController,_a),!Ti&&xt._readableStreamController._pendingPullIntos.length>0&&ei(xt._readableStreamController,0)),(!Ia||!Ti)&&Ee(void 0)},_errorSteps:()=>{p=!1}})}function cr(){if(p)return x=!0,C(void 0);p=!0;let ee=Bs(pe._readableStreamController);return ee===null?Ta():Br(ee._view,!1),C(void 0)}function ct(){if(p)return R=!0,C(void 0);p=!0;let ee=Bs(Se._readableStreamController);return ee===null?Ta():Br(ee._view,!0),C(void 0)}function mt(ee){if(U=!0,X=ee,O){let de=an([X,oe]),we=Mt(o,de);Ee(we)}return We}function Bt(ee){if(O=!0,oe=ee,U){let de=an([X,oe]),we=Mt(o,de);Ee(we)}return We}function dr(){}return pe=nl(dr,cr,mt),Se=nl(dr,ct,Bt),Kt(l),[pe,Se]}function Rd(o,l){Ie(o,l);let p=o,x=p==null?void 0:p.autoAllocateChunkSize,R=p==null?void 0:p.cancel,U=p==null?void 0:p.pull,O=p==null?void 0:p.start,X=p==null?void 0:p.type;return{autoAllocateChunkSize:x===void 0?void 0:Ye(x,`${l} has member 'autoAllocateChunkSize' that`),cancel:R===void 0?void 0:Nd(R,p,`${l} has member 'cancel' that`),pull:U===void 0?void 0:Ld(U,p,`${l} has member 'pull' that`),start:O===void 0?void 0:kd(O,p,`${l} has member 'start' that`),type:X===void 0?void 0:Pd(X,`${l} has member 'type' that`)}}function Nd(o,l,p){return Ae(o,p),x=>N(o,l,[x])}function Ld(o,l,p){return Ae(o,p),x=>N(o,l,[x])}function kd(o,l,p){return Ae(o,p),x=>k(o,l,[x])}function Pd(o,l){if(o=`${o}`,o!=="bytes")throw new TypeError(`${l} '${o}' is not a valid enumeration value for ReadableStreamType`);return o}function Dd(o,l){Ie(o,l);let p=o==null?void 0:o.mode;return{mode:p===void 0?void 0:Ud(p,`${l} has member 'mode' that`)}}function Ud(o,l){if(o=`${o}`,o!=="byob")throw new TypeError(`${l} '${o}' is not a valid enumeration value for ReadableStreamReaderMode`);return o}function Od(o,l){Ie(o,l);let p=o==null?void 0:o.preventCancel;return{preventCancel:Boolean(p)}}function al(o,l){Ie(o,l);let p=o==null?void 0:o.preventAbort,x=o==null?void 0:o.preventCancel,R=o==null?void 0:o.preventClose,U=o==null?void 0:o.signal;return U!==void 0&&Fd(U,`${l} has member 'signal' that`),{preventAbort:Boolean(p),preventCancel:Boolean(x),preventClose:Boolean(R),signal:U}}function Fd(o,l){if(!Y0(o))throw new TypeError(`${l} is not an AbortSignal.`)}function Vd(o,l){Ie(o,l);let p=o==null?void 0:o.readable;He(p,"readable","ReadableWritablePair"),Es(p,`${l} has member 'readable' that`);let x=o==null?void 0:o.writable;return He(x,"writable","ReadableWritablePair"),Ou(x,`${l} has member 'writable' that`),{readable:p,writable:x}}class Ar{constructor(l={},p={}){l===void 0?l=null:je(l,"First parameter");let x=ni(p,"Second parameter"),R=Rd(l,"First parameter");if(zs(this),R.type==="bytes"){if(x.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let U=ln(x,0);M0(this,R,U)}else{let U=ai(x),O=ln(x,1);_d(this,R,O,U)}}get locked(){if(!_r(this))throw Zr("locked");return Ir(this)}cancel(l=void 0){return _r(this)?Ir(this)?E(new TypeError("Cannot cancel a stream that already has a reader")):Mt(this,l):E(Zr("cancel"))}getReader(l=void 0){if(!_r(this))throw Zr("getReader");return Dd(l,"First parameter").mode===void 0?ma(this):ku(this)}pipeThrough(l,p={}){if(!_r(this))throw Zr("pipeThrough");Be(l,1,"pipeThrough");let x=Vd(l,"First parameter"),R=al(p,"Second parameter");if(Ir(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Sa(x.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let U=el(this,x.writable,R.preventClose,R.preventAbort,R.preventCancel,R.signal);return w(U),x.readable}pipeTo(l,p={}){if(!_r(this))return E(Zr("pipeTo"));if(l===void 0)return E("Parameter 1 is required in 'pipeTo'.");if(!Ca(l))return E(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let x;try{x=al(p,"Second parameter")}catch(R){return E(R)}return Ir(this)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Sa(l)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):el(this,l,x.preventClose,x.preventAbort,x.preventCancel,x.signal)}tee(){if(!_r(this))throw Zr("tee");let l=Id(this);return an(l)}values(l=void 0){if(!_r(this))throw Zr("values");let p=Od(l,"First parameter");return P0(this,p.preventCancel)}}Object.defineProperties(Ar.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ar.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty(Ar.prototype,t.asyncIterator,{value:Ar.prototype.values,writable:!0,configurable:!0});function Hs(o,l,p,x=1,R=()=>1){let U=Object.create(Ar.prototype);zs(U);let O=Object.create(ba.prototype);return rl(U,O,o,l,p,x,R),U}function nl(o,l,p){let x=Object.create(Ar.prototype);zs(x);let R=Object.create(va.prototype);return Lu(x,R,o,l,p,0,void 0),x}function zs(o){o._state="readable",o._reader=void 0,o._storedError=void 0,o._disturbed=!1}function _r(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_readableStreamController")?!1:o instanceof Ar}function Ir(o){return o._reader!==void 0}function Mt(o,l){if(o._disturbed=!0,o._state==="closed")return C(void 0);if(o._state==="errored")return E(o._storedError);yn(o);let p=o._reader;p!==void 0&&$r(p)&&(p._readIntoRequests.forEach(R=>{R._closeSteps(void 0)}),p._readIntoRequests=new q);let x=o._readableStreamController[Oe](l);return A(x,a)}function yn(o){o._state="closed";let l=o._reader;l!==void 0&&($t(l),br(l)&&(l._readRequests.forEach(p=>{p._closeSteps()}),l._readRequests=new q))}function il(o,l){o._state="errored",o._storedError=l;let p=o._reader;p!==void 0&&(Ue(p,l),br(p)?(p._readRequests.forEach(x=>{x._errorSteps(l)}),p._readRequests=new q):(p._readIntoRequests.forEach(x=>{x._errorSteps(l)}),p._readIntoRequests=new q))}function Zr(o){return new TypeError(`ReadableStream.prototype.${o} can only be used on a ReadableStream`)}function sl(o,l){Ie(o,l);let p=o==null?void 0:o.highWaterMark;return He(p,"highWaterMark","QueuingStrategyInit"),{highWaterMark:ze(p)}}let ol=o=>o.byteLength;Object.defineProperty(ol,"name",{value:"size",configurable:!0});class gi{constructor(l){Be(l,1,"ByteLengthQueuingStrategy"),l=sl(l,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=l.highWaterMark}get highWaterMark(){if(!ll(this))throw ul("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!ll(this))throw ul("size");return ol}}Object.defineProperties(gi.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(gi.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function ul(o){return new TypeError(`ByteLengthQueuingStrategy.prototype.${o} can only be used on a ByteLengthQueuingStrategy`)}function ll(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_byteLengthQueuingStrategyHighWaterMark")?!1:o instanceof gi}let fl=()=>1;Object.defineProperty(fl,"name",{value:"size",configurable:!0});class mi{constructor(l){Be(l,1,"CountQueuingStrategy"),l=sl(l,"First parameter"),this._countQueuingStrategyHighWaterMark=l.highWaterMark}get highWaterMark(){if(!dl(this))throw cl("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!dl(this))throw cl("size");return fl}}Object.defineProperties(mi.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(mi.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function cl(o){return new TypeError(`CountQueuingStrategy.prototype.${o} can only be used on a CountQueuingStrategy`)}function dl(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_countQueuingStrategyHighWaterMark")?!1:o instanceof mi}function qd(o,l){Ie(o,l);let p=o==null?void 0:o.flush,x=o==null?void 0:o.readableType,R=o==null?void 0:o.start,U=o==null?void 0:o.transform,O=o==null?void 0:o.writableType;return{flush:p===void 0?void 0:Md(p,o,`${l} has member 'flush' that`),readableType:x,start:R===void 0?void 0:Kd(R,o,`${l} has member 'start' that`),transform:U===void 0?void 0:Hd(U,o,`${l} has member 'transform' that`),writableType:O}}function Md(o,l,p){return Ae(o,p),x=>N(o,l,[x])}function Kd(o,l,p){return Ae(o,p),x=>k(o,l,[x])}function Hd(o,l,p){return Ae(o,p),(x,R)=>N(o,l,[x,R])}class vi{constructor(l={},p={},x={}){l===void 0&&(l=null);let R=ni(p,"Second parameter"),U=ni(x,"Third parameter"),O=qd(l,"First parameter");if(O.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(O.writableType!==void 0)throw new RangeError("Invalid writableType specified");let X=ln(U,0),oe=ai(U),pe=ln(R,1),Se=ai(R),Ee,We=h(Kt=>{Ee=Kt});zd(this,We,pe,Se,X,oe),Gd(this,O),O.start!==void 0?Ee(O.start(this._transformStreamController)):Ee(void 0)}get readable(){if(!hl(this))throw ml("readable");return this._readable}get writable(){if(!hl(this))throw ml("writable");return this._writable}}Object.defineProperties(vi.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(vi.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function zd(o,l,p,x,R,U){function O(){return l}function X(We){return $d(o,We)}function oe(We){return Yd(o,We)}function pe(){return Xd(o)}o._writable=J0(O,X,pe,oe,p,x);function Se(){return Zd(o)}function Ee(We){return Si(o,We),C(void 0)}o._readable=Hs(O,Se,Ee,R,U),o._backpressure=void 0,o._backpressureChangePromise=void 0,o._backpressureChangePromise_resolve=void 0,Ei(o,!0),o._transformStreamController=void 0}function hl(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_transformStreamController")?!1:o instanceof vi}function Ci(o,l){Tr(o._readable._readableStreamController,l),Si(o,l)}function Si(o,l){pl(o._transformStreamController),Us(o._writable._writableStreamController,l),o._backpressure&&Ei(o,!1)}function Ei(o,l){o._backpressureChangePromise!==void 0&&o._backpressureChangePromise_resolve(),o._backpressureChangePromise=h(p=>{o._backpressureChangePromise_resolve=p}),o._backpressure=l}class gn{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!bi(this))throw xi("desiredSize");let l=this._controlledTransformStream._readable._readableStreamController;return Ks(l)}enqueue(l=void 0){if(!bi(this))throw xi("enqueue");yl(this,l)}error(l=void 0){if(!bi(this))throw xi("error");Qd(this,l)}terminate(){if(!bi(this))throw xi("terminate");jd(this)}}Object.defineProperties(gn.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(gn.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function bi(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_controlledTransformStream")?!1:o instanceof gn}function Wd(o,l,p,x){l._controlledTransformStream=o,o._transformStreamController=l,l._transformAlgorithm=p,l._flushAlgorithm=x}function Gd(o,l){let p=Object.create(gn.prototype),x=U=>{try{return yl(p,U),C(void 0)}catch(O){return E(O)}},R=()=>C(void 0);l.transform!==void 0&&(x=U=>l.transform(U,p)),l.flush!==void 0&&(R=()=>l.flush(p)),Wd(o,p,x,R)}function pl(o){o._transformAlgorithm=void 0,o._flushAlgorithm=void 0}function yl(o,l){let p=o._controlledTransformStream,x=p._readable._readableStreamController;if(!xa(x))throw new TypeError("Readable side is not in a state that permits enqueue");try{pi(x,l)}catch(U){throw Si(p,U),p._readable._storedError}Ad(x)!==p._backpressure&&Ei(p,!0)}function Qd(o,l){Ci(o._controlledTransformStream,l)}function gl(o,l){let p=o._transformAlgorithm(l);return A(p,void 0,x=>{throw Ci(o._controlledTransformStream,x),x})}function jd(o){let l=o._controlledTransformStream,p=l._readable._readableStreamController;pn(p);let x=new TypeError("TransformStream terminated");Si(l,x)}function $d(o,l){let p=o._transformStreamController;if(o._backpressure){let x=o._backpressureChangePromise;return A(x,()=>{let R=o._writable;if(R._state==="erroring")throw R._storedError;return gl(p,l)})}return gl(p,l)}function Yd(o,l){return Ci(o,l),C(void 0)}function Xd(o){let l=o._readable,p=o._transformStreamController,x=p._flushAlgorithm();return pl(p),A(x,()=>{if(l._state==="errored")throw l._storedError;pn(l._readableStreamController)},R=>{throw Ci(o,R),l._storedError})}function Zd(o){return Ei(o,!1),o._backpressureChangePromise}function xi(o){return new TypeError(`TransformStreamDefaultController.prototype.${o} can only be used on a TransformStreamDefaultController`)}function ml(o){return new TypeError(`TransformStream.prototype.${o} can only be used on a TransformStream`)}e.ByteLengthQueuingStrategy=gi,e.CountQueuingStrategy=mi,e.ReadableByteStreamController=va,e.ReadableStream=Ar,e.ReadableStreamBYOBReader=un,e.ReadableStreamBYOBRequest=nn,e.ReadableStreamDefaultController=ba,e.ReadableStreamDefaultReader=tn,e.TransformStream=vi,e.TransformStreamDefaultController=gn,e.WritableStream=fn,e.WritableStreamDefaultController=Ea,e.WritableStreamDefaultWriter=cn,Object.defineProperty(e,"__esModule",{value:!0})})});var _l=ae(()=>{var sh=65536;if(!globalThis.ReadableStream)try{let e=require("process"),{emitWarning:t}=e;try{e.emitWarning=()=>{},Object.assign(globalThis,require("stream/web")),e.emitWarning=t}catch(a){throw e.emitWarning=t,a}}catch{Object.assign(globalThis,Al())}try{let{Blob:e}=require("buffer");e&&!e.prototype.stream&&(e.prototype.stream=function(a){let r=0,n=this;return new ReadableStream({type:"bytes",async pull(i){let u=await n.slice(r,Math.min(n.size,r+sh)).arrayBuffer();r+=u.byteLength,i.enqueue(new Uint8Array(u)),r===n.size&&i.close()}})})}catch{}});async function*Gs(e,t=!0){for(let a of e)if("stream"in a)yield*a.stream();else if(ArrayBuffer.isView(a))if(t){let r=a.byteOffset,n=a.byteOffset+a.byteLength;for(;r!==n;){let i=Math.min(n-r,Il),s=a.buffer.slice(r,r+i);r+=s.byteLength,yield new Uint8Array(s)}}else yield a;else{let r=0;for(;r!==a.size;){let i=await a.slice(r,Math.min(a.size,r+Il)).arrayBuffer();r+=i.byteLength,yield new Uint8Array(i)}}}var Rm,Il,gr,Cn,Ba,wa,Bl,oh,ea,Sn=mn(()=>{Rm=dt(_l(),1);Il=65536;Bl=(wa=class{constructor(t=[],a={}){wt(this,gr,[]);wt(this,Cn,"");wt(this,Ba,0);if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof a!="object"&&typeof a!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");a===null&&(a={});let r=new TextEncoder;for(let i of t){let s;ArrayBuffer.isView(i)?s=new Uint8Array(i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength)):i instanceof ArrayBuffer?s=new Uint8Array(i.slice(0)):i instanceof wa?s=i:s=r.encode(i),vt(this,Ba,Re(this,Ba)+(ArrayBuffer.isView(s)?s.byteLength:s.size)),Re(this,gr).push(s)}let n=a.type===void 0?"":String(a.type);vt(this,Cn,/^[\x20-\x7E]*$/.test(n)?n:"")}get size(){return Re(this,Ba)}get type(){return Re(this,Cn)}async text(){let t=new TextDecoder,a="";for await(let r of Gs(Re(this,gr),!1))a+=t.decode(r,{stream:!0});return a+=t.decode(),a}async arrayBuffer(){let t=new Uint8Array(this.size),a=0;for await(let r of Gs(Re(this,gr),!1))t.set(r,a),a+=r.length;return t.buffer}stream(){let t=Gs(Re(this,gr),!0);return new globalThis.ReadableStream({type:"bytes",async pull(a){let r=await t.next();r.done?a.close():a.enqueue(r.value)},async cancel(){await t.return()}})}slice(t=0,a=this.size,r=""){let{size:n}=this,i=t<0?Math.max(n+t,0):Math.min(t,n),s=a<0?Math.max(n+a,0):Math.min(a,n),u=Math.max(s-i,0),f=Re(this,gr),c=[],d=0;for(let C of f){if(d>=u)break;let E=ArrayBuffer.isView(C)?C.byteLength:C.size;if(i&&E<=i)i-=E,s-=E;else{let v;ArrayBuffer.isView(C)?(v=C.subarray(i,Math.min(E,s)),d+=v.byteLength):(v=C.slice(i,Math.min(E,s)),d+=v.size),s-=E,c.push(v),i=0}}let h=new wa([],{type:String(r).toLowerCase()});return vt(h,Ba,u),vt(h,gr,c),h}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}},gr=new WeakMap,Cn=new WeakMap,Ba=new WeakMap,wa);Object.defineProperties(Bl.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});oh=Bl,ea=oh});var bn,xn,wl,uh,lh,En,Qs=mn(()=>{Sn();uh=(wl=class extends ea{constructor(t,a,r={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,r);wt(this,bn,0);wt(this,xn,"");r===null&&(r={});let n=r.lastModified===void 0?Date.now():Number(r.lastModified);Number.isNaN(n)||vt(this,bn,n),vt(this,xn,String(a))}get name(){return Re(this,xn)}get lastModified(){return Re(this,bn)}get[Symbol.toStringTag](){return"File"}},bn=new WeakMap,xn=new WeakMap,wl),lh=uh,En=lh});function Ll(e,t=ea){var a=`${Rl()}${Rl()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),r=[],n=`--${a}\r
Content-Disposition: form-data; name="`;return e.forEach((i,s)=>typeof i=="string"?r.push(n+js(s)+`"\r
\r
${i.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):r.push(n+js(s)+`"; filename="${js(i.name,1)}"\r
Content-Type: ${i.type||"application/octet-stream"}\r
\r
`,i,`\r
`)),r.push(`--${a}--`),new t(r,{type:"multipart/form-data; boundary="+a})}var Tn,fh,ch,Rl,dh,Nl,js,ta,Nt,kl,Ra,$s=mn(()=>{Sn();Qs();({toStringTag:Tn,iterator:fh,hasInstance:ch}=Symbol),Rl=Math.random,dh="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),Nl=(e,t,a)=>(e+="",/^(Blob|File)$/.test(t&&t[Tn])?[(a=a!==void 0?a+"":t[Tn]=="File"?t.name:"blob",e),t.name!==a||t[Tn]=="blob"?new En([t],a,t):t]:[e,t+""]),js=(e,t)=>(t?e:e.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),ta=(e,t,a)=>{if(t.length<a)throw new TypeError(`Failed to execute '${e}' on 'FormData': ${a} arguments required, but only ${t.length} present.`)},Ra=(kl=class{constructor(...t){wt(this,Nt,[]);if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[Tn](){return"FormData"}[fh](){return this.entries()}static[ch](t){return t&&typeof t=="object"&&t[Tn]==="FormData"&&!dh.some(a=>typeof t[a]!="function")}append(...t){ta("append",arguments,2),Re(this,Nt).push(Nl(...t))}delete(t){ta("delete",arguments,1),t+="",vt(this,Nt,Re(this,Nt).filter(([a])=>a!==t))}get(t){ta("get",arguments,1),t+="";for(var a=Re(this,Nt),r=a.length,n=0;n<r;n++)if(a[n][0]===t)return a[n][1];return null}getAll(t,a){return ta("getAll",arguments,1),a=[],t+="",Re(this,Nt).forEach(r=>r[0]===t&&a.push(r[1])),a}has(t){return ta("has",arguments,1),t+="",Re(this,Nt).some(a=>a[0]===t)}forEach(t,a){ta("forEach",arguments,1);for(var[r,n]of this)t.call(a,n,r,this)}set(...t){ta("set",arguments,2);var a=[],r=!0;t=Nl(...t),Re(this,Nt).forEach(n=>{n[0]===t[0]?r&&(r=!a.push(t)):a.push(n)}),r&&a.push(t),vt(this,Nt,a)}*entries(){yield*Re(this,Nt)}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}},Nt=new WeakMap,kl)});var _n,Dl,hh,ph,ra,Na,Xs,yh,Ul=mn(()=>{_n=require("fs"),Dl=require("worker_threads");Qs();Sn();({stat:hh}=_n.promises),ph=globalThis.DOMException||(()=>{let e=new Dl.MessageChannel().port1,t=new ArrayBuffer(0);try{e.postMessage(t,[t,t])}catch(a){return a.constructor}})(),Xs=class{constructor(t){wt(this,ra,void 0);wt(this,Na,void 0);vt(this,ra,t.path),vt(this,Na,t.start),this.size=t.size,this.lastModified=t.lastModified}slice(t,a){return new Xs({path:Re(this,ra),lastModified:this.lastModified,size:a-t,start:t})}async*stream(){let{mtimeMs:t}=await hh(Re(this,ra));if(t>this.lastModified)throw new ph("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,_n.createReadStream)(Re(this,ra),{start:Re(this,Na),end:Re(this,Na)+this.size-1})}get[Symbol.toStringTag](){return"Blob"}},yh=Xs;ra=new WeakMap,Na=new WeakMap});var Vl={};Sl(Vl,{toFormData:()=>bh});function Eh(e){let t=e.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let a=t[2]||t[3]||"",r=a.slice(a.lastIndexOf("\\")+1);return r=r.replace(/%22/g,'"'),r=r.replace(/&#(\d{4});/g,(n,i)=>String.fromCharCode(i)),r}async function bh(e,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let a=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!a)throw new TypeError("no or bad content-type header, no multipart boundary");let r=new Fl(a[1]||a[2]),n,i,s,u,f,c,d=[],h=new Ra,C=b=>{s+=S.decode(b,{stream:!0})},E=b=>{d.push(b)},v=()=>{let b=new En(d,c,{type:f});h.append(u,b)},_=()=>{h.append(u,s)},S=new TextDecoder("utf-8");S.decode(),r.onPartBegin=function(){r.onPartData=C,r.onPartEnd=_,n="",i="",s="",u="",f="",c=null,d.length=0},r.onHeaderField=function(b){n+=S.decode(b,{stream:!0})},r.onHeaderValue=function(b){i+=S.decode(b,{stream:!0})},r.onHeaderEnd=function(){if(i+=S.decode(),n=n.toLowerCase(),n==="content-disposition"){let b=i.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);b&&(u=b[2]||b[3]||""),c=Eh(i),c&&(r.onPartData=E,r.onPartEnd=v)}else n==="content-type"&&(f=i);i="",n=""};for await(let b of e)r.write(b);return r.end(),h}var Zt,Ne,Ol,kr,Bi,wi,gh,In,mh,vh,Ch,Sh,aa,Fl,ql=mn(()=>{Ul();$s();Zt=0,Ne={START_BOUNDARY:Zt++,HEADER_FIELD_START:Zt++,HEADER_FIELD:Zt++,HEADER_VALUE_START:Zt++,HEADER_VALUE:Zt++,HEADER_VALUE_ALMOST_DONE:Zt++,HEADERS_ALMOST_DONE:Zt++,PART_DATA_START:Zt++,PART_DATA:Zt++,END:Zt++},Ol=1,kr={PART_BOUNDARY:Ol,LAST_BOUNDARY:Ol*=2},Bi=10,wi=13,gh=32,In=45,mh=58,vh=97,Ch=122,Sh=e=>e|32,aa=()=>{},Fl=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=aa,this.onHeaderField=aa,this.onHeadersEnd=aa,this.onHeaderValue=aa,this.onPartBegin=aa,this.onPartData=aa,this.onPartEnd=aa,this.boundaryChars={},t=`\r
--`+t;let a=new Uint8Array(t.length);for(let r=0;r<t.length;r++)a[r]=t.charCodeAt(r),this.boundaryChars[a[r]]=!0;this.boundary=a,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=Ne.START_BOUNDARY}write(t){let a=0,r=t.length,n=this.index,{lookbehind:i,boundary:s,boundaryChars:u,index:f,state:c,flags:d}=this,h=this.boundary.length,C=h-1,E=t.length,v,_,S=P=>{this[P+"Mark"]=a},b=P=>{delete this[P+"Mark"]},A=(P,k,N,G)=>{(k===void 0||k!==N)&&this[P](G&&G.subarray(k,N))},w=(P,k)=>{let N=P+"Mark";N in this&&(k?(A(P,this[N],a,t),delete this[N]):(A(P,this[N],t.length,t),this[N]=0))};for(a=0;a<r;a++)switch(v=t[a],c){case Ne.START_BOUNDARY:if(f===s.length-2){if(v===In)d|=kr.LAST_BOUNDARY;else if(v!==wi)return;f++;break}else if(f-1===s.length-2){if(d&kr.LAST_BOUNDARY&&v===In)c=Ne.END,d=0;else if(!(d&kr.LAST_BOUNDARY)&&v===Bi)f=0,A("onPartBegin"),c=Ne.HEADER_FIELD_START;else return;break}v!==s[f+2]&&(f=-2),v===s[f+2]&&f++;break;case Ne.HEADER_FIELD_START:c=Ne.HEADER_FIELD,S("onHeaderField"),f=0;case Ne.HEADER_FIELD:if(v===wi){b("onHeaderField"),c=Ne.HEADERS_ALMOST_DONE;break}if(f++,v===In)break;if(v===mh){if(f===1)return;w("onHeaderField",!0),c=Ne.HEADER_VALUE_START;break}if(_=Sh(v),_<vh||_>Ch)return;break;case Ne.HEADER_VALUE_START:if(v===gh)break;S("onHeaderValue"),c=Ne.HEADER_VALUE;case Ne.HEADER_VALUE:v===wi&&(w("onHeaderValue",!0),A("onHeaderEnd"),c=Ne.HEADER_VALUE_ALMOST_DONE);break;case Ne.HEADER_VALUE_ALMOST_DONE:if(v!==Bi)return;c=Ne.HEADER_FIELD_START;break;case Ne.HEADERS_ALMOST_DONE:if(v!==Bi)return;A("onHeadersEnd"),c=Ne.PART_DATA_START;break;case Ne.PART_DATA_START:c=Ne.PART_DATA,S("onPartData");case Ne.PART_DATA:if(n=f,f===0){for(a+=C;a<E&&!(t[a]in u);)a+=h;a-=C,v=t[a]}if(f<s.length)s[f]===v?(f===0&&w("onPartData",!0),f++):f=0;else if(f===s.length)f++,v===wi?d|=kr.PART_BOUNDARY:v===In?d|=kr.LAST_BOUNDARY:f=0;else if(f-1===s.length)if(d&kr.PART_BOUNDARY){if(f=0,v===Bi){d&=~kr.PART_BOUNDARY,A("onPartEnd"),A("onPartBegin"),c=Ne.HEADER_FIELD_START;break}}else d&kr.LAST_BOUNDARY&&v===In?(A("onPartEnd"),c=Ne.END,d=0):f=0;if(f>0)i[f-1]=v;else if(n>0){let P=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);A("onPartData",0,n,P),n=0,S("onPartData"),a--}break;case Ne.END:break;default:throw new Error(`Unexpected state entered: ${c}`)}w("onHeaderField"),w("onHeaderValue"),w("onPartData"),this.index=f,this.state=c,this.flags=d}end(){if(this.state===Ne.HEADER_FIELD_START&&this.index===0||this.state===Ne.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==Ne.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var Fi=ae((Bv,Oi)=>{(function(){"use strict";var e=typeof window=="object"?window:{},t=!e.HI_BASE32_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;t&&(e=global);var a=!e.HI_BASE32_NO_COMMON_JS&&typeof Oi=="object"&&Oi.exports,r=typeof define=="function"&&define.amd,n="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split(""),i={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,"2":26,"3":27,"4":28,"5":29,"6":30,"7":31},s=[0,0,0,0,0,0,0,0],u=function(S,b){b.length>10&&(b="..."+b.substr(-10));var A=new Error("Decoded data is not valid UTF-8. Maybe try base32.decode.asBytes()? Partial data after reading "+S+" bytes: "+b+" <-");throw A.position=S,A},f=function(S){for(var b="",A=S.length,w=0,P=0,k,N;w<A;){if(k=S[w++],k<=127){b+=String.fromCharCode(k);continue}else k>191&&k<=223?(N=k&31,P=1):k<=239?(N=k&15,P=2):k<=247?(N=k&7,P=3):u(w,b);for(var G=0;G<P;++G)k=S[w++],(k<128||k>191)&&u(w,b),N<<=6,N+=k&63;N>=55296&&N<=57343&&u(w,b),N>1114111&&u(w,b),N<=65535?b+=String.fromCharCode(N):(N-=65536,b+=String.fromCharCode((N>>10)+55296),b+=String.fromCharCode((N&1023)+56320))}return b},c=function(S){if(S==="")return[];if(!/^[A-Z2-7=]+$/.test(S))throw new Error("Invalid base32 characters");S=S.replace(/=/g,"");for(var b,A,w,P,k,N,G,q,Y=[],H=0,re=S.length,K=0,xe=re>>3<<3;K<xe;)b=i[S.charAt(K++)],A=i[S.charAt(K++)],w=i[S.charAt(K++)],P=i[S.charAt(K++)],k=i[S.charAt(K++)],N=i[S.charAt(K++)],G=i[S.charAt(K++)],q=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255,Y[H++]=(A<<6|w<<1|P>>>4)&255,Y[H++]=(P<<4|k>>>1)&255,Y[H++]=(k<<7|N<<2|G>>>3)&255,Y[H++]=(G<<5|q)&255;var Pe=re-xe;return Pe===2?(b=i[S.charAt(K++)],A=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255):Pe===4?(b=i[S.charAt(K++)],A=i[S.charAt(K++)],w=i[S.charAt(K++)],P=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255,Y[H++]=(A<<6|w<<1|P>>>4)&255):Pe===5?(b=i[S.charAt(K++)],A=i[S.charAt(K++)],w=i[S.charAt(K++)],P=i[S.charAt(K++)],k=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255,Y[H++]=(A<<6|w<<1|P>>>4)&255,Y[H++]=(P<<4|k>>>1)&255):Pe===7&&(b=i[S.charAt(K++)],A=i[S.charAt(K++)],w=i[S.charAt(K++)],P=i[S.charAt(K++)],k=i[S.charAt(K++)],N=i[S.charAt(K++)],G=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255,Y[H++]=(A<<6|w<<1|P>>>4)&255,Y[H++]=(P<<4|k>>>1)&255,Y[H++]=(k<<7|N<<2|G>>>3)&255),Y},d=function(S){for(var b,A,w,P,k,N="",G=S.length,q=0,Y=parseInt(G/5)*5;q<Y;)b=S.charCodeAt(q++),A=S.charCodeAt(q++),w=S.charCodeAt(q++),P=S.charCodeAt(q++),k=S.charCodeAt(q++),N+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|P>>>7)&31]+n[P>>>2&31]+n[(P<<3|k>>>5)&31]+n[k&31];var H=G-Y;return H===1?(b=S.charCodeAt(q),N+=n[b>>>3]+n[b<<2&31]+"======"):H===2?(b=S.charCodeAt(q++),A=S.charCodeAt(q),N+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[A<<4&31]+"===="):H===3?(b=S.charCodeAt(q++),A=S.charCodeAt(q++),w=S.charCodeAt(q),N+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[w<<1&31]+"==="):H===4&&(b=S.charCodeAt(q++),A=S.charCodeAt(q++),w=S.charCodeAt(q++),P=S.charCodeAt(q),N+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|P>>>7)&31]+n[P>>>2&31]+n[P<<3&31]+"="),N},h=function(S){var b,A,w,P,k,N,G=!1,q="",Y=0,H,re=0,K=0,xe=S.length;if(S==="")return q;do{for(s[0]=s[5],s[1]=s[6],s[2]=s[7],H=re;Y<xe&&H<5;++Y)N=S.charCodeAt(Y),N<128?s[H++]=N:N<2048?(s[H++]=192|N>>6,s[H++]=128|N&63):N<55296||N>=57344?(s[H++]=224|N>>12,s[H++]=128|N>>6&63,s[H++]=128|N&63):(N=65536+((N&1023)<<10|S.charCodeAt(++Y)&1023),s[H++]=240|N>>18,s[H++]=128|N>>12&63,s[H++]=128|N>>6&63,s[H++]=128|N&63);K+=H-re,re=H-5,Y===xe&&++Y,Y>xe&&H<6&&(G=!0),b=s[0],H>4?(A=s[1],w=s[2],P=s[3],k=s[4],q+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|P>>>7)&31]+n[P>>>2&31]+n[(P<<3|k>>>5)&31]+n[k&31]):H===1?q+=n[b>>>3]+n[b<<2&31]+"======":H===2?(A=s[1],q+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[A<<4&31]+"===="):H===3?(A=s[1],w=s[2],q+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[w<<1&31]+"==="):(A=s[1],w=s[2],P=s[3],q+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|P>>>7)&31]+n[P>>>2&31]+n[P<<3&31]+"=")}while(!G);return q},C=function(S){for(var b,A,w,P,k,N="",G=S.length,q=0,Y=parseInt(G/5)*5;q<Y;)b=S[q++],A=S[q++],w=S[q++],P=S[q++],k=S[q++],N+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|P>>>7)&31]+n[P>>>2&31]+n[(P<<3|k>>>5)&31]+n[k&31];var H=G-Y;return H===1?(b=S[q],N+=n[b>>>3]+n[b<<2&31]+"======"):H===2?(b=S[q++],A=S[q],N+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[A<<4&31]+"===="):H===3?(b=S[q++],A=S[q++],w=S[q],N+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[w<<1&31]+"==="):H===4&&(b=S[q++],A=S[q++],w=S[q++],P=S[q],N+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|P>>>7)&31]+n[P>>>2&31]+n[P<<3&31]+"="),N},E=function(S,b){var A=typeof S!="string";return A&&S.constructor===ArrayBuffer&&(S=new Uint8Array(S)),A?C(S):b?d(S):h(S)},v=function(S,b){if(!b)return f(c(S));if(S==="")return"";if(!/^[A-Z2-7=]+$/.test(S))throw new Error("Invalid base32 characters");var A,w,P,k,N,G,q,Y,H="",re=S.indexOf("=");re===-1&&(re=S.length);for(var K=0,xe=re>>3<<3;K<xe;)A=i[S.charAt(K++)],w=i[S.charAt(K++)],P=i[S.charAt(K++)],k=i[S.charAt(K++)],N=i[S.charAt(K++)],G=i[S.charAt(K++)],q=i[S.charAt(K++)],Y=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)+String.fromCharCode((w<<6|P<<1|k>>>4)&255)+String.fromCharCode((k<<4|N>>>1)&255)+String.fromCharCode((N<<7|G<<2|q>>>3)&255)+String.fromCharCode((q<<5|Y)&255);var Pe=re-xe;return Pe===2?(A=i[S.charAt(K++)],w=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)):Pe===4?(A=i[S.charAt(K++)],w=i[S.charAt(K++)],P=i[S.charAt(K++)],k=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)+String.fromCharCode((w<<6|P<<1|k>>>4)&255)):Pe===5?(A=i[S.charAt(K++)],w=i[S.charAt(K++)],P=i[S.charAt(K++)],k=i[S.charAt(K++)],N=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)+String.fromCharCode((w<<6|P<<1|k>>>4)&255)+String.fromCharCode((k<<4|N>>>1)&255)):Pe===7&&(A=i[S.charAt(K++)],w=i[S.charAt(K++)],P=i[S.charAt(K++)],k=i[S.charAt(K++)],N=i[S.charAt(K++)],G=i[S.charAt(K++)],q=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)+String.fromCharCode((w<<6|P<<1|k>>>4)&255)+String.fromCharCode((k<<4|N>>>1)&255)+String.fromCharCode((N<<7|G<<2|q>>>3)&255)),H},_={encode:E,decode:v};v.asBytes=c,a?Oi.exports=_:(e.base32=_,r&&define(function(){return _}))})()});var ue=ae((wv,of)=>{of.exports={options:{usePureJavaScript:!1}}});var ff=ae((Rv,lf)=>{var ro={};lf.exports=ro;var uf={};ro.encode=function(e,t,a){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(a!==void 0&&typeof a!="number")throw new TypeError('"maxline" must be a number.');var r="";if(!(e instanceof Uint8Array))r=Bh(e,t);else{var n=0,i=t.length,s=t.charAt(0),u=[0];for(n=0;n<e.length;++n){for(var f=0,c=e[n];f<u.length;++f)c+=u[f]<<8,u[f]=c%i,c=c/i|0;for(;c>0;)u.push(c%i),c=c/i|0}for(n=0;e[n]===0&&n<e.length-1;++n)r+=s;for(n=u.length-1;n>=0;--n)r+=t[u[n]]}if(a){var d=new RegExp(".{1,"+a+"}","g");r=r.match(d).join(`\r
`)}return r};ro.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var a=uf[t];if(!a){a=uf[t]=[];for(var r=0;r<t.length;++r)a[t.charCodeAt(r)]=r}e=e.replace(/\s/g,"");for(var n=t.length,i=t.charAt(0),s=[0],r=0;r<e.length;r++){var u=a[e.charCodeAt(r)];if(u===void 0)return;for(var f=0,c=u;f<s.length;++f)c+=s[f]*n,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var d=0;e[d]===i&&d<e.length-1;++d)s.push(0);return typeof Buffer!="undefined"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function Bh(e,t){var a=0,r=t.length,n=t.charAt(0),i=[0];for(a=0;a<e.length();++a){for(var s=0,u=e.at(a);s<i.length;++s)u+=i[s]<<8,i[s]=u%r,u=u/r|0;for(;u>0;)i.push(u%r),u=u/r|0}var f="";for(a=0;e.at(a)===0&&a<e.length()-1;++a)f+=n;for(a=i.length-1;a>=0;--a)f+=t[i[a]];return f}});var me=ae((Nv,pf)=>{var cf=ue(),df=ff(),B=pf.exports=cf.util=cf.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){B.nextTick=process.nextTick,typeof setImmediate=="function"?B.setImmediate=setImmediate:B.setImmediate=B.nextTick;return}if(typeof setImmediate=="function"){B.setImmediate=function(){return setImmediate.apply(void 0,arguments)},B.nextTick=function(u){return setImmediate(u)};return}if(B.setImmediate=function(u){setTimeout(u,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let u=function(f){if(f.source===window&&f.data===e){f.stopPropagation();var c=t.slice();t.length=0,c.forEach(function(d){d()})}};var s=u,e="forge.setImmediate",t=[];B.setImmediate=function(f){t.push(f),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",u,!0)}if(typeof MutationObserver!="undefined"){var a=Date.now(),r=!0,n=document.createElement("div"),t=[];new MutationObserver(function(){var f=t.slice();t.length=0,f.forEach(function(c){c()})}).observe(n,{attributes:!0});var i=B.setImmediate;B.setImmediate=function(f){Date.now()-a>15?(a=Date.now(),i(f)):(t.push(f),t.length===1&&n.setAttribute("a",r=!r))}}B.nextTick=B.setImmediate})();B.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;B.globalScope=function(){return B.isNodejs?global:typeof self=="undefined"?window:self}();B.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};B.isArrayBuffer=function(e){return typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer};B.isArrayBufferView=function(e){return e&&B.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Ln(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}B.ByteBuffer=ao;function ao(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(B.isArrayBuffer(e)||B.isArrayBufferView(e))if(typeof Buffer!="undefined"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var a=0;a<t.length;++a)this.putByte(t[a])}}else(e instanceof ao||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}B.ByteStringBuffer=ao;var wh=4096;B.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>wh&&(this.data.substr(0,1),this._constructedStringLength=0)};B.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};B.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};B.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};B.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var a=this.data;t>0;)t&1&&(a+=e),t>>>=1,t>0&&(e+=e);return this.data=a,this._optimizeConstructedString(t),this};B.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};B.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(B.encodeUtf8(e))};B.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};B.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};B.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};B.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};B.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};B.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};B.ByteStringBuffer.prototype.putInt=function(e,t){Ln(t);var a="";do t-=8,a+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(a)};B.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};B.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};B.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};B.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};B.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};B.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};B.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};B.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};B.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};B.ByteStringBuffer.prototype.getInt=function(e){Ln(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};B.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),a=2<<e-2;return t>=a&&(t-=a<<1),t};B.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};B.ByteStringBuffer.prototype.bytes=function(e){return typeof e=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};B.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};B.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};B.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};B.ByteStringBuffer.prototype.copy=function(){var e=B.createBuffer(this.data);return e.read=this.read,e};B.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};B.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};B.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};B.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var a=this.data.charCodeAt(t);a<16&&(e+="0"),e+=a.toString(16)}return e};B.ByteStringBuffer.prototype.toString=function(){return B.decodeUtf8(this.bytes())};function Rh(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var a=B.isArrayBuffer(e),r=B.isArrayBufferView(e);if(a||r){a?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}B.DataBuffer=Rh;B.DataBuffer.prototype.length=function(){return this.write-this.read};B.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};B.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var a=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(a),this.data=new DataView(r.buffer),this};B.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};B.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var a=0;a<t;++a)this.data.setUint8(e);return this};B.DataBuffer.prototype.putBytes=function(e,t){if(B.isArrayBufferView(e)){var a=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r=a.byteLength-a.byteOffset;this.accommodate(r);var n=new Uint8Array(this.data.buffer,this.write);return n.set(a),this.write+=r,this}if(B.isArrayBuffer(e)){var a=new Uint8Array(e);this.accommodate(a.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(a,this.write),this.write+=a.byteLength,this}if(e instanceof B.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&B.isArrayBufferView(e.data)){var a=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(a.byteLength);var n=new Uint8Array(e.data.byteLength,this.write);return n.set(a),this.write+=a.byteLength,this}if(e instanceof B.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var i;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.hex.decode(e,i,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),i=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.base64.decode(e,i,this.write),this;if(t==="utf8"&&(e=B.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.raw.decode(i),this;if(t==="utf16")return this.accommodate(e.length*2),i=new Uint16Array(this.data.buffer,this.write),this.write+=B.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};B.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};B.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};B.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};B.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};B.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};B.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};B.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};B.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};B.DataBuffer.prototype.putInt=function(e,t){Ln(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};B.DataBuffer.prototype.putSignedInt=function(e,t){return Ln(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};B.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};B.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};B.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};B.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};B.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};B.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};B.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};B.DataBuffer.prototype.getInt=function(e){Ln(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};B.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),a=2<<e-2;return t>=a&&(t-=a<<1),t};B.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};B.DataBuffer.prototype.bytes=function(e){return typeof e=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};B.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};B.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};B.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};B.DataBuffer.prototype.copy=function(){return new B.DataBuffer(this)};B.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};B.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};B.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};B.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var a=this.data.getUint8(t);a<16&&(e+="0"),e+=a.toString(16)}return e};B.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return B.binary.raw.encode(t);if(e==="hex")return B.binary.hex.encode(t);if(e==="base64")return B.binary.base64.encode(t);if(e==="utf8")return B.text.utf8.decode(t);if(e==="utf16")return B.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};B.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=B.encodeUtf8(e)),new B.ByteBuffer(e)};B.fillString=function(e,t){for(var a="";t>0;)t&1&&(a+=e),t>>>=1,t>0&&(e+=e);return a};B.xorBytes=function(e,t,a){for(var r="",n="",i="",s=0,u=0;a>0;--a,++s)n=e.charCodeAt(s)^t.charCodeAt(s),u>=10&&(r+=i,i="",u=0),i+=String.fromCharCode(n),++u;return r+=i,r};B.hexToBytes=function(e){var t="",a=0;for(e.length&!0&&(a=1,t+=String.fromCharCode(parseInt(e[0],16)));a<e.length;a+=2)t+=String.fromCharCode(parseInt(e.substr(a,2),16));return t};B.bytesToHex=function(e){return B.createBuffer(e).toHex()};B.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var Ur="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Or=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],hf="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";B.encode64=function(e,t){for(var a="",r="",n,i,s,u=0;u<e.length;)n=e.charCodeAt(u++),i=e.charCodeAt(u++),s=e.charCodeAt(u++),a+=Ur.charAt(n>>2),a+=Ur.charAt((n&3)<<4|i>>4),isNaN(i)?a+="==":(a+=Ur.charAt((i&15)<<2|s>>6),a+=isNaN(s)?"=":Ur.charAt(s&63)),t&&a.length>t&&(r+=a.substr(0,t)+`\r
`,a=a.substr(t));return r+=a,r};B.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",a,r,n,i,s=0;s<e.length;)a=Or[e.charCodeAt(s++)-43],r=Or[e.charCodeAt(s++)-43],n=Or[e.charCodeAt(s++)-43],i=Or[e.charCodeAt(s++)-43],t+=String.fromCharCode(a<<2|r>>4),n!==64&&(t+=String.fromCharCode((r&15)<<4|n>>2),i!==64&&(t+=String.fromCharCode((n&3)<<6|i)));return t};B.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};B.decodeUtf8=function(e){return decodeURIComponent(escape(e))};B.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:df.encode,decode:df.decode}};B.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};B.binary.raw.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(e.length)),a=a||0;for(var n=a,i=0;i<e.length;++i)r[n++]=e.charCodeAt(i);return t?n-a:r};B.binary.hex.encode=B.bytesToHex;B.binary.hex.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2))),a=a||0;var n=0,i=a;for(e.length&1&&(n=1,r[i++]=parseInt(e[0],16));n<e.length;n+=2)r[i++]=parseInt(e.substr(n,2),16);return t?i-a:r};B.binary.base64.encode=function(e,t){for(var a="",r="",n,i,s,u=0;u<e.byteLength;)n=e[u++],i=e[u++],s=e[u++],a+=Ur.charAt(n>>2),a+=Ur.charAt((n&3)<<4|i>>4),isNaN(i)?a+="==":(a+=Ur.charAt((i&15)<<2|s>>6),a+=isNaN(s)?"=":Ur.charAt(s&63)),t&&a.length>t&&(r+=a.substr(0,t)+`\r
`,a=a.substr(t));return r+=a,r};B.binary.base64.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),a=a||0;for(var n,i,s,u,f=0,c=a;f<e.length;)n=Or[e.charCodeAt(f++)-43],i=Or[e.charCodeAt(f++)-43],s=Or[e.charCodeAt(f++)-43],u=Or[e.charCodeAt(f++)-43],r[c++]=n<<2|i>>4,s!==64&&(r[c++]=(i&15)<<4|s>>2,u!==64&&(r[c++]=(s&3)<<6|u));return t?c-a:r.subarray(0,c)};B.binary.base58.encode=function(e,t){return B.binary.baseN.encode(e,hf,t)};B.binary.base58.decode=function(e,t){return B.binary.baseN.decode(e,hf,t)};B.text={utf8:{},utf16:{}};B.text.utf8.encode=function(e,t,a){e=B.encodeUtf8(e);var r=t;r||(r=new Uint8Array(e.length)),a=a||0;for(var n=a,i=0;i<e.length;++i)r[n++]=e.charCodeAt(i);return t?n-a:r};B.text.utf8.decode=function(e){return B.decodeUtf8(String.fromCharCode.apply(null,e))};B.text.utf16.encode=function(e,t,a){var r=t;r||(r=new Uint8Array(e.length*2));var n=new Uint16Array(r.buffer);a=a||0;for(var i=a,s=a,u=0;u<e.length;++u)n[s++]=e.charCodeAt(u),i+=2;return t?i-a:r};B.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};B.deflate=function(e,t,a){if(t=B.decode64(e.deflate(B.encode64(t)).rval),a){var r=2,n=t.charCodeAt(1);n&32&&(r=6),t=t.substring(r,t.length-4)}return t};B.inflate=function(e,t,a){var r=e.inflate(B.encode64(t)).rval;return r===null?null:B.decode64(r)};var no=function(e,t,a){if(!e)throw new Error("WebStorage not available.");var r;if(a===null?r=e.removeItem(t):(a=B.encode64(JSON.stringify(a)),r=e.setItem(t,a)),typeof r!="undefined"&&r.rval!==!0){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}},io=function(e,t){if(!e)throw new Error("WebStorage not available.");var a=e.getItem(t);if(e.init)if(a.rval===null){if(a.error){var r=new Error(a.error.message);throw r.id=a.error.id,r.name=a.error.name,r}a=null}else a=a.rval;return a!==null&&(a=JSON.parse(B.decode64(a))),a},Nh=function(e,t,a,r){var n=io(e,t);n===null&&(n={}),n[a]=r,no(e,t,n)},Lh=function(e,t,a){var r=io(e,t);return r!==null&&(r=a in r?r[a]:null),r},kh=function(e,t,a){var r=io(e,t);if(r!==null&&a in r){delete r[a];var n=!0;for(var i in r){n=!1;break}n&&(r=null),no(e,t,r)}},Ph=function(e,t){no(e,t,null)},Vi=function(e,t,a){var r=null;typeof a=="undefined"&&(a=["web","flash"]);var n,i=!1,s=null;for(var u in a){n=a[u];try{if(n==="flash"||n==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");r=e.apply(this,t),i=n==="flash"}(n==="web"||n==="both")&&(t[0]=localStorage,r=e.apply(this,t),i=!0)}catch(f){s=f}if(i)break}if(!i)throw s;return r};B.setItem=function(e,t,a,r,n){Vi(Nh,arguments,n)};B.getItem=function(e,t,a,r){return Vi(Lh,arguments,r)};B.removeItem=function(e,t,a,r){Vi(kh,arguments,r)};B.clearItems=function(e,t,a){Vi(Ph,arguments,a)};B.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};B.format=function(e){for(var t=/%./g,a,r,n=0,i=[],s=0;a=t.exec(e);){r=e.substring(s,t.lastIndex-2),r.length>0&&i.push(r),s=t.lastIndex;var u=a[0][1];switch(u){case"s":case"o":n<arguments.length?i.push(arguments[n+++1]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+u+"?>")}}return i.push(e.substring(s)),i.join("")};B.formatNumber=function(e,t,a,r){var n=e,i=isNaN(t=Math.abs(t))?2:t,s=a===void 0?",":a,u=r===void 0?".":r,f=n<0?"-":"",c=parseInt(n=Math.abs(+n||0).toFixed(i),10)+"",d=c.length>3?c.length%3:0;return f+(d?c.substr(0,d)+u:"")+c.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+u)+(i?s+Math.abs(n-c).toFixed(i).slice(2):"")};B.formatSize=function(e){return e>=1073741824?e=B.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=B.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=B.formatNumber(e/1024,0)+" KiB":e=B.formatNumber(e,0)+" bytes",e};B.bytesFromIP=function(e){return e.indexOf(".")!==-1?B.bytesFromIPv4(e):e.indexOf(":")!==-1?B.bytesFromIPv6(e):null};B.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=B.createBuffer(),a=0;a<e.length;++a){var r=parseInt(e[a],10);if(isNaN(r))return null;t.putByte(r)}return t.getBytes()};B.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(s){return s.length===0&&++t,!0});for(var a=(8-e.length+t)*2,r=B.createBuffer(),n=0;n<8;++n){if(!e[n]||e[n].length===0){r.fillWithByte(0,a),a=0;continue}var i=B.hexToBytes(e[n]);i.length<2&&r.putByte(0),r.putBytes(i)}return r.getBytes()};B.bytesToIP=function(e){return e.length===4?B.bytesToIPv4(e):e.length===16?B.bytesToIPv6(e):null};B.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],a=0;a<e.length;++a)t.push(e.charCodeAt(a));return t.join(".")};B.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],a=[],r=0,n=0;n<e.length;n+=2){for(var i=B.bytesToHex(e[n]+e[n+1]);i[0]==="0"&&i!=="0";)i=i.substr(1);if(i==="0"){var s=a[a.length-1],u=t.length;!s||u!==s.end+1?a.push({start:u,end:u}):(s.end=u,s.end-s.start>a[r].end-a[r].start&&(r=a.length-1))}t.push(i)}if(a.length>0){var f=a[r];f.end-f.start>0&&(t.splice(f.start,f.end-f.start+1,""),f.start===0&&t.unshift(""),f.end===7&&t.push(""))}return t.join(":")};B.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in B&&!e.update)return t(null,B.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return B.cores=navigator.hardwareConcurrency,t(null,B.cores);if(typeof Worker=="undefined")return B.cores=1,t(null,B.cores);if(typeof Blob=="undefined")return B.cores=2,t(null,B.cores);var a=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var u=Date.now(),f=u+4;Date.now()<f;);self.postMessage({st:u,et:f})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16);function r(s,u,f){if(u===0){var c=Math.floor(s.reduce(function(d,h){return d+h},0)/s.length);return B.cores=Math.max(1,c),URL.revokeObjectURL(a),t(null,B.cores)}n(f,function(d,h){s.push(i(f,h)),r(s,u-1,f)})}function n(s,u){for(var f=[],c=[],d=0;d<s;++d){var h=new Worker(a);h.addEventListener("message",function(C){if(c.push(C.data),c.length===s){for(var E=0;E<s;++E)f[E].terminate();u(null,c)}}),f.push(h)}for(var d=0;d<s;++d)f[d].postMessage(d)}function i(s,u){for(var f=[],c=0;c<s;++c)for(var d=u[c],h=f[c]=[],C=0;C<s;++C)if(c!==C){var E=u[C];(d.st>E.st&&d.st<E.et||E.st>d.st&&E.st<d.et)&&h.push(C)}return f.reduce(function(v,_){return Math.max(v,_.length)},0)}}});var qi=ae((Lv,yf)=>{var rt=ue();me();yf.exports=rt.cipher=rt.cipher||{};rt.cipher.algorithms=rt.cipher.algorithms||{};rt.cipher.createCipher=function(e,t){var a=e;if(typeof a=="string"&&(a=rt.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+e);return new rt.cipher.BlockCipher({algorithm:a,key:t,decrypt:!1})};rt.cipher.createDecipher=function(e,t){var a=e;if(typeof a=="string"&&(a=rt.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+e);return new rt.cipher.BlockCipher({algorithm:a,key:t,decrypt:!0})};rt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),rt.cipher.algorithms[e]=t};rt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in rt.cipher.algorithms?rt.cipher.algorithms[e]:null};var so=rt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};so.prototype.start=function(e){e=e||{};var t={};for(var a in e)t[a]=e[a];t.decrypt=this._decrypt,this._finish=!1,this._input=rt.util.createBuffer(),this.output=e.output||rt.util.createBuffer(),this.mode.start(t)};so.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};so.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(a){return e(this.blockSize,a,!1)},this.mode.unpad=function(a){return e(this.blockSize,a,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var uo=ae((kv,gf)=>{var at=ue();me();at.cipher=at.cipher||{};var le=gf.exports=at.cipher.modes=at.cipher.modes||{};le.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};le.ecb.prototype.start=function(e){};le.ecb.prototype.encrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};le.ecb.prototype.decrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};le.ecb.prototype.pad=function(e,t){var a=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(a,a),!0};le.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var a=e.length(),r=e.at(a-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};le.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};le.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=Mi(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};le.cbc.prototype.encrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r]);this._prev=this._outBlock};le.cbc.prototype.decrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)};le.cbc.prototype.pad=function(e,t){var a=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(a,a),!0};le.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var a=e.length(),r=e.at(a-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};le.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=at.util.createBuffer(),this._partialBytes=0};le.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Mi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};le.cfb.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32()^this._outBlock[n],t.putInt32(this._inBlock[n]);return}var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=e.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(i>0)e.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};le.cfb.prototype.decrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32(),t.putInt32(this._inBlock[n]^this._outBlock[n]);return}var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(i>0)e.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};le.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=at.util.createBuffer(),this._partialBytes=0};le.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Mi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};le.ofb.prototype.encrypt=function(e,t,a){var r=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)t.putInt32(e.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(e.getInt32()^this._outBlock[n]);if(i>0)e.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};le.ofb.prototype.decrypt=le.ofb.prototype.encrypt;le.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=at.util.createBuffer(),this._partialBytes=0};le.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Mi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};le.ctr.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize)for(var n=0;n<this._ints;++n)t.putInt32(e.getInt32()^this._outBlock[n]);else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(e.getInt32()^this._outBlock[n]);if(i>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}Ki(this._inBlock)};le.ctr.prototype.decrypt=le.ctr.prototype.encrypt;le.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=at.util.createBuffer(),this._partialBytes=0,this._R=3774873600};le.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=at.util.createBuffer(e.iv);this._cipherLength=0;var a;if("additionalData"in e?a=at.util.createBuffer(e.additionalData):a=at.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=at.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var r=t.length();if(r===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(oo(r*8)))}this._inBlock=this._j0.slice(0),Ki(this._inBlock),this._partialBytes=0,a=at.util.createBuffer(a),this._aDataLength=oo(a.length()*8);var n=a.length()%this.blockSize;for(n&&a.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];a.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[a.getInt32(),a.getInt32(),a.getInt32(),a.getInt32()])};le.gcm.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]^=e.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(e.getInt32()^this._outBlock[n]);if(i<=0||a){if(a){var s=r%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Ki(this._inBlock)};le.gcm.prototype.decrypt=function(e,t,a){var r=e.length();if(r<this.blockSize&&!(a&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Ki(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]^this._hashBlock[n]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize};le.gcm.prototype.afterFinish=function(e,t){var a=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=at.util.createBuffer();var r=this._aDataLength.concat(oo(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,r);var n=[];this.cipher.encrypt(this._j0,n);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^n[i]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(a=!1),a};le.gcm.prototype.multiply=function(e,t){for(var a=[0,0,0,0],r=t.slice(0),n=0;n<128;++n){var i=e[n/32|0]&1<<31-n%32;i&&(a[0]^=r[0],a[1]^=r[1],a[2]^=r[2],a[3]^=r[3]),this.pow(r,r)}return a};le.gcm.prototype.pow=function(e,t){for(var a=e[3]&1,r=3;r>0;--r)t[r]=e[r]>>>1|(e[r-1]&1)<<31;t[0]=e[0]>>>1,a&&(t[0]^=this._R)};le.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],a=0;a<32;++a){var r=a/8|0,n=e[r]>>>(7-a%8)*4&15,i=this._m[a][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t};le.gcm.prototype.ghash=function(e,t,a){return t[0]^=a[0],t[1]^=a[1],t[2]^=a[2],t[3]^=a[3],this.tableMultiply(t)};le.gcm.prototype.generateHashTable=function(e,t){for(var a=8/t,r=4*a,n=16*a,i=new Array(n),s=0;s<n;++s){var u=[0,0,0,0],f=s/r|0,c=(r-1-s%r)*t;u[f]=1<<t-1<<c,i[s]=this.generateSubHashTable(this.multiply(u,e),t)}return i};le.gcm.prototype.generateSubHashTable=function(e,t){var a=1<<t,r=a>>>1,n=new Array(a);n[r]=e.slice(0);for(var i=r>>>1;i>0;)this.pow(n[2*i],n[i]=[]),i>>=1;for(i=2;i<r;){for(var s=1;s<i;++s){var u=n[i],f=n[s];n[i+s]=[u[0]^f[0],u[1]^f[1],u[2]^f[2],u[3]^f[3]]}i*=2}for(n[0]=[0,0,0,0],i=r+1;i<a;++i){var c=n[i^r];n[i]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return n};function Mi(e,t){if(typeof e=="string"&&(e=at.util.createBuffer(e)),at.util.isArray(e)&&e.length>4){var a=e;e=at.util.createBuffer();for(var r=0;r<a.length;++r)e.putByte(a[r])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!at.util.isArray(e)){for(var n=[],i=t/4,r=0;r<i;++r)n.push(e.getInt32());e=n}return e}function Ki(e){e[e.length-1]=e[e.length-1]+1&4294967295}function oo(e){return[e/4294967296|0,e&4294967295]}});var Fr=ae((Pv,Sf)=>{var Le=ue();qi();uo();me();Sf.exports=Le.aes=Le.aes||{};Le.aes.startEncrypting=function(e,t,a,r){var n=Hi({key:e,output:a,decrypt:!1,mode:r});return n.start(t),n};Le.aes.createEncryptionCipher=function(e,t){return Hi({key:e,output:null,decrypt:!1,mode:t})};Le.aes.startDecrypting=function(e,t,a,r){var n=Hi({key:e,output:a,decrypt:!0,mode:r});return n.start(t),n};Le.aes.createDecryptionCipher=function(e,t){return Hi({key:e,output:null,decrypt:!0,mode:t})};Le.aes.Algorithm=function(e,t){lo||vf();var a=this;a.name=e,a.mode=new t({blockSize:16,cipher:{encrypt:function(r,n){return co(a._w,r,n,!1)},decrypt:function(r,n){return co(a._w,r,n,!0)}}}),a._init=!1};Le.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,a;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=Le.util.createBuffer(t);else if(Le.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){a=t,t=Le.util.createBuffer();for(var r=0;r<a.length;++r)t.putByte(a[r])}if(!Le.util.isArray(t)){a=t,t=[];var n=a.length();if(n===16||n===24||n===32){n=n>>>2;for(var r=0;r<n;++r)t.push(a.getInt32())}}if(!Le.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var i=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(i)!==-1;this._w=Cf(t,e.decrypt&&!s),this._init=!0}};Le.aes._expandKey=function(e,t){return lo||vf(),Cf(e,t)};Le.aes._updateBlock=co;Ua("AES-ECB",Le.cipher.modes.ecb);Ua("AES-CBC",Le.cipher.modes.cbc);Ua("AES-CFB",Le.cipher.modes.cfb);Ua("AES-OFB",Le.cipher.modes.ofb);Ua("AES-CTR",Le.cipher.modes.ctr);Ua("AES-GCM",Le.cipher.modes.gcm);function Ua(e,t){var a=function(){return new Le.aes.Algorithm(e,t)};Le.cipher.registerAlgorithm(e,a)}var lo=!1,Oa=4,ht,fo,mf,ia,Gt;function vf(){lo=!0,mf=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;ht=new Array(256),fo=new Array(256),ia=new Array(4),Gt=new Array(4);for(var t=0;t<4;++t)ia[t]=new Array(256),Gt[t]=new Array(256);for(var a=0,r=0,n,i,s,u,f,c,d,t=0;t<256;++t){u=r^r<<1^r<<2^r<<3^r<<4,u=u>>8^u&255^99,ht[a]=u,fo[u]=a,f=e[u],n=e[a],i=e[n],s=e[i],c=f<<24^u<<16^u<<8^(u^f),d=(n^i^s)<<24^(a^s)<<16^(a^i^s)<<8^(a^n^s);for(var h=0;h<4;++h)ia[h][a]=c,Gt[h][u]=d,c=c<<24|c>>>8,d=d<<24|d>>>8;a===0?a=r=1:(a=n^e[e[e[n^s]]],r^=e[e[r]])}}function Cf(e,t){for(var a=e.slice(0),r,n=1,i=a.length,s=i+6+1,u=Oa*s,f=i;f<u;++f)r=a[f-1],f%i===0?(r=ht[r>>>16&255]<<24^ht[r>>>8&255]<<16^ht[r&255]<<8^ht[r>>>24]^mf[n]<<24,n++):i>6&&f%i===4&&(r=ht[r>>>24]<<24^ht[r>>>16&255]<<16^ht[r>>>8&255]<<8^ht[r&255]),a[f]=a[f-i]^r;if(t){var c,d=Gt[0],h=Gt[1],C=Gt[2],E=Gt[3],v=a.slice(0);u=a.length;for(var f=0,_=u-Oa;f<u;f+=Oa,_-=Oa)if(f===0||f===u-Oa)v[f]=a[_],v[f+1]=a[_+3],v[f+2]=a[_+2],v[f+3]=a[_+1];else for(var S=0;S<Oa;++S)c=a[_+S],v[f+(3&-S)]=d[ht[c>>>24]]^h[ht[c>>>16&255]]^C[ht[c>>>8&255]]^E[ht[c&255]];a=v}return a}function co(e,t,a,r){var n=e.length/4-1,i,s,u,f,c;r?(i=Gt[0],s=Gt[1],u=Gt[2],f=Gt[3],c=fo):(i=ia[0],s=ia[1],u=ia[2],f=ia[3],c=ht);var d,h,C,E,v,_,S;d=t[0]^e[0],h=t[r?3:1]^e[1],C=t[2]^e[2],E=t[r?1:3]^e[3];for(var b=3,A=1;A<n;++A)v=i[d>>>24]^s[h>>>16&255]^u[C>>>8&255]^f[E&255]^e[++b],_=i[h>>>24]^s[C>>>16&255]^u[E>>>8&255]^f[d&255]^e[++b],S=i[C>>>24]^s[E>>>16&255]^u[d>>>8&255]^f[h&255]^e[++b],E=i[E>>>24]^s[d>>>16&255]^u[h>>>8&255]^f[C&255]^e[++b],d=v,h=_,C=S;a[0]=c[d>>>24]<<24^c[h>>>16&255]<<16^c[C>>>8&255]<<8^c[E&255]^e[++b],a[r?3:1]=c[h>>>24]<<24^c[C>>>16&255]<<16^c[E>>>8&255]<<8^c[d&255]^e[++b],a[2]=c[C>>>24]<<24^c[E>>>16&255]<<16^c[d>>>8&255]<<8^c[h&255]^e[++b],a[r?1:3]=c[E>>>24]<<24^c[d>>>16&255]<<16^c[h>>>8&255]<<8^c[C&255]^e[++b]}function Hi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),a="AES-"+t,r;e.decrypt?r=Le.cipher.createDecipher(a,e.key):r=Le.cipher.createCipher(a,e.key);var n=r.start;return r.start=function(i,s){var u=null;s instanceof Le.util.ByteBuffer&&(u=s,s={}),s=s||{},s.output=u,s.iv=i,n.call(r,s)},r}});var Vr=ae((Dv,Ef)=>{var kn=ue();kn.pki=kn.pki||{};var ho=Ef.exports=kn.pki.oids=kn.oids=kn.oids||{};function M(e,t){ho[e]=t,ho[t]=e}function be(e,t){ho[e]=t}M("1.2.840.113549.1.1.1","rsaEncryption");M("1.2.840.113549.1.1.4","md5WithRSAEncryption");M("1.2.840.113549.1.1.5","sha1WithRSAEncryption");M("1.2.840.113549.1.1.7","RSAES-OAEP");M("1.2.840.113549.1.1.8","mgf1");M("1.2.840.113549.1.1.9","pSpecified");M("1.2.840.113549.1.1.10","RSASSA-PSS");M("1.2.840.113549.1.1.11","sha256WithRSAEncryption");M("1.2.840.113549.1.1.12","sha384WithRSAEncryption");M("1.2.840.113549.1.1.13","sha512WithRSAEncryption");M("1.3.101.112","EdDSA25519");M("1.2.840.10040.4.3","dsa-with-sha1");M("1.3.14.3.2.7","desCBC");M("1.3.14.3.2.26","sha1");M("1.3.14.3.2.29","sha1WithRSASignature");M("2.16.840.1.101.3.4.2.1","sha256");M("2.16.840.1.101.3.4.2.2","sha384");M("2.16.840.1.101.3.4.2.3","sha512");M("1.2.840.113549.2.5","md5");M("1.2.840.113549.1.7.1","data");M("1.2.840.113549.1.7.2","signedData");M("1.2.840.113549.1.7.3","envelopedData");M("1.2.840.113549.1.7.4","signedAndEnvelopedData");M("1.2.840.113549.1.7.5","digestedData");M("1.2.840.113549.1.7.6","encryptedData");M("1.2.840.113549.1.9.1","emailAddress");M("1.2.840.113549.1.9.2","unstructuredName");M("1.2.840.113549.1.9.3","contentType");M("1.2.840.113549.1.9.4","messageDigest");M("1.2.840.113549.1.9.5","signingTime");M("1.2.840.113549.1.9.6","counterSignature");M("1.2.840.113549.1.9.7","challengePassword");M("1.2.840.113549.1.9.8","unstructuredAddress");M("1.2.840.113549.1.9.14","extensionRequest");M("1.2.840.113549.1.9.20","friendlyName");M("1.2.840.113549.1.9.21","localKeyId");M("1.2.840.113549.1.9.22.1","x509Certificate");M("1.2.840.113549.1.12.10.1.1","keyBag");M("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");M("1.2.840.113549.1.12.10.1.3","certBag");M("1.2.840.113549.1.12.10.1.4","crlBag");M("1.2.840.113549.1.12.10.1.5","secretBag");M("1.2.840.113549.1.12.10.1.6","safeContentsBag");M("1.2.840.113549.1.5.13","pkcs5PBES2");M("1.2.840.113549.1.5.12","pkcs5PBKDF2");M("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");M("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");M("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");M("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");M("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");M("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");M("1.2.840.113549.2.7","hmacWithSHA1");M("1.2.840.113549.2.8","hmacWithSHA224");M("1.2.840.113549.2.9","hmacWithSHA256");M("1.2.840.113549.2.10","hmacWithSHA384");M("1.2.840.113549.2.11","hmacWithSHA512");M("1.2.840.113549.3.7","des-EDE3-CBC");M("2.16.840.1.101.3.4.1.2","aes128-CBC");M("2.16.840.1.101.3.4.1.22","aes192-CBC");M("2.16.840.1.101.3.4.1.42","aes256-CBC");M("2.5.4.3","commonName");M("2.5.4.4","surname");M("2.5.4.5","serialNumber");M("2.5.4.6","countryName");M("2.5.4.7","localityName");M("2.5.4.8","stateOrProvinceName");M("2.5.4.9","streetAddress");M("2.5.4.10","organizationName");M("2.5.4.11","organizationalUnitName");M("2.5.4.12","title");M("2.5.4.13","description");M("2.5.4.15","businessCategory");M("2.5.4.17","postalCode");M("2.5.4.42","givenName");M("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");M("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");M("2.16.840.1.113730.1.1","nsCertType");M("2.16.840.1.113730.1.13","nsComment");be("2.5.29.1","authorityKeyIdentifier");be("2.5.29.2","keyAttributes");be("2.5.29.3","certificatePolicies");be("2.5.29.4","keyUsageRestriction");be("2.5.29.5","policyMapping");be("2.5.29.6","subtreesConstraint");be("2.5.29.7","subjectAltName");be("2.5.29.8","issuerAltName");be("2.5.29.9","subjectDirectoryAttributes");be("2.5.29.10","basicConstraints");be("2.5.29.11","nameConstraints");be("2.5.29.12","policyConstraints");be("2.5.29.13","basicConstraints");M("2.5.29.14","subjectKeyIdentifier");M("2.5.29.15","keyUsage");be("2.5.29.16","privateKeyUsagePeriod");M("2.5.29.17","subjectAltName");M("2.5.29.18","issuerAltName");M("2.5.29.19","basicConstraints");be("2.5.29.20","cRLNumber");be("2.5.29.21","cRLReason");be("2.5.29.22","expirationDate");be("2.5.29.23","instructionCode");be("2.5.29.24","invalidityDate");be("2.5.29.25","cRLDistributionPoints");be("2.5.29.26","issuingDistributionPoint");be("2.5.29.27","deltaCRLIndicator");be("2.5.29.28","issuingDistributionPoint");be("2.5.29.29","certificateIssuer");be("2.5.29.30","nameConstraints");M("2.5.29.31","cRLDistributionPoints");M("2.5.29.32","certificatePolicies");be("2.5.29.33","policyMappings");be("2.5.29.34","policyConstraints");M("2.5.29.35","authorityKeyIdentifier");be("2.5.29.36","policyConstraints");M("2.5.29.37","extKeyUsage");be("2.5.29.46","freshestCRL");be("2.5.29.54","inhibitAnyPolicy");M("1.3.6.1.4.1.11129.2.4.2","timestampList");M("1.3.6.1.5.5.7.1.1","authorityInfoAccess");M("1.3.6.1.5.5.7.3.1","serverAuth");M("1.3.6.1.5.5.7.3.2","clientAuth");M("1.3.6.1.5.5.7.3.3","codeSigning");M("1.3.6.1.5.5.7.3.4","emailProtection");M("1.3.6.1.5.5.7.3.8","timeStamping")});var Qt=ae((Uv,xf)=>{var Fe=ue();me();Vr();var Q=xf.exports=Fe.asn1=Fe.asn1||{};Q.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Q.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Q.create=function(e,t,a,r,n){if(Fe.util.isArray(r)){for(var i=[],s=0;s<r.length;++s)r[s]!==void 0&&i.push(r[s]);r=i}var u={tagClass:e,type:t,constructed:a,composed:a||Fe.util.isArray(r),value:r};return n&&"bitStringContents"in n&&(u.bitStringContents=n.bitStringContents,u.original=Q.copy(u)),u};Q.copy=function(e,t){var a;if(Fe.util.isArray(e)){a=[];for(var r=0;r<e.length;++r)a.push(Q.copy(e[r],t));return a}return typeof e=="string"?e:(a={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:Q.copy(e.value,t)},t&&!t.excludeBitStringContents&&(a.bitStringContents=e.bitStringContents),a)};Q.equals=function(e,t,a){if(Fe.util.isArray(e)){if(!Fe.util.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!Q.equals(e[r],t[r]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var n=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&Q.equals(e.value,t.value);return a&&a.includeBitStringContents&&(n=n&&e.bitStringContents===t.bitStringContents),n};Q.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var a,r=t&128;return r?a=e.getInt((t&127)<<3):a=t,a}};function Pn(e,t,a){if(a>t){var r=new Error("Too few bytes to parse DER.");throw r.available=e.length(),r.remaining=t,r.requested=a,r}}var Dh=function(e,t){var a=e.getByte();if(t--,a!==128){var r,n=a&128;if(!n)r=a;else{var i=a&127;Pn(e,t,i),r=e.getInt(i<<3)}if(r<0)throw new Error("Negative length: "+r);return r}};Q.fromDer=function(e,t){return t===void 0&&(t={strict:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=Fe.util.createBuffer(e)),zi(e,e.length(),0,t)};function zi(e,t,a,r){var n;Pn(e,t,2);var i=e.getByte();t--;var s=i&192,u=i&31;n=e.length();var f=Dh(e,t);if(t-=n-e.length(),f!==void 0&&f>t){if(r.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=e.length(),c.remaining=t,c.requested=f,c}f=t}var d,h,C=(i&32)===32;if(C)if(d=[],f===void 0)for(;;){if(Pn(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}n=e.length(),d.push(zi(e,t,a+1,r)),t-=n-e.length()}else for(;f>0;)n=e.length(),d.push(zi(e,f,a+1,r)),t-=n-e.length(),f-=n-e.length();if(d===void 0&&s===Q.Class.UNIVERSAL&&u===Q.Type.BITSTRING&&(h=e.bytes(f)),d===void 0&&r.decodeBitStrings&&s===Q.Class.UNIVERSAL&&u===Q.Type.BITSTRING&&f>1){var E=e.read,v=t,_=0;if(u===Q.Type.BITSTRING&&(Pn(e,t,1),_=e.getByte(),t--),_===0)try{n=e.length();var S={verbose:r.verbose,strict:!0,decodeBitStrings:!0},b=zi(e,t,a+1,S),A=n-e.length();t-=A,u==Q.Type.BITSTRING&&A++;var w=b.tagClass;A===f&&(w===Q.Class.UNIVERSAL||w===Q.Class.CONTEXT_SPECIFIC)&&(d=[b])}catch{}d===void 0&&(e.read=E,t=v)}if(d===void 0){if(f===void 0){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(u===Q.Type.BMPSTRING)for(d="";f>0;f-=2)Pn(e,t,2),d+=String.fromCharCode(e.getInt16()),t-=2;else d=e.getBytes(f)}var P=h===void 0?null:{bitStringContents:h};return Q.create(s,u,C,d,P)}Q.toDer=function(e){var t=Fe.util.createBuffer(),a=e.tagClass|e.type,r=Fe.util.createBuffer(),n=!1;if("bitStringContents"in e&&(n=!0,e.original&&(n=Q.equals(e,e.original))),n)r.putBytes(e.bitStringContents);else if(e.composed){e.constructed?a|=32:r.putByte(0);for(var i=0;i<e.value.length;++i)e.value[i]!==void 0&&r.putBuffer(Q.toDer(e.value[i]))}else if(e.type===Q.Type.BMPSTRING)for(var i=0;i<e.value.length;++i)r.putInt16(e.value.charCodeAt(i));else e.type===Q.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&(e.value.charCodeAt(1)&128)===0||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?r.putBytes(e.value.substr(1)):r.putBytes(e.value);if(t.putByte(a),r.length()<=127)t.putByte(r.length()&127);else{var s=r.length(),u="";do u+=String.fromCharCode(s&255),s=s>>>8;while(s>0);t.putByte(u.length|128);for(var i=u.length-1;i>=0;--i)t.putByte(u.charCodeAt(i))}return t.putBuffer(r),t};Q.oidToDer=function(e){var t=e.split("."),a=Fe.util.createBuffer();a.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var r,n,i,s,u=2;u<t.length;++u){r=!0,n=[],i=parseInt(t[u],10);do s=i&127,i=i>>>7,r||(s|=128),n.push(s),r=!1;while(i>0);for(var f=n.length-1;f>=0;--f)a.putByte(n[f])}return a};Q.derToOid=function(e){var t;typeof e=="string"&&(e=Fe.util.createBuffer(e));var a=e.getByte();t=Math.floor(a/40)+"."+a%40;for(var r=0;e.length()>0;)a=e.getByte(),r=r<<7,a&128?r+=a&127:(t+="."+(r+a),r=0);return t};Q.utcTimeToDate=function(e){var t=new Date,a=parseInt(e.substr(0,2),10);a=a>=50?1900+a:2e3+a;var r=parseInt(e.substr(2,2),10)-1,n=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),u=0;if(e.length>11){var f=e.charAt(10),c=10;f!=="+"&&f!=="-"&&(u=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(a,r,n),t.setUTCHours(i,s,u,0),c&&(f=e.charAt(c),f==="+"||f==="-")){var d=parseInt(e.substr(c+1,2),10),h=parseInt(e.substr(c+4,2),10),C=d*60+h;C*=6e4,f==="+"?t.setTime(+t-C):t.setTime(+t+C)}return t};Q.generalizedTimeToDate=function(e){var t=new Date,a=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,n=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),u=parseInt(e.substr(12,2),10),f=0,c=0,d=!1;e.charAt(e.length-1)==="Z"&&(d=!0);var h=e.length-5,C=e.charAt(h);if(C==="+"||C==="-"){var E=parseInt(e.substr(h+1,2),10),v=parseInt(e.substr(h+4,2),10);c=E*60+v,c*=6e4,C==="+"&&(c*=-1),d=!0}return e.charAt(14)==="."&&(f=parseFloat(e.substr(14),10)*1e3),d?(t.setUTCFullYear(a,r,n),t.setUTCHours(i,s,u,f),t.setTime(+t+c)):(t.setFullYear(a,r,n),t.setHours(i,s,u,f)),t};Q.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",a=[];a.push((""+e.getUTCFullYear()).substr(2)),a.push(""+(e.getUTCMonth()+1)),a.push(""+e.getUTCDate()),a.push(""+e.getUTCHours()),a.push(""+e.getUTCMinutes()),a.push(""+e.getUTCSeconds());for(var r=0;r<a.length;++r)a[r].length<2&&(t+="0"),t+=a[r];return t+="Z",t};Q.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",a=[];a.push(""+e.getUTCFullYear()),a.push(""+(e.getUTCMonth()+1)),a.push(""+e.getUTCDate()),a.push(""+e.getUTCHours()),a.push(""+e.getUTCMinutes()),a.push(""+e.getUTCSeconds());for(var r=0;r<a.length;++r)a[r].length<2&&(t+="0"),t+=a[r];return t+="Z",t};Q.integerToDer=function(e){var t=Fe.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var a=new Error("Integer too large; max is 32-bits.");throw a.integer=e,a};Q.derToInteger=function(e){typeof e=="string"&&(e=Fe.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};Q.validate=function(e,t,a,r){var n=!1;if((e.tagClass===t.tagClass||typeof t.tagClass=="undefined")&&(e.type===t.type||typeof t.type=="undefined"))if(e.constructed===t.constructed||typeof t.constructed=="undefined"){if(n=!0,t.value&&Fe.util.isArray(t.value))for(var i=0,s=0;n&&s<t.value.length;++s)n=t.value[s].optional||!1,e.value[i]&&(n=Q.validate(e.value[i],t.value[s],a,r),n?++i:t.value[s].optional&&(n=!0)),!n&&r&&r.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(n&&a&&(t.capture&&(a[t.capture]=e.value),t.captureAsn1&&(a[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(a[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var u;if(e.bitStringContents.length<2)a[t.captureBitStringValue]="";else{var f=e.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");a[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else r&&r.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else r&&(e.tagClass!==t.tagClass&&r.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&r.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return n};var bf=/[^\\u0000-\\u00ff]/;Q.prettyPrint=function(e,t,a){var r="";t=t||0,a=a||2,t>0&&(r+=`
`);for(var n="",i=0;i<t*a;++i)n+=" ";switch(r+=n+"Tag: ",e.tagClass){case Q.Class.UNIVERSAL:r+="Universal:";break;case Q.Class.APPLICATION:r+="Application:";break;case Q.Class.CONTEXT_SPECIFIC:r+="Context-Specific:";break;case Q.Class.PRIVATE:r+="Private:";break}if(e.tagClass===Q.Class.UNIVERSAL)switch(r+=e.type,e.type){case Q.Type.NONE:r+=" (None)";break;case Q.Type.BOOLEAN:r+=" (Boolean)";break;case Q.Type.INTEGER:r+=" (Integer)";break;case Q.Type.BITSTRING:r+=" (Bit string)";break;case Q.Type.OCTETSTRING:r+=" (Octet string)";break;case Q.Type.NULL:r+=" (Null)";break;case Q.Type.OID:r+=" (Object Identifier)";break;case Q.Type.ODESC:r+=" (Object Descriptor)";break;case Q.Type.EXTERNAL:r+=" (External or Instance of)";break;case Q.Type.REAL:r+=" (Real)";break;case Q.Type.ENUMERATED:r+=" (Enumerated)";break;case Q.Type.EMBEDDED:r+=" (Embedded PDV)";break;case Q.Type.UTF8:r+=" (UTF8)";break;case Q.Type.ROID:r+=" (Relative Object Identifier)";break;case Q.Type.SEQUENCE:r+=" (Sequence)";break;case Q.Type.SET:r+=" (Set)";break;case Q.Type.PRINTABLESTRING:r+=" (Printable String)";break;case Q.Type.IA5String:r+=" (IA5String (ASCII))";break;case Q.Type.UTCTIME:r+=" (UTC time)";break;case Q.Type.GENERALIZEDTIME:r+=" (Generalized time)";break;case Q.Type.BMPSTRING:r+=" (BMP String)";break}else r+=e.type;if(r+=`
`,r+=n+"Constructed: "+e.constructed+`
`,e.composed){for(var s=0,u="",i=0;i<e.value.length;++i)e.value[i]!==void 0&&(s+=1,u+=Q.prettyPrint(e.value[i],t+1,a),i+1<e.value.length&&(u+=","));r+=n+"Sub values: "+s+u}else{if(r+=n+"Value: ",e.type===Q.Type.OID){var f=Q.derToOid(e.value);r+=f,Fe.pki&&Fe.pki.oids&&f in Fe.pki.oids&&(r+=" ("+Fe.pki.oids[f]+") ")}if(e.type===Q.Type.INTEGER)try{r+=Q.derToInteger(e.value)}catch{r+="0x"+Fe.util.bytesToHex(e.value)}else if(e.type===Q.Type.BITSTRING){if(e.value.length>1?r+="0x"+Fe.util.bytesToHex(e.value.slice(1)):r+="(none)",e.value.length>0){var c=e.value.charCodeAt(0);c==1?r+=" (1 unused bit shown)":c>1&&(r+=" ("+c+" unused bits shown)")}}else e.type===Q.Type.OCTETSTRING?(bf.test(e.value)||(r+="("+e.value+") "),r+="0x"+Fe.util.bytesToHex(e.value)):e.type===Q.Type.UTF8?r+=Fe.util.decodeUtf8(e.value):e.type===Q.Type.PRINTABLESTRING||e.type===Q.Type.IA5String?r+=e.value:bf.test(e.value)?r+="0x"+Fe.util.bytesToHex(e.value):e.value.length===0?r+="[null]":r+=e.value}return r}});var Jt=ae((Ov,Tf)=>{var Wi=ue();Tf.exports=Wi.md=Wi.md||{};Wi.md.algorithms=Wi.md.algorithms||{}});var Fa=ae((Fv,Af)=>{var vr=ue();Jt();me();var Uh=Af.exports=vr.hmac=vr.hmac||{};Uh.create=function(){var e=null,t=null,a=null,r=null,n={};return n.start=function(i,s){if(i!==null)if(typeof i=="string")if(i=i.toLowerCase(),i in vr.md.algorithms)t=vr.md.algorithms[i].create();else throw new Error('Unknown hash algorithm "'+i+'"');else t=i;if(s===null)s=e;else{if(typeof s=="string")s=vr.util.createBuffer(s);else if(vr.util.isArray(s)){var u=s;s=vr.util.createBuffer();for(var f=0;f<u.length;++f)s.putByte(u[f])}var c=s.length();c>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),a=vr.util.createBuffer(),r=vr.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var u=s.at(f);a.putByte(54^u),r.putByte(92^u)}if(c<t.blockLength)for(var u=t.blockLength-c,f=0;f<u;++f)a.putByte(54),r.putByte(92);e=s,a=a.bytes(),r=r.bytes()}t.start(),t.update(a)},n.update=function(i){t.update(i)},n.getMac=function(){var i=t.digest().bytes();return t.start(),t.update(r),t.update(i),t.digest()},n.digest=n.getMac,n}});var Qi=ae((Vv,wf)=>{var er=ue();Jt();me();var _f=wf.exports=er.md5=er.md5||{};er.md.md5=er.md.algorithms.md5=_f;_f.create=function(){If||Oh();var e=null,t=er.util.createBuffer(),a=new Array(16),r={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var n=r.messageLengthSize/4,i=0;i<n;++i)r.fullMessageLength.push(0);return t=er.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},r},r.start(),r.update=function(n,i){i==="utf8"&&(n=er.util.encodeUtf8(n));var s=n.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var u=r.fullMessageLength.length-1;u>=0;--u)r.fullMessageLength[u]+=s[1],s[1]=s[0]+(r.fullMessageLength[u]/4294967296>>>0),r.fullMessageLength[u]=r.fullMessageLength[u]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(n),Bf(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var n=er.util.createBuffer();n.putBytes(t.bytes());var i=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=i&r.blockLength-1;n.putBytes(po.substr(0,r.blockLength-s));for(var u,f=0,c=r.fullMessageLength.length-1;c>=0;--c)u=r.fullMessageLength[c]*8+f,f=u/4294967296>>>0,n.putInt32Le(u>>>0);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};Bf(d,a,n);var h=er.util.createBuffer();return h.putInt32Le(d.h0),h.putInt32Le(d.h1),h.putInt32Le(d.h2),h.putInt32Le(d.h3),h},r};var po=null,Gi=null,Dn=null,Va=null,If=!1;function Oh(){po=String.fromCharCode(128),po+=er.util.fillString(String.fromCharCode(0),64),Gi=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],Dn=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],Va=new Array(64);for(var e=0;e<64;++e)Va[e]=Math.floor(Math.abs(Math.sin(e+1))*4294967296);If=!0}function Bf(e,t,a){for(var r,n,i,s,u,f,c,d,h=a.length();h>=64;){for(n=e.h0,i=e.h1,s=e.h2,u=e.h3,d=0;d<16;++d)t[d]=a.getInt32Le(),f=u^i&(s^u),r=n+f+Va[d]+t[d],c=Dn[d],n=u,u=s,s=i,i+=r<<c|r>>>32-c;for(;d<32;++d)f=s^u&(i^s),r=n+f+Va[d]+t[Gi[d]],c=Dn[d],n=u,u=s,s=i,i+=r<<c|r>>>32-c;for(;d<48;++d)f=i^s^u,r=n+f+Va[d]+t[Gi[d]],c=Dn[d],n=u,u=s,s=i,i+=r<<c|r>>>32-c;for(;d<64;++d)f=s^(i|~u),r=n+f+Va[d]+t[Gi[d]],c=Dn[d],n=u,u=s,s=i,i+=r<<c|r>>>32-c;e.h0=e.h0+n|0,e.h1=e.h1+i|0,e.h2=e.h2+s|0,e.h3=e.h3+u|0,h-=64}}});var sa=ae((qv,Nf)=>{var ji=ue();me();var Rf=Nf.exports=ji.pem=ji.pem||{};Rf.encode=function(e,t){t=t||{};var a="-----BEGIN "+e.type+`-----\r
`,r;if(e.procType&&(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},a+=$i(r)),e.contentDomain&&(r={name:"Content-Domain",values:[e.contentDomain]},a+=$i(r)),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),a+=$i(r)),e.headers)for(var n=0;n<e.headers.length;++n)a+=$i(e.headers[n]);return e.procType&&(a+=`\r
`),a+=ji.util.encode64(e.body,t.maxline||64)+`\r
`,a+="-----END "+e.type+`-----\r
`,a};Rf.decode=function(e){for(var t=[],a=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,r=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,i;i=a.exec(e),!!i;){var s=i[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var u={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:ji.util.decode64(i[3])};if(t.push(u),!!i[2]){for(var f=i[2].split(n),c=0;i&&c<f.length;){for(var d=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var C=f[h];if(!/\s/.test(C[0]))break;d+=C,c=h}if(i=d.match(r),i){for(var E={name:i[1],values:[]},v=i[2].split(","),_=0;_<v.length;++_)E.values.push(Fh(v[_]));if(u.procType)if(!u.contentDomain&&E.name==="Content-Domain")u.contentDomain=v[0]||"";else if(!u.dekInfo&&E.name==="DEK-Info"){if(E.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');u.dekInfo={algorithm:v[0],parameters:v[1]||null}}else u.headers.push(E);else{if(E.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(E.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');u.procType={version:v[0],type:v[1]}}}++c}if(u.procType==="ENCRYPTED"&&!u.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function $i(e){for(var t=e.name+": ",a=[],r=function(f,c){return" "+c},n=0;n<e.values.length;++n)a.push(e.values[n].replace(/^(\S+\r\n)/,r));t+=a.join(",")+`\r
`;for(var i=0,s=-1,n=0;n<t.length;++n,++i)if(i>65&&s!==-1){var u=t[s];u===","?(++s,t=t.substr(0,s)+`\r
 `+t.substr(s)):t=t.substr(0,s)+`\r
`+u+t.substr(s+1),i=n-s-1,s=-1,++n}else(t[n]===" "||t[n]==="	"||t[n]===",")&&(s=n);return t}function Fh(e){return e.replace(/^\s+/,"")}});var Un=ae((Mv,kf)=>{var Ve=ue();qi();uo();me();kf.exports=Ve.des=Ve.des||{};Ve.des.startEncrypting=function(e,t,a,r){var n=Yi({key:e,output:a,decrypt:!1,mode:r||(t===null?"ECB":"CBC")});return n.start(t),n};Ve.des.createEncryptionCipher=function(e,t){return Yi({key:e,output:null,decrypt:!1,mode:t})};Ve.des.startDecrypting=function(e,t,a,r){var n=Yi({key:e,output:a,decrypt:!0,mode:r||(t===null?"ECB":"CBC")});return n.start(t),n};Ve.des.createDecryptionCipher=function(e,t){return Yi({key:e,output:null,decrypt:!0,mode:t})};Ve.des.Algorithm=function(e,t){var a=this;a.name=e,a.mode=new t({blockSize:8,cipher:{encrypt:function(r,n){return Lf(a._keys,r,n,!1)},decrypt:function(r,n){return Lf(a._keys,r,n,!0)}}}),a._init=!1};Ve.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=Ve.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=Qh(t),this._init=!0}};tr("DES-ECB",Ve.cipher.modes.ecb);tr("DES-CBC",Ve.cipher.modes.cbc);tr("DES-CFB",Ve.cipher.modes.cfb);tr("DES-OFB",Ve.cipher.modes.ofb);tr("DES-CTR",Ve.cipher.modes.ctr);tr("3DES-ECB",Ve.cipher.modes.ecb);tr("3DES-CBC",Ve.cipher.modes.cbc);tr("3DES-CFB",Ve.cipher.modes.cfb);tr("3DES-OFB",Ve.cipher.modes.ofb);tr("3DES-CTR",Ve.cipher.modes.ctr);function tr(e,t){var a=function(){return new Ve.des.Algorithm(e,t)};Ve.cipher.registerAlgorithm(e,a)}var Vh=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],qh=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Mh=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Kh=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Hh=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],zh=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Wh=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Gh=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Qh(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],a=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],i=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],d=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],C=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],E=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],v=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],_=e.length()>8?3:1,S=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],A=0,w,P=0;P<_;P++){var k=e.getInt32(),N=e.getInt32();w=(k>>>4^N)&252645135,N^=w,k^=w<<4,w=(N>>>-16^k)&65535,k^=w,N^=w<<-16,w=(k>>>2^N)&858993459,N^=w,k^=w<<2,w=(N>>>-16^k)&65535,k^=w,N^=w<<-16,w=(k>>>1^N)&1431655765,N^=w,k^=w<<1,w=(N>>>8^k)&16711935,k^=w,N^=w<<8,w=(k>>>1^N)&1431655765,N^=w,k^=w<<1,w=k<<8|N>>>20&240,k=N<<24|N<<8&16711680|N>>>8&65280|N>>>24&240,N=w;for(var G=0;G<b.length;++G){b[G]?(k=k<<2|k>>>26,N=N<<2|N>>>26):(k=k<<1|k>>>27,N=N<<1|N>>>27),k&=-15,N&=-15;var q=t[k>>>28]|a[k>>>24&15]|r[k>>>20&15]|n[k>>>16&15]|i[k>>>12&15]|s[k>>>8&15]|u[k>>>4&15],Y=f[N>>>28]|c[N>>>24&15]|d[N>>>20&15]|h[N>>>16&15]|C[N>>>12&15]|E[N>>>8&15]|v[N>>>4&15];w=(Y>>>16^q)&65535,S[A++]=q^w,S[A++]=Y^w<<16}}return S}function Lf(e,t,a,r){var n=e.length===32?3:9,i;n===3?i=r?[30,-2,-2]:[0,32,2]:i=r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,u=t[0],f=t[1];s=(u>>>4^f)&252645135,f^=s,u^=s<<4,s=(u>>>16^f)&65535,f^=s,u^=s<<16,s=(f>>>2^u)&858993459,u^=s,f^=s<<2,s=(f>>>8^u)&16711935,u^=s,f^=s<<8,s=(u>>>1^f)&1431655765,f^=s,u^=s<<1,u=u<<1|u>>>31,f=f<<1|f>>>31;for(var c=0;c<n;c+=3){for(var d=i[c+1],h=i[c+2],C=i[c];C!=d;C+=h){var E=f^e[C],v=(f>>>4|f<<28)^e[C+1];s=u,u=f,f=s^(qh[E>>>24&63]|Kh[E>>>16&63]|zh[E>>>8&63]|Gh[E&63]|Vh[v>>>24&63]|Mh[v>>>16&63]|Hh[v>>>8&63]|Wh[v&63])}s=u,u=f,f=s}u=u>>>1|u<<31,f=f>>>1|f<<31,s=(u>>>1^f)&1431655765,f^=s,u^=s<<1,s=(f>>>8^u)&16711935,u^=s,f^=s<<8,s=(f>>>2^u)&858993459,u^=s,f^=s<<2,s=(u>>>16^f)&65535,f^=s,u^=s<<16,s=(u>>>4^f)&252645135,f^=s,u^=s<<4,a[0]=u,a[1]=f}function Yi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),a="DES-"+t,r;e.decrypt?r=Ve.cipher.createDecipher(a,e.key):r=Ve.cipher.createCipher(a,e.key);var n=r.start;return r.start=function(i,s){var u=null;s instanceof Ve.util.ByteBuffer&&(u=s,s={}),s=s||{},s.output=u,s.iv=i,n.call(r,s)},r}});var Xi=ae((Kv,Pf)=>{var pt=ue();Fa();Jt();me();var jh=pt.pkcs5=pt.pkcs5||{},Cr;pt.util.isNodejs&&!pt.options.usePureJavaScript&&(Cr=require("crypto"));Pf.exports=pt.pbkdf2=jh.pbkdf2=function(e,t,a,r,n,i){if(typeof n=="function"&&(i=n,n=null),pt.util.isNodejs&&!pt.options.usePureJavaScript&&Cr.pbkdf2&&(n===null||typeof n!="object")&&(Cr.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),i?Cr.pbkdf2Sync.length===4?Cr.pbkdf2(e,t,a,r,function(w,P){if(w)return i(w);i(null,P.toString("binary"))}):Cr.pbkdf2(e,t,a,r,n,function(w,P){if(w)return i(w);i(null,P.toString("binary"))}):Cr.pbkdf2Sync.length===4?Cr.pbkdf2Sync(e,t,a,r).toString("binary"):Cr.pbkdf2Sync(e,t,a,r,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in pt.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=pt.md[n].create()}var s=n.digestLength;if(r>4294967295*s){var u=new Error("Derived key is too long.");if(i)return i(u);throw u}var f=Math.ceil(r/s),c=r-(f-1)*s,d=pt.hmac.create();d.start(n,e);var h="",C,E,v;if(!i){for(var _=1;_<=f;++_){d.start(null,null),d.update(t),d.update(pt.util.int32ToBytes(_)),C=v=d.digest().getBytes();for(var S=2;S<=a;++S)d.start(null,null),d.update(v),E=d.digest().getBytes(),C=pt.util.xorBytes(C,E,s),v=E;h+=_<f?C:C.substr(0,c)}return h}var _=1,S;function b(){if(_>f)return i(null,h);d.start(null,null),d.update(t),d.update(pt.util.int32ToBytes(_)),C=v=d.digest().getBytes(),S=2,A()}function A(){if(S<=a)return d.start(null,null),d.update(v),E=d.digest().getBytes(),C=pt.util.xorBytes(C,E,s),v=E,++S,pt.util.setImmediate(A);h+=_<f?C:C.substr(0,c),++_,b()}b()}});var go=ae((Hv,Vf)=>{var rr=ue();Jt();me();var Df=Vf.exports=rr.sha256=rr.sha256||{};rr.md.sha256=rr.md.algorithms.sha256=Df;Df.create=function(){Uf||$h();var e=null,t=rr.util.createBuffer(),a=new Array(64),r={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var n=r.messageLengthSize/4,i=0;i<n;++i)r.fullMessageLength.push(0);return t=rr.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},r},r.start(),r.update=function(n,i){i==="utf8"&&(n=rr.util.encodeUtf8(n));var s=n.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var u=r.fullMessageLength.length-1;u>=0;--u)r.fullMessageLength[u]+=s[1],s[1]=s[0]+(r.fullMessageLength[u]/4294967296>>>0),r.fullMessageLength[u]=r.fullMessageLength[u]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(n),Ff(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var n=rr.util.createBuffer();n.putBytes(t.bytes());var i=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=i&r.blockLength-1;n.putBytes(yo.substr(0,r.blockLength-s));for(var u,f,c=r.fullMessageLength[0]*8,d=0;d<r.fullMessageLength.length-1;++d)u=r.fullMessageLength[d+1]*8,f=u/4294967296>>>0,c+=f,n.putInt32(c>>>0),c=u>>>0;n.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Ff(h,a,n);var C=rr.util.createBuffer();return C.putInt32(h.h0),C.putInt32(h.h1),C.putInt32(h.h2),C.putInt32(h.h3),C.putInt32(h.h4),C.putInt32(h.h5),C.putInt32(h.h6),C.putInt32(h.h7),C},r};var yo=null,Uf=!1,Of=null;function $h(){yo=String.fromCharCode(128),yo+=rr.util.fillString(String.fromCharCode(0),64),Of=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Uf=!0}function Ff(e,t,a){for(var r,n,i,s,u,f,c,d,h,C,E,v,_,S,b,A=a.length();A>=64;){for(c=0;c<16;++c)t[c]=a.getInt32();for(;c<64;++c)r=t[c-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,n=t[c-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,t[c]=r+t[c-7]+n+t[c-16]|0;for(d=e.h0,h=e.h1,C=e.h2,E=e.h3,v=e.h4,_=e.h5,S=e.h6,b=e.h7,c=0;c<64;++c)s=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7),u=S^v&(_^S),i=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),f=d&h|C&(d^h),r=b+s+u+Of[c]+t[c],n=i+f,b=S,S=_,_=v,v=E+r>>>0,E=C,C=h,h=d,d=r+n>>>0;e.h0=e.h0+d|0,e.h1=e.h1+h|0,e.h2=e.h2+C|0,e.h3=e.h3+E|0,e.h4=e.h4+v|0,e.h5=e.h5+_|0,e.h6=e.h6+S|0,e.h7=e.h7+b|0,A-=64}}});var mo=ae((zv,qf)=>{var ar=ue();me();var Zi=null;ar.util.isNodejs&&!ar.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Zi=require("crypto"));var Yh=qf.exports=ar.prng=ar.prng||{};Yh.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},a=e.md,r=new Array(32),n=0;n<32;++n)r[n]=a.create();t.pools=r,t.pool=0,t.generate=function(c,d){if(!d)return t.generateSync(c);var h=t.plugin.cipher,C=t.plugin.increment,E=t.plugin.formatKey,v=t.plugin.formatSeed,_=ar.util.createBuffer();t.key=null,S();function S(b){if(b)return d(b);if(_.length()>=c)return d(null,_.getBytes(c));if(t.generated>1048575&&(t.key=null),t.key===null)return ar.util.nextTick(function(){i(S)});var A=h(t.key,t.seed);t.generated+=A.length,_.putBytes(A),t.key=E(h(t.key,C(t.seed))),t.seed=v(h(t.key,t.seed)),ar.util.setImmediate(S)}},t.generateSync=function(c){var d=t.plugin.cipher,h=t.plugin.increment,C=t.plugin.formatKey,E=t.plugin.formatSeed;t.key=null;for(var v=ar.util.createBuffer();v.length()<c;){t.generated>1048575&&(t.key=null),t.key===null&&s();var _=d(t.key,t.seed);t.generated+=_.length,v.putBytes(_),t.key=C(d(t.key,h(t.seed))),t.seed=E(d(t.key,t.seed))}return v.getBytes(c)};function i(c){if(t.pools[0].messageLength>=32)return u(),c();var d=32-t.pools[0].messageLength<<5;t.seedFile(d,function(h,C){if(h)return c(h);t.collect(C),u(),c()})}function s(){if(t.pools[0].messageLength>=32)return u();var c=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(c)),u()}function u(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var c=t.plugin.md.create();c.update(t.keyBytes);for(var d=1,h=0;h<32;++h)t.reseeds%d===0&&(c.update(t.pools[h].digest().getBytes()),t.pools[h].start()),d=d<<1;t.keyBytes=c.digest().getBytes(),c.start(),c.update(t.keyBytes);var C=c.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(C),t.generated=0}function f(c){var d=null,h=ar.util.globalScope,C=h.crypto||h.msCrypto;C&&C.getRandomValues&&(d=function(k){return C.getRandomValues(k)});var E=ar.util.createBuffer();if(d)for(;E.length()<c;){var v=Math.max(1,Math.min(c-E.length(),65536)/4),_=new Uint32Array(Math.floor(v));try{d(_);for(var S=0;S<_.length;++S)E.putInt32(_[S])}catch(k){if(!(typeof QuotaExceededError!="undefined"&&k instanceof QuotaExceededError))throw k}}if(E.length()<c)for(var b,A,w,P=Math.floor(Math.random()*65536);E.length()<c;){A=16807*(P&65535),b=16807*(P>>16),A+=(b&32767)<<16,A+=b>>15,A=(A&2147483647)+(A>>31),P=A&4294967295;for(var S=0;S<3;++S)w=P>>>(S<<3),w^=Math.floor(Math.random()*256),E.putByte(w&255)}return E.getBytes(c)}return Zi?(t.seedFile=function(c,d){Zi.randomBytes(c,function(h,C){if(h)return d(h);d(null,C.toString())})},t.seedFileSync=function(c){return Zi.randomBytes(c).toString()}):(t.seedFile=function(c,d){try{d(null,f(c))}catch(h){d(h)}},t.seedFileSync=f),t.collect=function(c){for(var d=c.length,h=0;h<d;++h)t.pools[t.pool].update(c.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(c,d){for(var h="",C=0;C<d;C+=8)h+=String.fromCharCode(c>>C&255);t.collect(h)},t.registerWorker=function(c){if(c===self)t.seedFile=function(h,C){function E(v){var _=v.data;_.forge&&_.forge.prng&&(self.removeEventListener("message",E),C(_.forge.prng.err,_.forge.prng.bytes))}self.addEventListener("message",E),self.postMessage({forge:{prng:{needed:h}}})};else{var d=function(h){var C=h.data;C.forge&&C.forge.prng&&t.seedFile(C.forge.prng.needed,function(E,v){c.postMessage({forge:{prng:{err:E,bytes:v}}})})};c.addEventListener("message",d)}},t}});var kt=ae((Wv,vo)=>{var nt=ue();Fr();go();mo();me();(function(){if(nt.random&&nt.random.getBytes){vo.exports=nt.random;return}(function(e){var t={},a=new Array(4),r=nt.util.createBuffer();t.formatKey=function(h){var C=nt.util.createBuffer(h);return h=new Array(4),h[0]=C.getInt32(),h[1]=C.getInt32(),h[2]=C.getInt32(),h[3]=C.getInt32(),nt.aes._expandKey(h,!1)},t.formatSeed=function(h){var C=nt.util.createBuffer(h);return h=new Array(4),h[0]=C.getInt32(),h[1]=C.getInt32(),h[2]=C.getInt32(),h[3]=C.getInt32(),h},t.cipher=function(h,C){return nt.aes._updateBlock(h,C,a,!1),r.putInt32(a[0]),r.putInt32(a[1]),r.putInt32(a[2]),r.putInt32(a[3]),r.getBytes()},t.increment=function(h){return++h[3],h},t.md=nt.md.sha256;function n(){var h=nt.prng.create(t);return h.getBytes=function(C,E){return h.generate(C,E)},h.getBytesSync=function(C){return h.generate(C)},h}var i=n(),s=null,u=nt.util.globalScope,f=u.crypto||u.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),nt.options.usePureJavaScript||!nt.util.isNodejs&&!s){if(typeof window=="undefined"||window.document===void 0,i.collectInt(+new Date,32),typeof navigator!="undefined"){var c="";for(var d in navigator)try{typeof navigator[d]=="string"&&(c+=navigator[d])}catch{}i.collect(c),c=null}e&&(e().mousemove(function(h){i.collectInt(h.clientX,16),i.collectInt(h.clientY,16)}),e().keypress(function(h){i.collectInt(h.charCode,8)}))}if(!nt.random)nt.random=i;else for(var d in i)nt.random[d]=i[d];nt.random.createInstance=n,vo.exports=nt.random})(typeof jQuery!="undefined"?jQuery:null)})()});var So=ae((Gv,Hf)=>{var Et=ue();me();var Co=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Mf=[1,2,3,5],Xh=function(e,t){return e<<t&65535|(e&65535)>>16-t},Zh=function(e,t){return(e&65535)>>t|e<<16-t&65535};Hf.exports=Et.rc2=Et.rc2||{};Et.rc2.expandKey=function(e,t){typeof e=="string"&&(e=Et.util.createBuffer(e)),t=t||128;var a=e,r=e.length(),n=t,i=Math.ceil(n/8),s=255>>(n&7),u;for(u=r;u<128;u++)a.putByte(Co[a.at(u-1)+a.at(u-r)&255]);for(a.setAt(128-i,Co[a.at(128-i)&s]),u=127-i;u>=0;u--)a.setAt(u,Co[a.at(u+1)^a.at(u+i)]);return a};var Kf=function(e,t,a){var r=!1,n=null,i=null,s=null,u,f,c,d,h=[];for(e=Et.rc2.expandKey(e,t),c=0;c<64;c++)h.push(e.getInt16Le());a?(u=function(v){for(c=0;c<4;c++)v[c]+=h[d]+(v[(c+3)%4]&v[(c+2)%4])+(~v[(c+3)%4]&v[(c+1)%4]),v[c]=Xh(v[c],Mf[c]),d++},f=function(v){for(c=0;c<4;c++)v[c]+=h[v[(c+3)%4]&63]}):(u=function(v){for(c=3;c>=0;c--)v[c]=Zh(v[c],Mf[c]),v[c]-=h[d]+(v[(c+3)%4]&v[(c+2)%4])+(~v[(c+3)%4]&v[(c+1)%4]),d--},f=function(v){for(c=3;c>=0;c--)v[c]-=h[v[(c+3)%4]&63]});var C=function(v){var _=[];for(c=0;c<4;c++){var S=n.getInt16Le();s!==null&&(a?S^=s.getInt16Le():s.putInt16Le(S)),_.push(S&65535)}d=a?0:63;for(var b=0;b<v.length;b++)for(var A=0;A<v[b][0];A++)v[b][1](_);for(c=0;c<4;c++)s!==null&&(a?s.putInt16Le(_[c]):_[c]^=s.getInt16Le()),i.putInt16Le(_[c])},E=null;return E={start:function(v,_){v&&typeof v=="string"&&(v=Et.util.createBuffer(v)),r=!1,n=Et.util.createBuffer(),i=_||new Et.util.createBuffer,s=v,E.output=i},update:function(v){for(r||n.putBuffer(v);n.length()>=8;)C([[5,u],[1,f],[6,u],[1,f],[5,u]])},finish:function(v){var _=!0;if(a)if(v)_=v(8,n,!a);else{var S=n.length()===8?8:8-n.length();n.fillWithByte(S,S)}if(_&&(r=!0,E.update()),!a&&(_=n.length()===0,_))if(v)_=v(8,i,!a);else{var b=i.length(),A=i.at(b-1);A>b?_=!1:i.truncate(A)}return _}},E};Et.rc2.startEncrypting=function(e,t,a){var r=Et.rc2.createEncryptionCipher(e,128);return r.start(t,a),r};Et.rc2.createEncryptionCipher=function(e,t){return Kf(e,t,!0)};Et.rc2.startDecrypting=function(e,t,a){var r=Et.rc2.createDecryptionCipher(e,128);return r.start(t,a),r};Et.rc2.createDecryptionCipher=function(e,t){return Kf(e,t,!1)}});var Fn=ae((Qv,Xf)=>{var Eo=ue();Xf.exports=Eo.jsbn=Eo.jsbn||{};var Sr,Jh=244837814094590,zf=(Jh&16777215)==15715070;function F(e,t,a){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,a):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Eo.jsbn.BigInteger=F;function ve(){return new F(null)}function ep(e,t,a,r,n,i){for(;--i>=0;){var s=t*this.data[e++]+a.data[r]+n;n=Math.floor(s/67108864),a.data[r++]=s&67108863}return n}function tp(e,t,a,r,n,i){for(var s=t&32767,u=t>>15;--i>=0;){var f=this.data[e]&32767,c=this.data[e++]>>15,d=u*f+c*s;f=s*f+((d&32767)<<15)+a.data[r]+(n&1073741823),n=(f>>>30)+(d>>>15)+u*c+(n>>>30),a.data[r++]=f&1073741823}return n}function Wf(e,t,a,r,n,i){for(var s=t&16383,u=t>>14;--i>=0;){var f=this.data[e]&16383,c=this.data[e++]>>14,d=u*f+c*s;f=s*f+((d&16383)<<14)+a.data[r]+n,n=(f>>28)+(d>>14)+u*c,a.data[r++]=f&268435455}return n}typeof navigator=="undefined"?(F.prototype.am=Wf,Sr=28):zf&&navigator.appName=="Microsoft Internet Explorer"?(F.prototype.am=tp,Sr=30):zf&&navigator.appName!="Netscape"?(F.prototype.am=ep,Sr=26):(F.prototype.am=Wf,Sr=28);F.prototype.DB=Sr;F.prototype.DM=(1<<Sr)-1;F.prototype.DV=1<<Sr;var bo=52;F.prototype.FV=Math.pow(2,bo);F.prototype.F1=bo-Sr;F.prototype.F2=2*Sr-bo;var rp="0123456789abcdefghijklmnopqrstuvwxyz",Ji=new Array,qa,Pt;qa="0".charCodeAt(0);for(Pt=0;Pt<=9;++Pt)Ji[qa++]=Pt;qa="a".charCodeAt(0);for(Pt=10;Pt<36;++Pt)Ji[qa++]=Pt;qa="A".charCodeAt(0);for(Pt=10;Pt<36;++Pt)Ji[qa++]=Pt;function Gf(e){return rp.charAt(e)}function Qf(e,t){var a=Ji[e.charCodeAt(t)];return a??-1}function ap(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function np(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function qr(e){var t=ve();return t.fromInt(e),t}function ip(e,t){var a;if(t==16)a=4;else if(t==8)a=3;else if(t==256)a=8;else if(t==2)a=1;else if(t==32)a=5;else if(t==4)a=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var r=e.length,n=!1,i=0;--r>=0;){var s=a==8?e[r]&255:Qf(e,r);if(s<0){e.charAt(r)=="-"&&(n=!0);continue}n=!1,i==0?this.data[this.t++]=s:i+a>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-i)-1)<<i,this.data[this.t++]=s>>this.DB-i):this.data[this.t-1]|=s<<i,i+=a,i>=this.DB&&(i-=this.DB)}a==8&&(e[0]&128)!=0&&(this.s=-1,i>0&&(this.data[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),n&&F.ZERO.subTo(this,this)}function sp(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function op(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var a=(1<<t)-1,r,n=!1,i="",s=this.t,u=this.DB-s*this.DB%t;if(s-- >0)for(u<this.DB&&(r=this.data[s]>>u)>0&&(n=!0,i=Gf(r));s>=0;)u<t?(r=(this.data[s]&(1<<u)-1)<<t-u,r|=this.data[--s]>>(u+=this.DB-t)):(r=this.data[s]>>(u-=t)&a,u<=0&&(u+=this.DB,--s)),r>0&&(n=!0),n&&(i+=Gf(r));return n?i:"0"}function up(){var e=ve();return F.ZERO.subTo(this,e),e}function lp(){return this.s<0?this.negate():this}function fp(e){var t=this.s-e.s;if(t!=0)return t;var a=this.t;if(t=a-e.t,t!=0)return this.s<0?-t:t;for(;--a>=0;)if((t=this.data[a]-e.data[a])!=0)return t;return 0}function es(e){var t=1,a;return(a=e>>>16)!=0&&(e=a,t+=16),(a=e>>8)!=0&&(e=a,t+=8),(a=e>>4)!=0&&(e=a,t+=4),(a=e>>2)!=0&&(e=a,t+=2),(a=e>>1)!=0&&(e=a,t+=1),t}function cp(){return this.t<=0?0:this.DB*(this.t-1)+es(this.data[this.t-1]^this.s&this.DM)}function dp(e,t){var a;for(a=this.t-1;a>=0;--a)t.data[a+e]=this.data[a];for(a=e-1;a>=0;--a)t.data[a]=0;t.t=this.t+e,t.s=this.s}function hp(e,t){for(var a=e;a<this.t;++a)t.data[a-e]=this.data[a];t.t=Math.max(this.t-e,0),t.s=this.s}function pp(e,t){var a=e%this.DB,r=this.DB-a,n=(1<<r)-1,i=Math.floor(e/this.DB),s=this.s<<a&this.DM,u;for(u=this.t-1;u>=0;--u)t.data[u+i+1]=this.data[u]>>r|s,s=(this.data[u]&n)<<a;for(u=i-1;u>=0;--u)t.data[u]=0;t.data[i]=s,t.t=this.t+i+1,t.s=this.s,t.clamp()}function yp(e,t){t.s=this.s;var a=Math.floor(e/this.DB);if(a>=this.t){t.t=0;return}var r=e%this.DB,n=this.DB-r,i=(1<<r)-1;t.data[0]=this.data[a]>>r;for(var s=a+1;s<this.t;++s)t.data[s-a-1]|=(this.data[s]&i)<<n,t.data[s-a]=this.data[s]>>r;r>0&&(t.data[this.t-a-1]|=(this.s&i)<<n),t.t=this.t-a,t.clamp()}function gp(e,t){for(var a=0,r=0,n=Math.min(e.t,this.t);a<n;)r+=this.data[a]-e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;a<this.t;)r+=this.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<e.t;)r-=e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t.data[a++]=this.DV+r:r>0&&(t.data[a++]=r),t.t=a,t.clamp()}function mp(e,t){var a=this.abs(),r=e.abs(),n=a.t;for(t.t=n+r.t;--n>=0;)t.data[n]=0;for(n=0;n<r.t;++n)t.data[n+a.t]=a.am(0,r.data[n],t,n,0,a.t);t.s=0,t.clamp(),this.s!=e.s&&F.ZERO.subTo(t,t)}function vp(e){for(var t=this.abs(),a=e.t=2*t.t;--a>=0;)e.data[a]=0;for(a=0;a<t.t-1;++a){var r=t.am(a,t.data[a],e,2*a,0,1);(e.data[a+t.t]+=t.am(a+1,2*t.data[a],e,2*a+1,r,t.t-a-1))>=t.DV&&(e.data[a+t.t]-=t.DV,e.data[a+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(a,t.data[a],e,2*a,0,1)),e.s=0,e.clamp()}function Cp(e,t,a){var r=e.abs();if(!(r.t<=0)){var n=this.abs();if(n.t<r.t){t!=null&&t.fromInt(0),a!=null&&this.copyTo(a);return}a==null&&(a=ve());var i=ve(),s=this.s,u=e.s,f=this.DB-es(r.data[r.t-1]);f>0?(r.lShiftTo(f,i),n.lShiftTo(f,a)):(r.copyTo(i),n.copyTo(a));var c=i.t,d=i.data[c-1];if(d!=0){var h=d*(1<<this.F1)+(c>1?i.data[c-2]>>this.F2:0),C=this.FV/h,E=(1<<this.F1)/h,v=1<<this.F2,_=a.t,S=_-c,b=t??ve();for(i.dlShiftTo(S,b),a.compareTo(b)>=0&&(a.data[a.t++]=1,a.subTo(b,a)),F.ONE.dlShiftTo(c,b),b.subTo(i,i);i.t<c;)i.data[i.t++]=0;for(;--S>=0;){var A=a.data[--_]==d?this.DM:Math.floor(a.data[_]*C+(a.data[_-1]+v)*E);if((a.data[_]+=i.am(0,A,a,S,0,c))<A)for(i.dlShiftTo(S,b),a.subTo(b,a);a.data[_]<--A;)a.subTo(b,a)}t!=null&&(a.drShiftTo(c,t),s!=u&&F.ZERO.subTo(t,t)),a.t=c,a.clamp(),f>0&&a.rShiftTo(f,a),s<0&&F.ZERO.subTo(a,a)}}}function Sp(e){var t=ve();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(F.ZERO)>0&&e.subTo(t,t),t}function oa(e){this.m=e}function Ep(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function bp(e){return e}function xp(e){e.divRemTo(this.m,null,e)}function Tp(e,t,a){e.multiplyTo(t,a),this.reduce(a)}function Ap(e,t){e.squareTo(t),this.reduce(t)}oa.prototype.convert=Ep;oa.prototype.revert=bp;oa.prototype.reduce=xp;oa.prototype.mulTo=Tp;oa.prototype.sqrTo=Ap;function _p(){if(this.t<1)return 0;var e=this.data[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function ua(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Ip(e){var t=ve();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(F.ZERO)>0&&this.m.subTo(t,t),t}function Bp(e){var t=ve();return e.copyTo(t),this.reduce(t),t}function wp(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var a=e.data[t]&32767,r=a*this.mpl+((a*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(a=t+this.m.t,e.data[a]+=this.m.am(0,r,e,t,0,this.m.t);e.data[a]>=e.DV;)e.data[a]-=e.DV,e.data[++a]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Rp(e,t){e.squareTo(t),this.reduce(t)}function Np(e,t,a){e.multiplyTo(t,a),this.reduce(a)}ua.prototype.convert=Ip;ua.prototype.revert=Bp;ua.prototype.reduce=wp;ua.prototype.mulTo=Np;ua.prototype.sqrTo=Rp;function Lp(){return(this.t>0?this.data[0]&1:this.s)==0}function kp(e,t){if(e>4294967295||e<1)return F.ONE;var a=ve(),r=ve(),n=t.convert(this),i=es(e)-1;for(n.copyTo(a);--i>=0;)if(t.sqrTo(a,r),(e&1<<i)>0)t.mulTo(r,n,a);else{var s=a;a=r,r=s}return t.revert(a)}function Pp(e,t){var a;return e<256||t.isEven()?a=new oa(t):a=new ua(t),this.exp(e,a)}F.prototype.copyTo=ap;F.prototype.fromInt=np;F.prototype.fromString=ip;F.prototype.clamp=sp;F.prototype.dlShiftTo=dp;F.prototype.drShiftTo=hp;F.prototype.lShiftTo=pp;F.prototype.rShiftTo=yp;F.prototype.subTo=gp;F.prototype.multiplyTo=mp;F.prototype.squareTo=vp;F.prototype.divRemTo=Cp;F.prototype.invDigit=_p;F.prototype.isEven=Lp;F.prototype.exp=kp;F.prototype.toString=op;F.prototype.negate=up;F.prototype.abs=lp;F.prototype.compareTo=fp;F.prototype.bitLength=cp;F.prototype.mod=Sp;F.prototype.modPowInt=Pp;F.ZERO=qr(0);F.ONE=qr(1);function Dp(){var e=ve();return this.copyTo(e),e}function Up(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Op(){return this.t==0?this.s:this.data[0]<<24>>24}function Fp(){return this.t==0?this.s:this.data[0]<<16>>16}function Vp(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function qp(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Mp(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),a=Math.pow(e,t),r=qr(a),n=ve(),i=ve(),s="";for(this.divRemTo(r,n,i);n.signum()>0;)s=(a+i.intValue()).toString(e).substr(1)+s,n.divRemTo(r,n,i);return i.intValue().toString(e)+s}function Kp(e,t){this.fromInt(0),t==null&&(t=10);for(var a=this.chunkSize(t),r=Math.pow(t,a),n=!1,i=0,s=0,u=0;u<e.length;++u){var f=Qf(e,u);if(f<0){e.charAt(u)=="-"&&this.signum()==0&&(n=!0);continue}s=t*s+f,++i>=a&&(this.dMultiply(r),this.dAddOffset(s,0),i=0,s=0)}i>0&&(this.dMultiply(Math.pow(t,i)),this.dAddOffset(s,0)),n&&F.ZERO.subTo(this,this)}function Hp(e,t,a){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,a),this.testBit(e-1)||this.bitwiseTo(F.ONE.shiftLeft(e-1),xo,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(F.ONE.shiftLeft(e-1),this);else{var r=new Array,n=e&7;r.length=(e>>3)+1,t.nextBytes(r),n>0?r[0]&=(1<<n)-1:r[0]=0,this.fromString(r,256)}}function zp(){var e=this.t,t=new Array;t[0]=this.s;var a=this.DB-e*this.DB%8,r,n=0;if(e-- >0)for(a<this.DB&&(r=this.data[e]>>a)!=(this.s&this.DM)>>a&&(t[n++]=r|this.s<<this.DB-a);e>=0;)a<8?(r=(this.data[e]&(1<<a)-1)<<8-a,r|=this.data[--e]>>(a+=this.DB-8)):(r=this.data[e]>>(a-=8)&255,a<=0&&(a+=this.DB,--e)),(r&128)!=0&&(r|=-256),n==0&&(this.s&128)!=(r&128)&&++n,(n>0||r!=this.s)&&(t[n++]=r);return t}function Wp(e){return this.compareTo(e)==0}function Gp(e){return this.compareTo(e)<0?this:e}function Qp(e){return this.compareTo(e)>0?this:e}function jp(e,t,a){var r,n,i=Math.min(e.t,this.t);for(r=0;r<i;++r)a.data[r]=t(this.data[r],e.data[r]);if(e.t<this.t){for(n=e.s&this.DM,r=i;r<this.t;++r)a.data[r]=t(this.data[r],n);a.t=this.t}else{for(n=this.s&this.DM,r=i;r<e.t;++r)a.data[r]=t(n,e.data[r]);a.t=e.t}a.s=t(this.s,e.s),a.clamp()}function $p(e,t){return e&t}function Yp(e){var t=ve();return this.bitwiseTo(e,$p,t),t}function xo(e,t){return e|t}function Xp(e){var t=ve();return this.bitwiseTo(e,xo,t),t}function jf(e,t){return e^t}function Zp(e){var t=ve();return this.bitwiseTo(e,jf,t),t}function $f(e,t){return e&~t}function Jp(e){var t=ve();return this.bitwiseTo(e,$f,t),t}function ey(){for(var e=ve(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function ty(e){var t=ve();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function ry(e){var t=ve();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function ay(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function ny(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+ay(this.data[e]);return this.s<0?this.t*this.DB:-1}function iy(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function sy(){for(var e=0,t=this.s&this.DM,a=0;a<this.t;++a)e+=iy(this.data[a]^t);return e}function oy(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function uy(e,t){var a=F.ONE.shiftLeft(e);return this.bitwiseTo(a,t,a),a}function ly(e){return this.changeBit(e,xo)}function fy(e){return this.changeBit(e,$f)}function cy(e){return this.changeBit(e,jf)}function dy(e,t){for(var a=0,r=0,n=Math.min(e.t,this.t);a<n;)r+=this.data[a]+e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;a<this.t;)r+=this.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<e.t;)r+=e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t.data[a++]=r:r<-1&&(t.data[a++]=this.DV+r),t.t=a,t.clamp()}function hy(e){var t=ve();return this.addTo(e,t),t}function py(e){var t=ve();return this.subTo(e,t),t}function yy(e){var t=ve();return this.multiplyTo(e,t),t}function gy(e){var t=ve();return this.divRemTo(e,t,null),t}function my(e){var t=ve();return this.divRemTo(e,null,t),t}function vy(e){var t=ve(),a=ve();return this.divRemTo(e,t,a),new Array(t,a)}function Cy(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Sy(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function On(){}function Yf(e){return e}function Ey(e,t,a){e.multiplyTo(t,a)}function by(e,t){e.squareTo(t)}On.prototype.convert=Yf;On.prototype.revert=Yf;On.prototype.mulTo=Ey;On.prototype.sqrTo=by;function xy(e){return this.exp(e,new On)}function Ty(e,t,a){var r=Math.min(this.t+e.t,t);for(a.s=0,a.t=r;r>0;)a.data[--r]=0;var n;for(n=a.t-this.t;r<n;++r)a.data[r+this.t]=this.am(0,e.data[r],a,r,0,this.t);for(n=Math.min(e.t,t);r<n;++r)this.am(0,e.data[r],a,r,0,t-r);a.clamp()}function Ay(e,t,a){--t;var r=a.t=this.t+e.t-t;for(a.s=0;--r>=0;)a.data[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)a.data[this.t+r-t]=this.am(t-r,e.data[r],a,0,0,this.t+r-t);a.clamp(),a.drShiftTo(1,a)}function Ma(e){this.r2=ve(),this.q3=ve(),F.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function _y(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ve();return e.copyTo(t),this.reduce(t),t}function Iy(e){return e}function By(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function wy(e,t){e.squareTo(t),this.reduce(t)}function Ry(e,t,a){e.multiplyTo(t,a),this.reduce(a)}Ma.prototype.convert=_y;Ma.prototype.revert=Iy;Ma.prototype.reduce=By;Ma.prototype.mulTo=Ry;Ma.prototype.sqrTo=wy;function Ny(e,t){var a=e.bitLength(),r,n=qr(1),i;if(a<=0)return n;a<18?r=1:a<48?r=3:a<144?r=4:a<768?r=5:r=6,a<8?i=new oa(t):t.isEven()?i=new Ma(t):i=new ua(t);var s=new Array,u=3,f=r-1,c=(1<<r)-1;if(s[1]=i.convert(this),r>1){var d=ve();for(i.sqrTo(s[1],d);u<=c;)s[u]=ve(),i.mulTo(d,s[u-2],s[u]),u+=2}var h=e.t-1,C,E=!0,v=ve(),_;for(a=es(e.data[h])-1;h>=0;){for(a>=f?C=e.data[h]>>a-f&c:(C=(e.data[h]&(1<<a+1)-1)<<f-a,h>0&&(C|=e.data[h-1]>>this.DB+a-f)),u=r;(C&1)==0;)C>>=1,--u;if((a-=u)<0&&(a+=this.DB,--h),E)s[C].copyTo(n),E=!1;else{for(;u>1;)i.sqrTo(n,v),i.sqrTo(v,n),u-=2;u>0?i.sqrTo(n,v):(_=n,n=v,v=_),i.mulTo(v,s[C],n)}for(;h>=0&&(e.data[h]&1<<a)==0;)i.sqrTo(n,v),_=n,n=v,v=_,--a<0&&(a=this.DB-1,--h)}return i.revert(n)}function Ly(e){var t=this.s<0?this.negate():this.clone(),a=e.s<0?e.negate():e.clone();if(t.compareTo(a)<0){var r=t;t=a,a=r}var n=t.getLowestSetBit(),i=a.getLowestSetBit();if(i<0)return t;for(n<i&&(i=n),i>0&&(t.rShiftTo(i,t),a.rShiftTo(i,a));t.signum()>0;)(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),(n=a.getLowestSetBit())>0&&a.rShiftTo(n,a),t.compareTo(a)>=0?(t.subTo(a,t),t.rShiftTo(1,t)):(a.subTo(t,a),a.rShiftTo(1,a));return i>0&&a.lShiftTo(i,a),a}function ky(e){if(e<=0)return 0;var t=this.DV%e,a=this.s<0?e-1:0;if(this.t>0)if(t==0)a=this.data[0]%e;else for(var r=this.t-1;r>=0;--r)a=(t*a+this.data[r])%e;return a}function Py(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return F.ZERO;for(var a=e.clone(),r=this.clone(),n=qr(1),i=qr(0),s=qr(0),u=qr(1);a.signum()!=0;){for(;a.isEven();)a.rShiftTo(1,a),t?((!n.isEven()||!i.isEven())&&(n.addTo(this,n),i.subTo(e,i)),n.rShiftTo(1,n)):i.isEven()||i.subTo(e,i),i.rShiftTo(1,i);for(;r.isEven();)r.rShiftTo(1,r),t?((!s.isEven()||!u.isEven())&&(s.addTo(this,s),u.subTo(e,u)),s.rShiftTo(1,s)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);a.compareTo(r)>=0?(a.subTo(r,a),t&&n.subTo(s,n),i.subTo(u,i)):(r.subTo(a,r),t&&s.subTo(n,s),u.subTo(i,u))}if(r.compareTo(F.ONE)!=0)return F.ZERO;if(u.compareTo(e)>=0)return u.subtract(e);if(u.signum()<0)u.addTo(e,u);else return u;return u.signum()<0?u.add(e):u}var jt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Dy=(1<<26)/jt[jt.length-1];function Uy(e){var t,a=this.abs();if(a.t==1&&a.data[0]<=jt[jt.length-1]){for(t=0;t<jt.length;++t)if(a.data[0]==jt[t])return!0;return!1}if(a.isEven())return!1;for(t=1;t<jt.length;){for(var r=jt[t],n=t+1;n<jt.length&&r<Dy;)r*=jt[n++];for(r=a.modInt(r);t<n;)if(r%jt[t++]==0)return!1}return a.millerRabin(e)}function Oy(e){var t=this.subtract(F.ONE),a=t.getLowestSetBit();if(a<=0)return!1;for(var r=t.shiftRight(a),n=Fy(),i,s=0;s<e;++s){do i=new F(this.bitLength(),n);while(i.compareTo(F.ONE)<=0||i.compareTo(t)>=0);var u=i.modPow(r,this);if(u.compareTo(F.ONE)!=0&&u.compareTo(t)!=0){for(var f=1;f++<a&&u.compareTo(t)!=0;)if(u=u.modPowInt(2,this),u.compareTo(F.ONE)==0)return!1;if(u.compareTo(t)!=0)return!1}}return!0}function Fy(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}F.prototype.chunkSize=Vp;F.prototype.toRadix=Mp;F.prototype.fromRadix=Kp;F.prototype.fromNumber=Hp;F.prototype.bitwiseTo=jp;F.prototype.changeBit=uy;F.prototype.addTo=dy;F.prototype.dMultiply=Cy;F.prototype.dAddOffset=Sy;F.prototype.multiplyLowerTo=Ty;F.prototype.multiplyUpperTo=Ay;F.prototype.modInt=ky;F.prototype.millerRabin=Oy;F.prototype.clone=Dp;F.prototype.intValue=Up;F.prototype.byteValue=Op;F.prototype.shortValue=Fp;F.prototype.signum=qp;F.prototype.toByteArray=zp;F.prototype.equals=Wp;F.prototype.min=Gp;F.prototype.max=Qp;F.prototype.and=Yp;F.prototype.or=Xp;F.prototype.xor=Zp;F.prototype.andNot=Jp;F.prototype.not=ey;F.prototype.shiftLeft=ty;F.prototype.shiftRight=ry;F.prototype.getLowestSetBit=ny;F.prototype.bitCount=sy;F.prototype.testBit=oy;F.prototype.setBit=ly;F.prototype.clearBit=fy;F.prototype.flipBit=cy;F.prototype.add=hy;F.prototype.subtract=py;F.prototype.multiply=yy;F.prototype.divide=gy;F.prototype.remainder=my;F.prototype.divideAndRemainder=vy;F.prototype.modPow=Ny;F.prototype.modInverse=Py;F.prototype.pow=xy;F.prototype.gcd=Ly;F.prototype.isProbablePrime=Uy});var Ka=ae((jv,tc)=>{var nr=ue();Jt();me();var Zf=tc.exports=nr.sha1=nr.sha1||{};nr.md.sha1=nr.md.algorithms.sha1=Zf;Zf.create=function(){Jf||Vy();var e=null,t=nr.util.createBuffer(),a=new Array(80),r={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var n=r.messageLengthSize/4,i=0;i<n;++i)r.fullMessageLength.push(0);return t=nr.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},r},r.start(),r.update=function(n,i){i==="utf8"&&(n=nr.util.encodeUtf8(n));var s=n.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var u=r.fullMessageLength.length-1;u>=0;--u)r.fullMessageLength[u]+=s[1],s[1]=s[0]+(r.fullMessageLength[u]/4294967296>>>0),r.fullMessageLength[u]=r.fullMessageLength[u]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(n),ec(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var n=nr.util.createBuffer();n.putBytes(t.bytes());var i=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=i&r.blockLength-1;n.putBytes(To.substr(0,r.blockLength-s));for(var u,f,c=r.fullMessageLength[0]*8,d=0;d<r.fullMessageLength.length-1;++d)u=r.fullMessageLength[d+1]*8,f=u/4294967296>>>0,c+=f,n.putInt32(c>>>0),c=u>>>0;n.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};ec(h,a,n);var C=nr.util.createBuffer();return C.putInt32(h.h0),C.putInt32(h.h1),C.putInt32(h.h2),C.putInt32(h.h3),C.putInt32(h.h4),C},r};var To=null,Jf=!1;function Vy(){To=String.fromCharCode(128),To+=nr.util.fillString(String.fromCharCode(0),64),Jf=!0}function ec(e,t,a){for(var r,n,i,s,u,f,c,d,h=a.length();h>=64;){for(n=e.h0,i=e.h1,s=e.h2,u=e.h3,f=e.h4,d=0;d<16;++d)r=a.getInt32(),t[d]=r,c=u^i&(s^u),r=(n<<5|n>>>27)+c+f+1518500249+r,f=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<20;++d)r=t[d-3]^t[d-8]^t[d-14]^t[d-16],r=r<<1|r>>>31,t[d]=r,c=u^i&(s^u),r=(n<<5|n>>>27)+c+f+1518500249+r,f=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<32;++d)r=t[d-3]^t[d-8]^t[d-14]^t[d-16],r=r<<1|r>>>31,t[d]=r,c=i^s^u,r=(n<<5|n>>>27)+c+f+1859775393+r,f=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<40;++d)r=t[d-6]^t[d-16]^t[d-28]^t[d-32],r=r<<2|r>>>30,t[d]=r,c=i^s^u,r=(n<<5|n>>>27)+c+f+1859775393+r,f=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<60;++d)r=t[d-6]^t[d-16]^t[d-28]^t[d-32],r=r<<2|r>>>30,t[d]=r,c=i&s|u&(i^s),r=(n<<5|n>>>27)+c+f+2400959708+r,f=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<80;++d)r=t[d-6]^t[d-16]^t[d-28]^t[d-32],r=r<<2|r>>>30,t[d]=r,c=i^s^u,r=(n<<5|n>>>27)+c+f+3395469782+r,f=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;e.h0=e.h0+n|0,e.h1=e.h1+i|0,e.h2=e.h2+s|0,e.h3=e.h3+u|0,e.h4=e.h4+f|0,h-=64}}});var Ao=ae(($v,ac)=>{var ir=ue();me();kt();Ka();var rc=ac.exports=ir.pkcs1=ir.pkcs1||{};rc.encode_rsa_oaep=function(e,t,a){var r,n,i,s;typeof a=="string"?(r=a,n=arguments[3]||void 0,i=arguments[4]||void 0):a&&(r=a.label||void 0,n=a.seed||void 0,i=a.md||void 0,a.mgf1&&a.mgf1.md&&(s=a.mgf1.md)),i?i.start():i=ir.md.sha1.create(),s||(s=i);var u=Math.ceil(e.n.bitLength()/8),f=u-2*i.digestLength-2;if(t.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=t.length,c.maxLength=f,c}r||(r=""),i.update(r,"raw");for(var d=i.digest(),h="",C=f-t.length,E=0;E<C;E++)h+="\0";var v=d.getBytes()+h+""+t;if(!n)n=ir.random.getBytes(i.digestLength);else if(n.length!==i.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=n.length,c.digestLength=i.digestLength,c}var _=ts(n,u-i.digestLength-1,s),S=ir.util.xorBytes(v,_,v.length),b=ts(S,i.digestLength,s),A=ir.util.xorBytes(n,b,n.length);return"\0"+A+S};rc.decode_rsa_oaep=function(e,t,a){var r,n,i;typeof a=="string"?(r=a,n=arguments[3]||void 0):a&&(r=a.label||void 0,n=a.md||void 0,a.mgf1&&a.mgf1.md&&(i=a.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var S=new Error("RSAES-OAEP encoded message length is invalid.");throw S.length=t.length,S.expectedLength=s,S}if(n===void 0?n=ir.md.sha1.create():n.start(),i||(i=n),s<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");r||(r=""),n.update(r,"raw");for(var u=n.digest().getBytes(),f=t.charAt(0),c=t.substring(1,n.digestLength+1),d=t.substring(1+n.digestLength),h=ts(d,n.digestLength,i),C=ir.util.xorBytes(c,h,c.length),E=ts(C,s-n.digestLength-1,i),v=ir.util.xorBytes(d,E,d.length),_=v.substring(0,n.digestLength),S=f!=="\0",b=0;b<n.digestLength;++b)S|=u.charAt(b)!==_.charAt(b);for(var A=1,w=n.digestLength,P=n.digestLength;P<v.length;P++){var k=v.charCodeAt(P),N=k&1^1,G=A?65534:0;S|=k&G,A=A&N,w+=A}if(S||v.charCodeAt(w)!==1)throw new Error("Invalid RSAES-OAEP padding.");return v.substring(w+1)};function ts(e,t,a){a||(a=ir.md.sha1.create());for(var r="",n=Math.ceil(t/a.digestLength),i=0;i<n;++i){var s=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255);a.start(),a.update(e+s),r+=a.digest().getBytes()}return r.substring(0,t)}});var Io=ae((Yv,_o)=>{var Mr=ue();me();Fn();kt();(function(){if(Mr.prime){_o.exports=Mr.prime;return}var e=_o.exports=Mr.prime=Mr.prime||{},t=Mr.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],r=new t(null);r.fromInt(30);var n=function(h,C){return h|C};e.generateProbablePrime=function(h,C,E){typeof C=="function"&&(E=C,C={}),C=C||{};var v=C.algorithm||"PRIMEINC";typeof v=="string"&&(v={name:v}),v.options=v.options||{};var _=C.prng||Mr.random,S={nextBytes:function(b){for(var A=_.getBytesSync(b.length),w=0;w<b.length;++w)b[w]=A.charCodeAt(w)}};if(v.name==="PRIMEINC")return i(h,S,v.options,E);throw new Error("Invalid prime generation algorithm: "+v.name)};function i(h,C,E,v){return"workers"in E?f(h,C,E,v):s(h,C,E,v)}function s(h,C,E,v){var _=c(h,C),S=0,b=d(_.bitLength());"millerRabinTests"in E&&(b=E.millerRabinTests);var A=10;"maxBlockTime"in E&&(A=E.maxBlockTime),u(_,h,C,S,b,A,v)}function u(h,C,E,v,_,S,b){var A=+new Date;do{if(h.bitLength()>C&&(h=c(C,E)),h.isProbablePrime(_))return b(null,h);h.dAddOffset(a[v++%8],0)}while(S<0||+new Date-A<S);Mr.util.setImmediate(function(){u(h,C,E,v,_,S,b)})}function f(h,C,E,v){if(typeof Worker=="undefined")return s(h,C,E,v);var _=c(h,C),S=E.workers,b=E.workLoad||100,A=b*30/8,w=E.workerScript||"forge/prime.worker.js";if(S===-1)return Mr.util.estimateCores(function(k,N){k&&(N=2),S=N-1,P()});P();function P(){S=Math.max(1,S);for(var k=[],N=0;N<S;++N)k[N]=new Worker(w);for(var G=S,N=0;N<S;++N)k[N].addEventListener("message",Y);var q=!1;function Y(H){if(!q){--G;var re=H.data;if(re.found){for(var K=0;K<k.length;++K)k[K].terminate();return q=!0,v(null,new t(re.prime,16))}_.bitLength()>h&&(_=c(h,C));var xe=_.toString(16);H.target.postMessage({hex:xe,workLoad:b}),_.dAddOffset(A,0)}}}}function c(h,C){var E=new t(h,C),v=h-1;return E.testBit(v)||E.bitwiseTo(t.ONE.shiftLeft(v),n,E),E.dAddOffset(31-E.mod(r).byteValue(),0),E}function d(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Vn=ae((Xv,fc)=>{var ne=ue();Qt();Fn();Vr();Ao();Io();kt();me();typeof ye=="undefined"&&(ye=ne.jsbn.BigInteger);var ye,Bo=ne.util.isNodejs?require("crypto"):null,L=ne.asn1,Dt=ne.util;ne.pki=ne.pki||{};fc.exports=ne.pki.rsa=ne.rsa=ne.rsa||{};var ie=ne.pki,qy=[6,4,2,4,2,4,6,2],My={name:"PrivateKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Ky={name:"RSAPrivateKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Hy={name:"RSAPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},zy=ne.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Wy=function(e){var t;if(e.algorithm in ie.oids)t=ie.oids[e.algorithm];else{var a=new Error("Unknown message digest algorithm.");throw a.algorithm=e.algorithm,a}var r=L.oidToDer(t).getBytes(),n=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]),i=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);i.value.push(L.create(L.Class.UNIVERSAL,L.Type.OID,!1,r)),i.value.push(L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,""));var s=L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,e.digest().getBytes());return n.value.push(i),n.value.push(s),L.toDer(n).getBytes()},nc=function(e,t,a){if(a)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(ye.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(ye.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var r;do r=new ye(ne.util.bytesToHex(ne.random.getBytes(t.n.bitLength()/8)),16);while(r.compareTo(t.n)>=0||!r.gcd(t.n).equals(ye.ONE));e=e.multiply(r.modPow(t.e,t.n)).mod(t.n);for(var n=e.mod(t.p).modPow(t.dP,t.p),i=e.mod(t.q).modPow(t.dQ,t.q);n.compareTo(i)<0;)n=n.add(t.p);var s=n.subtract(i).multiply(t.qInv).mod(t.p).multiply(t.q).add(i);return s=s.multiply(r.modInverse(t.n)).mod(t.n),s};ie.rsa.encrypt=function(e,t,a){var r=a,n,i=Math.ceil(t.n.bitLength()/8);a!==!1&&a!==!0?(r=a===2,n=ic(e,t,a)):(n=ne.util.createBuffer(),n.putBytes(e));for(var s=new ye(n.toHex(),16),u=nc(s,t,r),f=u.toString(16),c=ne.util.createBuffer(),d=i-Math.ceil(f.length/2);d>0;)c.putByte(0),--d;return c.putBytes(ne.util.hexToBytes(f)),c.getBytes()};ie.rsa.decrypt=function(e,t,a,r){var n=Math.ceil(t.n.bitLength()/8);if(e.length!==n){var i=new Error("Encrypted message length is invalid.");throw i.length=e.length,i.expected=n,i}var s=new ye(ne.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var u=nc(s,t,a),f=u.toString(16),c=ne.util.createBuffer(),d=n-Math.ceil(f.length/2);d>0;)c.putByte(0),--d;return c.putBytes(ne.util.hexToBytes(f)),r!==!1?rs(c.getBytes(),t,a):c.getBytes()};ie.rsa.createKeyPairGenerationState=function(e,t,a){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,a=a||{};var r=a.prng||ne.random,n={nextBytes:function(u){for(var f=r.getBytesSync(u.length),c=0;c<u.length;++c)u[c]=f.charCodeAt(c)}},i=a.algorithm||"PRIMEINC",s;if(i==="PRIMEINC")s={algorithm:i,state:0,bits:e,rng:n,eInt:t||65537,e:new ye(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+i);return s};ie.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var a=new ye(null);a.fromInt(30);for(var r=0,n=function(h,C){return h|C},i=+new Date,s,u=0;e.keys===null&&(t<=0||u<t);){if(e.state===0){var f=e.p===null?e.pBits:e.qBits,c=f-1;e.pqState===0?(e.num=new ye(f,e.rng),e.num.testBit(c)||e.num.bitwiseTo(ye.ONE.shiftLeft(c),n,e.num),e.num.dAddOffset(31-e.num.mod(a).byteValue(),0),r=0,++e.pqState):e.pqState===1?e.num.bitLength()>f?e.pqState=0:e.num.isProbablePrime(Qy(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(qy[r++%8],0):e.pqState===2?e.pqState=e.num.subtract(ye.ONE).gcd(e.e).compareTo(ye.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(ye.ONE),e.q1=e.q.subtract(ye.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(ye.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var d=e.e.modInverse(e.phi);e.keys={privateKey:ie.rsa.setPrivateKey(e.n,e.e,d,e.p,e.q,d.mod(e.p1),d.mod(e.q1),e.q.modInverse(e.p)),publicKey:ie.rsa.setPublicKey(e.n,e.e)}}s=+new Date,u+=s-i,i=s}return e.keys!==null};ie.rsa.generateKeyPair=function(e,t,a,r){if(arguments.length===1?typeof e=="object"?(a=e,e=void 0):typeof e=="function"&&(r=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(r=t,t=void 0):typeof t!="number"&&(a=t,t=void 0):(a=e,r=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof a=="function"&&(r=a,a=void 0):(r=a,a=t,t=void 0)),a=a||{},e===void 0&&(e=a.bits||2048),t===void 0&&(t=a.e||65537),!ne.options.usePureJavaScript&&!a.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(r){if(sc("generateKeyPair"))return Bo.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(u,f,c){if(u)return r(u);r(null,{privateKey:ie.privateKeyFromPem(c),publicKey:ie.publicKeyFromPem(f)})});if(oc("generateKey")&&oc("exportKey"))return Dt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:lc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(u){return Dt.globalScope.crypto.subtle.exportKey("pkcs8",u.privateKey)}).then(void 0,function(u){r(u)}).then(function(u){if(u){var f=ie.privateKeyFromAsn1(L.fromDer(ne.util.createBuffer(u)));r(null,{privateKey:f,publicKey:ie.setRsaPublicKey(f.n,f.e)})}});if(uc("generateKey")&&uc("exportKey")){var n=Dt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:lc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(u){var f=u.target.result,c=Dt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(d){var h=d.target.result,C=ie.privateKeyFromAsn1(L.fromDer(ne.util.createBuffer(h)));r(null,{privateKey:C,publicKey:ie.setRsaPublicKey(C.n,C.e)})},c.onerror=function(d){r(d)}},n.onerror=function(u){r(u)};return}}else if(sc("generateKeyPairSync")){var i=Bo.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ie.privateKeyFromPem(i.privateKey),publicKey:ie.publicKeyFromPem(i.publicKey)}}}var s=ie.rsa.createKeyPairGenerationState(e,t,a);if(!r)return ie.rsa.stepKeyPairGenerationState(s,0),s.keys;Gy(s,a,r)};ie.setRsaPublicKey=ie.rsa.setPublicKey=function(e,t){var a={n:e,e:t};return a.encrypt=function(r,n,i){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(u,f,c){return ic(u,f,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(u,f){return ne.pkcs1.encode_rsa_oaep(f,u,i)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(u){return u}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var s=n.encode(r,a,!0);return ie.rsa.encrypt(s,a,!0)},a.verify=function(r,n,i){typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSASSA-PKCS1-V1_5"),i==="RSASSA-PKCS1-V1_5"?i={verify:function(u,f){f=rs(f,a,!0);var c=L.fromDer(f);return u===c.value[1].value}}:(i==="NONE"||i==="NULL"||i===null)&&(i={verify:function(u,f){return f=rs(f,a,!0),u===f}});var s=ie.rsa.decrypt(n,a,!0,!1);return i.verify(r,s,a.n.bitLength())},a};ie.setRsaPrivateKey=ie.rsa.setPrivateKey=function(e,t,a,r,n,i,s,u){var f={n:e,e:t,d:a,p:r,q:n,dP:i,dQ:s,qInv:u};return f.decrypt=function(c,d,h){typeof d=="string"?d=d.toUpperCase():d===void 0&&(d="RSAES-PKCS1-V1_5");var C=ie.rsa.decrypt(c,f,!1,!1);if(d==="RSAES-PKCS1-V1_5")d={decode:rs};else if(d==="RSA-OAEP"||d==="RSAES-OAEP")d={decode:function(E,v){return ne.pkcs1.decode_rsa_oaep(v,E,h)}};else if(["RAW","NONE","NULL",null].indexOf(d)!==-1)d={decode:function(E){return E}};else throw new Error('Unsupported encryption scheme: "'+d+'".');return d.decode(C,f,!1)},f.sign=function(c,d){var h=!1;typeof d=="string"&&(d=d.toUpperCase()),d===void 0||d==="RSASSA-PKCS1-V1_5"?(d={encode:Wy},h=1):(d==="NONE"||d==="NULL"||d===null)&&(d={encode:function(){return c}},h=1);var C=d.encode(c,f.n.bitLength());return ie.rsa.encrypt(C,f,h)},f};ie.wrapRsaPrivateKey=function(e){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(0).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(ie.oids.rsaEncryption).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(e).getBytes())])};ie.privateKeyFromAsn1=function(e){var t={},a=[];if(L.validate(e,My,t,a)&&(e=L.fromDer(ne.util.createBuffer(t.privateKey))),t={},a=[],!L.validate(e,Ky,t,a)){var r=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw r.errors=a,r}var n,i,s,u,f,c,d,h;return n=ne.util.createBuffer(t.privateKeyModulus).toHex(),i=ne.util.createBuffer(t.privateKeyPublicExponent).toHex(),s=ne.util.createBuffer(t.privateKeyPrivateExponent).toHex(),u=ne.util.createBuffer(t.privateKeyPrime1).toHex(),f=ne.util.createBuffer(t.privateKeyPrime2).toHex(),c=ne.util.createBuffer(t.privateKeyExponent1).toHex(),d=ne.util.createBuffer(t.privateKeyExponent2).toHex(),h=ne.util.createBuffer(t.privateKeyCoefficient).toHex(),ie.setRsaPrivateKey(new ye(n,16),new ye(i,16),new ye(s,16),new ye(u,16),new ye(f,16),new ye(c,16),new ye(d,16),new ye(h,16))};ie.privateKeyToAsn1=ie.privateKeyToRSAPrivateKey=function(e){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(0).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.n)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.e)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.d)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.p)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.q)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.dP)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.dQ)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.qInv))])};ie.publicKeyFromAsn1=function(e){var t={},a=[];if(L.validate(e,zy,t,a)){var r=L.derToOid(t.publicKeyOid);if(r!==ie.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=r,n}e=t.rsaPublicKey}if(a=[],!L.validate(e,Hy,t,a)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=a,n}var i=ne.util.createBuffer(t.publicKeyModulus).toHex(),s=ne.util.createBuffer(t.publicKeyExponent).toHex();return ie.setRsaPublicKey(new ye(i,16),new ye(s,16))};ie.publicKeyToAsn1=ie.publicKeyToSubjectPublicKeyInfo=function(e){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(ie.oids.rsaEncryption).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,[ie.publicKeyToRSAPublicKey(e)])])};ie.publicKeyToRSAPublicKey=function(e){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.n)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.e))])};function ic(e,t,a){var r=ne.util.createBuffer(),n=Math.ceil(t.n.bitLength()/8);if(e.length>n-11){var i=new Error("Message is too long for PKCS#1 v1.5 padding.");throw i.length=e.length,i.max=n-11,i}r.putByte(0),r.putByte(a);var s=n-3-e.length,u;if(a===0||a===1){u=a===0?0:255;for(var f=0;f<s;++f)r.putByte(u)}else for(;s>0;){for(var c=0,d=ne.random.getBytes(s),f=0;f<s;++f)u=d.charCodeAt(f),u===0?++c:r.putByte(u);s=c}return r.putByte(0),r.putBytes(e),r}function rs(e,t,a,r){var n=Math.ceil(t.n.bitLength()/8),i=ne.util.createBuffer(e),s=i.getByte(),u=i.getByte();if(s!==0||a&&u!==0&&u!==1||!a&&u!=2||a&&u===0&&typeof r=="undefined")throw new Error("Encryption block is invalid.");var f=0;if(u===0){f=n-3-r;for(var c=0;c<f;++c)if(i.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(u===1)for(f=0;i.length()>1;){if(i.getByte()!==255){--i.read;break}++f}else if(u===2)for(f=0;i.length()>1;){if(i.getByte()===0){--i.read;break}++f}var d=i.getByte();if(d!==0||f!==n-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function Gy(e,t,a){typeof t=="function"&&(a=t,t={}),t=t||{};var r={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(r.prng=t.prng),n();function n(){i(e.pBits,function(u,f){if(u)return a(u);if(e.p=f,e.q!==null)return s(u,e.q);i(e.qBits,s)})}function i(u,f){ne.prime.generateProbablePrime(u,r,f)}function s(u,f){if(u)return a(u);if(e.q=f,e.p.compareTo(e.q)<0){var c=e.p;e.p=e.q,e.q=c}if(e.p.subtract(ye.ONE).gcd(e.e).compareTo(ye.ONE)!==0){e.p=null,n();return}if(e.q.subtract(ye.ONE).gcd(e.e).compareTo(ye.ONE)!==0){e.q=null,i(e.qBits,s);return}if(e.p1=e.p.subtract(ye.ONE),e.q1=e.q.subtract(ye.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(ye.ONE)!==0){e.p=e.q=null,n();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,i(e.qBits,s);return}var d=e.e.modInverse(e.phi);e.keys={privateKey:ie.rsa.setPrivateKey(e.n,e.e,d,e.p,e.q,d.mod(e.p1),d.mod(e.q1),e.q.modInverse(e.p)),publicKey:ie.rsa.setPublicKey(e.n,e.e)},a(null,e.keys)}}function sr(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var a=ne.util.hexToBytes(t);return a.length>1&&(a.charCodeAt(0)===0&&(a.charCodeAt(1)&128)===0||a.charCodeAt(0)===255&&(a.charCodeAt(1)&128)===128)?a.substr(1):a}function Qy(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function sc(e){return ne.util.isNodejs&&typeof Bo[e]=="function"}function oc(e){return typeof Dt.globalScope!="undefined"&&typeof Dt.globalScope.crypto=="object"&&typeof Dt.globalScope.crypto.subtle=="object"&&typeof Dt.globalScope.crypto.subtle[e]=="function"}function uc(e){return typeof Dt.globalScope!="undefined"&&typeof Dt.globalScope.msCrypto=="object"&&typeof Dt.globalScope.msCrypto.subtle=="object"&&typeof Dt.globalScope.msCrypto.subtle[e]=="function"}function lc(e){for(var t=ne.util.hexToBytes(e.toString(16)),a=new Uint8Array(t.length),r=0;r<t.length;++r)a[r]=t.charCodeAt(r);return a}});var wo=ae((Zv,yc)=>{var $=ue();Fr();Qt();Un();Jt();Vr();Xi();sa();kt();So();Vn();me();typeof cc=="undefined"&&(cc=$.jsbn.BigInteger);var cc,D=$.asn1,se=$.pki=$.pki||{};yc.exports=se.pbe=$.pbe=$.pbe||{};var la=se.oids,jy={name:"EncryptedPrivateKeyInfo",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:D.Class.UNIVERSAL,type:D.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},$y={name:"PBES2Algorithms",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:D.Class.UNIVERSAL,type:D.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:D.Class.UNIVERSAL,type:D.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Yy={name:"pkcs-12PbeParams",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:D.Class.UNIVERSAL,type:D.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"iterations"}]};se.encryptPrivateKeyInfo=function(e,t,a){a=a||{},a.saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||"aes128",a.prfAlgorithm=a.prfAlgorithm||"sha1";var r=$.random.getBytesSync(a.saltSize),n=a.count,i=D.integerToDer(n),s,u,f;if(a.algorithm.indexOf("aes")===0||a.algorithm==="des"){var c,d,h;switch(a.algorithm){case"aes128":s=16,c=16,d=la["aes128-CBC"],h=$.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,d=la["aes192-CBC"],h=$.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,d=la["aes256-CBC"],h=$.aes.createEncryptionCipher;break;case"des":s=8,c=8,d=la.desCBC,h=$.des.createEncryptionCipher;break;default:var C=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw C.algorithm=a.algorithm,C}var E="hmacWith"+a.prfAlgorithm.toUpperCase(),v=pc(E),_=$.pkcs5.pbkdf2(t,r,n,s,v),S=$.random.getBytesSync(c),b=h(_);b.start(S),b.update(D.toDer(e)),b.finish(),f=b.output.getBytes();var A=Xy(r,i,s,E);u=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(la.pkcs5PBES2).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(la.pkcs5PBKDF2).getBytes()),A]),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(d).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,S)])])])}else if(a.algorithm==="3des"){s=24;var w=new $.util.ByteBuffer(r),_=se.pbe.generatePkcs12Key(t,w,1,n,s),S=se.pbe.generatePkcs12Key(t,w,2,n,s),b=$.des.createEncryptionCipher(_);b.start(S),b.update(D.toDer(e)),b.finish(),f=b.output.getBytes(),u=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(la["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,r),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,i.getBytes())])])}else{var C=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw C.algorithm=a.algorithm,C}var P=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[u,D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,f)]);return P};se.decryptPrivateKeyInfo=function(e,t){var a=null,r={},n=[];if(!D.validate(e,jy,r,n)){var i=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=n,i}var s=D.derToOid(r.encryptionOid),u=se.pbe.getCipher(s,r.encryptionParams,t),f=$.util.createBuffer(r.encryptedData);return u.update(f),u.finish()&&(a=D.fromDer(u.output)),a};se.encryptedPrivateKeyToPem=function(e,t){var a={type:"ENCRYPTED PRIVATE KEY",body:D.toDer(e).getBytes()};return $.pem.encode(a,{maxline:t})};se.encryptedPrivateKeyFromPem=function(e){var t=$.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var a=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return D.fromDer(t.body)};se.encryptRsaPrivateKey=function(e,t,a){if(a=a||{},!a.legacy){var r=se.wrapRsaPrivateKey(se.privateKeyToAsn1(e));return r=se.encryptPrivateKeyInfo(r,t,a),se.encryptedPrivateKeyToPem(r)}var n,i,s,u;switch(a.algorithm){case"aes128":n="AES-128-CBC",s=16,i=$.random.getBytesSync(16),u=$.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",s=24,i=$.random.getBytesSync(16),u=$.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",s=32,i=$.random.getBytesSync(16),u=$.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",s=24,i=$.random.getBytesSync(8),u=$.des.createEncryptionCipher;break;case"des":n="DES-CBC",s=8,i=$.random.getBytesSync(8),u=$.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+a.algorithm+'".');throw f.algorithm=a.algorithm,f}var c=$.pbe.opensslDeriveBytes(t,i.substr(0,8),s),d=u(c);d.start(i),d.update(D.toDer(se.privateKeyToAsn1(e))),d.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:$.util.bytesToHex(i).toUpperCase()},body:d.output.getBytes()};return $.pem.encode(h)};se.decryptRsaPrivateKey=function(e,t){var a=null,r=$.pem.decode(e)[0];if(r.type!=="ENCRYPTED PRIVATE KEY"&&r.type!=="PRIVATE KEY"&&r.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(r.procType&&r.procType.type==="ENCRYPTED"){var i,s;switch(r.dekInfo.algorithm){case"DES-CBC":i=8,s=$.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,s=$.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,s=$.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,s=$.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,s=$.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,s=function(h){return $.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":i=8,s=function(h){return $.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":i=16,s=function(h){return $.rc2.createDecryptionCipher(h,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+r.dekInfo.algorithm+'".');throw n.algorithm=r.dekInfo.algorithm,n}var u=$.util.hexToBytes(r.dekInfo.parameters),f=$.pbe.opensslDeriveBytes(t,u.substr(0,8),i),c=s(f);if(c.start(u),c.update($.util.createBuffer(r.body)),c.finish())a=c.output.getBytes();else return a}else a=r.body;return r.type==="ENCRYPTED PRIVATE KEY"?a=se.decryptPrivateKeyInfo(D.fromDer(a),t):a=D.fromDer(a),a!==null&&(a=se.privateKeyFromAsn1(a)),a};se.pbe.generatePkcs12Key=function(e,t,a,r,n,i){var s,u;if(typeof i=="undefined"||i===null){if(!("sha1"in $.md))throw new Error('"sha1" hash algorithm unavailable.');i=$.md.sha1.create()}var f=i.digestLength,c=i.blockLength,d=new $.util.ByteBuffer,h=new $.util.ByteBuffer;if(e!=null){for(u=0;u<e.length;u++)h.putInt16(e.charCodeAt(u));h.putInt16(0)}var C=h.length(),E=t.length(),v=new $.util.ByteBuffer;v.fillWithByte(a,c);var _=c*Math.ceil(E/c),S=new $.util.ByteBuffer;for(u=0;u<_;u++)S.putByte(t.at(u%E));var b=c*Math.ceil(C/c),A=new $.util.ByteBuffer;for(u=0;u<b;u++)A.putByte(h.at(u%C));var w=S;w.putBuffer(A);for(var P=Math.ceil(n/f),k=1;k<=P;k++){var N=new $.util.ByteBuffer;N.putBytes(v.bytes()),N.putBytes(w.bytes());for(var G=0;G<r;G++)i.start(),i.update(N.getBytes()),N=i.digest();var q=new $.util.ByteBuffer;for(u=0;u<c;u++)q.putByte(N.at(u%f));var Y=Math.ceil(E/c)+Math.ceil(C/c),H=new $.util.ByteBuffer;for(s=0;s<Y;s++){var re=new $.util.ByteBuffer(w.getBytes(c)),K=511;for(u=q.length()-1;u>=0;u--)K=K>>8,K+=q.at(u)+re.at(u),re.setAt(u,K&255);H.putBuffer(re)}w=H,d.putBuffer(N)}return d.truncate(d.length()-n),d};se.pbe.getCipher=function(e,t,a){switch(e){case se.oids.pkcs5PBES2:return se.pbe.getCipherForPBES2(e,t,a);case se.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case se.oids["pbewithSHAAnd40BitRC2-CBC"]:return se.pbe.getCipherForPKCS12PBE(e,t,a);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=e,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}};se.pbe.getCipherForPBES2=function(e,t,a){var r={},n=[];if(!D.validate(t,$y,r,n)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=n,i}if(e=D.derToOid(r.kdfOid),e!==se.oids.pkcs5PBKDF2){var i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw i.oid=e,i.supportedOids=["pkcs5PBKDF2"],i}if(e=D.derToOid(r.encOid),e!==se.oids["aes128-CBC"]&&e!==se.oids["aes192-CBC"]&&e!==se.oids["aes256-CBC"]&&e!==se.oids["des-EDE3-CBC"]&&e!==se.oids.desCBC){var i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw i.oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i}var s=r.kdfSalt,u=$.util.createBuffer(r.kdfIterationCount);u=u.getInt(u.length()<<3);var f,c;switch(se.oids[e]){case"aes128-CBC":f=16,c=$.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=$.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=$.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=$.des.createDecryptionCipher;break;case"desCBC":f=8,c=$.des.createDecryptionCipher;break}var d=hc(r.prfOid),h=$.pkcs5.pbkdf2(a,s,u,f,d),C=r.encIv,E=c(h);return E.start(C),E};se.pbe.getCipherForPKCS12PBE=function(e,t,a){var r={},n=[];if(!D.validate(t,Yy,r,n)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=n,i}var s=$.util.createBuffer(r.salt),u=$.util.createBuffer(r.iterations);u=u.getInt(u.length()<<3);var f,c,d;switch(e){case se.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,d=$.des.startDecrypting;break;case se.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,d=function(_,S){var b=$.rc2.createDecryptionCipher(_,40);return b.start(S,null),b};break;default:var i=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw i.oid=e,i}var h=hc(r.prfOid),C=se.pbe.generatePkcs12Key(a,s,1,u,f,h);h.start();var E=se.pbe.generatePkcs12Key(a,s,2,u,c,h);return d(C,E)};se.pbe.opensslDeriveBytes=function(e,t,a,r){if(typeof r=="undefined"||r===null){if(!("md5"in $.md))throw new Error('"md5" hash algorithm unavailable.');r=$.md.md5.create()}t===null&&(t="");for(var n=[dc(r,e+t)],i=16,s=1;i<a;++s,i+=16)n.push(dc(r,n[s-1]+e+t));return n.join("").substr(0,a)};function dc(e,t){return e.start().update(t).digest().getBytes()}function hc(e){var t;if(!e)t="hmacWithSHA1";else if(t=se.oids[D.derToOid(e)],!t){var a=new Error("Unsupported PRF OID.");throw a.oid=e,a.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],a}return pc(t)}function pc(e){var t=$.md;switch(e){case"hmacWithSHA224":t=$.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var a=new Error("Unsupported PRF algorithm.");throw a.algorithm=e,a.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],a}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function Xy(e,t,a,r){var n=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,e),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,t.getBytes())]);return r!=="hmacWithSHA1"&&n.value.push(D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,$.util.hexToBytes(a.toString(16))),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(se.oids[r]).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.NULL,!1,"")])),n}});var Ro=ae((Jv,vc)=>{var Ha=ue();Qt();me();var j=Ha.asn1,za=vc.exports=Ha.pkcs7asn1=Ha.pkcs7asn1||{};Ha.pkcs7=Ha.pkcs7||{};Ha.pkcs7.asn1=za;var gc={name:"ContentInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:j.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};za.contentInfoValidator=gc;var mc={name:"EncryptedContentInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:j.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:j.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};za.envelopedDataValidator={name:"EnvelopedData",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:j.Class.UNIVERSAL,type:j.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(mc)};za.encryptedDataValidator={name:"EncryptedData",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"version"}].concat(mc)};var Zy={name:"SignerInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:j.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:j.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:j.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};za.signedDataValidator={name:"SignedData",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:j.Class.UNIVERSAL,type:j.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},gc,{name:"SignedData.Certificates",tagClass:j.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:j.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:j.Class.UNIVERSAL,type:j.Type.SET,capture:"signerInfos",optional:!0,value:[Zy]}]};za.recipientInfoValidator={name:"RecipientInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:j.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var No=ae((e1,Cc)=>{var fa=ue();me();fa.mgf=fa.mgf||{};var Jy=Cc.exports=fa.mgf.mgf1=fa.mgf1=fa.mgf1||{};Jy.create=function(e){var t={generate:function(a,r){for(var n=new fa.util.ByteBuffer,i=Math.ceil(r/e.digestLength),s=0;s<i;s++){var u=new fa.util.ByteBuffer;u.putInt32(s),e.start(),e.update(a+u.getBytes()),n.putBuffer(e.digest())}return n.truncate(n.length()-r),n.getBytes()}};return t}});var Ec=ae((t1,Sc)=>{var as=ue();No();Sc.exports=as.mgf=as.mgf||{};as.mgf.mgf1=as.mgf1});var ns=ae((r1,bc)=>{var ca=ue();kt();me();var eg=bc.exports=ca.pss=ca.pss||{};eg.create=function(e){arguments.length===3&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t=e.md,a=e.mgf,r=t.digestLength,n=e.salt||null;typeof n=="string"&&(n=ca.util.createBuffer(n));var i;if("saltLength"in e)i=e.saltLength;else if(n!==null)i=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==i)throw new Error("Given salt length does not match length of given salt.");var s=e.prng||ca.random,u={};return u.encode=function(f,c){var d,h=c-1,C=Math.ceil(h/8),E=f.digest().getBytes();if(C<r+i+2)throw new Error("Message is too long to encrypt.");var v;n===null?v=s.getBytesSync(i):v=n.bytes();var _=new ca.util.ByteBuffer;_.fillWithByte(0,8),_.putBytes(E),_.putBytes(v),t.start(),t.update(_.getBytes());var S=t.digest().getBytes(),b=new ca.util.ByteBuffer;b.fillWithByte(0,C-i-r-2),b.putByte(1),b.putBytes(v);var A=b.getBytes(),w=C-r-1,P=a.generate(S,w),k="";for(d=0;d<w;d++)k+=String.fromCharCode(A.charCodeAt(d)^P.charCodeAt(d));var N=65280>>8*C-h&255;return k=String.fromCharCode(k.charCodeAt(0)&~N)+k.substr(1),k+S+String.fromCharCode(188)},u.verify=function(f,c,d){var h,C=d-1,E=Math.ceil(C/8);if(c=c.substr(-E),E<r+i+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(c.charCodeAt(E-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var v=E-r-1,_=c.substr(0,v),S=c.substr(v,r),b=65280>>8*E-C&255;if((_.charCodeAt(0)&b)!==0)throw new Error("Bits beyond keysize not zero as expected.");var A=a.generate(S,v),w="";for(h=0;h<v;h++)w+=String.fromCharCode(_.charCodeAt(h)^A.charCodeAt(h));w=String.fromCharCode(w.charCodeAt(0)&~b)+w.substr(1);var P=E-r-i-2;for(h=0;h<P;h++)if(w.charCodeAt(h)!==0)throw new Error("Leftmost octets not zero as expected");if(w.charCodeAt(P)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var k=w.substr(-i),N=new ca.util.ByteBuffer;N.fillWithByte(0,8),N.putBytes(f),N.putBytes(k),t.start(),t.update(N.getBytes());var G=t.digest().getBytes();return S===G},u}});var os=ae((a1,Ic)=>{var J=ue();Fr();Qt();Un();Jt();Ec();Vr();sa();ns();Vn();me();var y=J.asn1,z=Ic.exports=J.pki=J.pki||{},ge=z.oids,Ke={};Ke.CN=ge.commonName;Ke.commonName="CN";Ke.C=ge.countryName;Ke.countryName="C";Ke.L=ge.localityName;Ke.localityName="L";Ke.ST=ge.stateOrProvinceName;Ke.stateOrProvinceName="ST";Ke.O=ge.organizationName;Ke.organizationName="O";Ke.OU=ge.organizationalUnitName;Ke.organizationalUnitName="OU";Ke.E=ge.emailAddress;Ke.emailAddress="E";var xc=J.pki.rsa.publicKeyValidator,tg={name:"Certificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},xc,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},rg={name:"rsapss",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},ag={name:"CertificationRequestInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},xc,{name:"CertificationRequestInfo.attributes",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:y.Class.UNIVERSAL,type:y.Type.SET,constructed:!0}]}]}]},ng={name:"CertificationRequest",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[ag,{name:"CertificationRequest.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};z.RDNAttributesAsArray=function(e,t){for(var a=[],r,n,i,s=0;s<e.value.length;++s){r=e.value[s];for(var u=0;u<r.value.length;++u)i={},n=r.value[u],i.type=y.derToOid(n.value[0].value),i.value=n.value[1].value,i.valueTagClass=n.value[1].type,i.type in ge&&(i.name=ge[i.type],i.name in Ke&&(i.shortName=Ke[i.name])),t&&(t.update(i.type),t.update(i.value)),a.push(i)}return a};z.CRIAttributesAsArray=function(e){for(var t=[],a=0;a<e.length;++a)for(var r=e[a],n=y.derToOid(r.value[0].value),i=r.value[1].value,s=0;s<i.length;++s){var u={};if(u.type=n,u.value=i[s].value,u.valueTagClass=i[s].type,u.type in ge&&(u.name=ge[u.type],u.name in Ke&&(u.shortName=Ke[u.name])),u.type===ge.extensionRequest){u.extensions=[];for(var f=0;f<u.value.length;++f)u.extensions.push(z.certificateExtensionFromAsn1(u.value[f]))}t.push(u)}return t};function Kr(e,t){typeof t=="string"&&(t={shortName:t});for(var a=null,r,n=0;a===null&&n<e.attributes.length;++n)r=e.attributes[n],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(a=r);return a}var is=function(e,t,a){var r={};if(e!==ge["RSASSA-PSS"])return r;a&&(r={hash:{algorithmOid:ge.sha1},mgf:{algorithmOid:ge.mgf1,hash:{algorithmOid:ge.sha1}},saltLength:20});var n={},i=[];if(!y.validate(t,rg,n,i)){var s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=i,s}return n.hashOid!==void 0&&(r.hash=r.hash||{},r.hash.algorithmOid=y.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=y.derToOid(n.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=y.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(r.saltLength=n.saltLength.charCodeAt(0)),r},ss=function(e){switch(ge[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return J.md.sha1.create();case"md5WithRSAEncryption":return J.md.md5.create();case"sha256WithRSAEncryption":return J.md.sha256.create();case"sha384WithRSAEncryption":return J.md.sha384.create();case"sha512WithRSAEncryption":return J.md.sha512.create();case"RSASSA-PSS":return J.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},Tc=function(e){var t=e.certificate,a;switch(t.signatureOid){case ge.sha1WithRSAEncryption:case ge.sha1WithRSASignature:break;case ge["RSASSA-PSS"]:var r,n;if(r=ge[t.signatureParameters.mgf.hash.algorithmOid],r===void 0||J.md[r]===void 0){var i=new Error("Unsupported MGF hash function.");throw i.oid=t.signatureParameters.mgf.hash.algorithmOid,i.name=r,i}if(n=ge[t.signatureParameters.mgf.algorithmOid],n===void 0||J.mgf[n]===void 0){var i=new Error("Unsupported MGF function.");throw i.oid=t.signatureParameters.mgf.algorithmOid,i.name=n,i}if(n=J.mgf[n].create(J.md[r].create()),r=ge[t.signatureParameters.hash.algorithmOid],r===void 0||J.md[r]===void 0){var i=new Error("Unsupported RSASSA-PSS hash function.");throw i.oid=t.signatureParameters.hash.algorithmOid,i.name=r,i}a=J.pss.create(J.md[r].create(),n,t.signatureParameters.saltLength);break}return t.publicKey.verify(e.md.digest().getBytes(),e.signature,a)};z.certificateFromPem=function(e,t,a){var r=J.pem.decode(e)[0];if(r.type!=="CERTIFICATE"&&r.type!=="X509 CERTIFICATE"&&r.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=r.type,n}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var i=y.fromDer(r.body,a);return z.certificateFromAsn1(i,t)};z.certificateToPem=function(e,t){var a={type:"CERTIFICATE",body:y.toDer(z.certificateToAsn1(e)).getBytes()};return J.pem.encode(a,{maxline:t})};z.publicKeyFromPem=function(e){var t=J.pem.decode(e)[0];if(t.type!=="PUBLIC KEY"&&t.type!=="RSA PUBLIC KEY"){var a=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=y.fromDer(t.body);return z.publicKeyFromAsn1(r)};z.publicKeyToPem=function(e,t){var a={type:"PUBLIC KEY",body:y.toDer(z.publicKeyToAsn1(e)).getBytes()};return J.pem.encode(a,{maxline:t})};z.publicKeyToRSAPublicKeyPem=function(e,t){var a={type:"RSA PUBLIC KEY",body:y.toDer(z.publicKeyToRSAPublicKey(e)).getBytes()};return J.pem.encode(a,{maxline:t})};z.getPublicKeyFingerprint=function(e,t){t=t||{};var a=t.md||J.md.sha1.create(),r=t.type||"RSAPublicKey",n;switch(r){case"RSAPublicKey":n=y.toDer(z.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":n=y.toDer(z.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}a.start(),a.update(n);var i=a.digest();if(t.encoding==="hex"){var s=i.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return i.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return i};z.certificationRequestFromPem=function(e,t,a){var r=J.pem.decode(e)[0];if(r.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=r.type,n}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var i=y.fromDer(r.body,a);return z.certificationRequestFromAsn1(i,t)};z.certificationRequestToPem=function(e,t){var a={type:"CERTIFICATE REQUEST",body:y.toDer(z.certificationRequestToAsn1(e)).getBytes()};return J.pem.encode(a,{maxline:t})};z.createCertificate=function(){var e={};return e.version=2,e.serialNumber="00",e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return Kr(e.issuer,t)},e.issuer.addField=function(t){Ut([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return Kr(e.subject,t)},e.subject.addField=function(t){Ut([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,a){Ut(t),e.subject.attributes=t,delete e.subject.uniqueId,a&&(e.subject.uniqueId=a),e.subject.hash=null},e.setIssuer=function(t,a){Ut(t),e.issuer.attributes=t,delete e.issuer.uniqueId,a&&(e.issuer.uniqueId=a),e.issuer.hash=null},e.setExtensions=function(t){for(var a=0;a<t.length;++a)Ac(t[a],{cert:e});e.extensions=t},e.getExtension=function(t){typeof t=="string"&&(t={name:t});for(var a=null,r,n=0;a===null&&n<e.extensions.length;++n)r=e.extensions[n],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(a=r);return a},e.sign=function(t,a){e.md=a||J.md.sha1.create();var r=ge[e.md.algorithm+"WithRSAEncryption"];if(!r){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=e.md.algorithm,n}e.signatureOid=e.siginfo.algorithmOid=r,e.tbsCertificate=z.getTBSCertificate(e);var i=y.toDer(e.tbsCertificate);e.md.update(i.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var a=!1;if(!e.issued(t)){var r=t.issuer,n=e.subject,i=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw i.expectedIssuer=n.attributes,i.actualIssuer=r.attributes,i}var s=t.md;if(s===null){s=ss({signatureOid:t.signatureOid,type:"certificate"});var u=t.tbsCertificate||z.getTBSCertificate(t),f=y.toDer(u);s.update(f.getBytes())}return s!==null&&(a=Tc({certificate:e,md:s,signature:t.signature})),a},e.isIssuer=function(t){var a=!1,r=e.issuer,n=t.subject;if(r.hash&&n.hash)a=r.hash===n.hash;else if(r.attributes.length===n.attributes.length){a=!0;for(var i,s,u=0;a&&u<r.attributes.length;++u)i=r.attributes[u],s=n.attributes[u],(i.type!==s.type||i.value!==s.value)&&(a=!1)}return a},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return z.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=ge.subjectKeyIdentifier,a=0;a<e.extensions.length;++a){var r=e.extensions[a];if(r.id===t){var n=e.generateSubjectKeyIdentifier().getBytes();return J.util.hexToBytes(r.subjectKeyIdentifier)===n}}return!1},e};z.certificateFromAsn1=function(e,t){var a={},r=[];if(!y.validate(e,tg,a,r)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=r,n}var i=y.derToOid(a.publicKeyOid);if(i!==z.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=z.createCertificate();s.version=a.certVersion?a.certVersion.charCodeAt(0):0;var u=J.util.createBuffer(a.certSerialNumber);s.serialNumber=u.toHex(),s.signatureOid=J.asn1.derToOid(a.certSignatureOid),s.signatureParameters=is(s.signatureOid,a.certSignatureParams,!0),s.siginfo.algorithmOid=J.asn1.derToOid(a.certinfoSignatureOid),s.siginfo.parameters=is(s.siginfo.algorithmOid,a.certinfoSignatureParams,!1),s.signature=a.certSignature;var f=[];if(a.certValidity1UTCTime!==void 0&&f.push(y.utcTimeToDate(a.certValidity1UTCTime)),a.certValidity2GeneralizedTime!==void 0&&f.push(y.generalizedTimeToDate(a.certValidity2GeneralizedTime)),a.certValidity3UTCTime!==void 0&&f.push(y.utcTimeToDate(a.certValidity3UTCTime)),a.certValidity4GeneralizedTime!==void 0&&f.push(y.generalizedTimeToDate(a.certValidity4GeneralizedTime)),f.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(f.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(s.validity.notBefore=f[0],s.validity.notAfter=f[1],s.tbsCertificate=a.tbsCertificate,t){s.md=ss({signatureOid:s.signatureOid,type:"certificate"});var c=y.toDer(s.tbsCertificate);s.md.update(c.getBytes())}var d=J.md.sha1.create(),h=y.toDer(a.certIssuer);d.update(h.getBytes()),s.issuer.getField=function(v){return Kr(s.issuer,v)},s.issuer.addField=function(v){Ut([v]),s.issuer.attributes.push(v)},s.issuer.attributes=z.RDNAttributesAsArray(a.certIssuer),a.certIssuerUniqueId&&(s.issuer.uniqueId=a.certIssuerUniqueId),s.issuer.hash=d.digest().toHex();var C=J.md.sha1.create(),E=y.toDer(a.certSubject);return C.update(E.getBytes()),s.subject.getField=function(v){return Kr(s.subject,v)},s.subject.addField=function(v){Ut([v]),s.subject.attributes.push(v)},s.subject.attributes=z.RDNAttributesAsArray(a.certSubject),a.certSubjectUniqueId&&(s.subject.uniqueId=a.certSubjectUniqueId),s.subject.hash=C.digest().toHex(),a.certExtensions?s.extensions=z.certificateExtensionsFromAsn1(a.certExtensions):s.extensions=[],s.publicKey=z.publicKeyFromAsn1(a.subjectPublicKeyInfo),s};z.certificateExtensionsFromAsn1=function(e){for(var t=[],a=0;a<e.value.length;++a)for(var r=e.value[a],n=0;n<r.value.length;++n)t.push(z.certificateExtensionFromAsn1(r.value[n]));return t};z.certificateExtensionFromAsn1=function(e){var t={};if(t.id=y.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===y.Type.BOOLEAN?(t.critical=e.value[1].value.charCodeAt(0)!==0,t.value=e.value[2].value):t.value=e.value[1].value,t.id in ge){if(t.name=ge[t.id],t.name==="keyUsage"){var a=y.fromDer(t.value),r=0,n=0;a.value.length>1&&(r=a.value.charCodeAt(1),n=a.value.length>2?a.value.charCodeAt(2):0),t.digitalSignature=(r&128)===128,t.nonRepudiation=(r&64)===64,t.keyEncipherment=(r&32)===32,t.dataEncipherment=(r&16)===16,t.keyAgreement=(r&8)===8,t.keyCertSign=(r&4)===4,t.cRLSign=(r&2)===2,t.encipherOnly=(r&1)===1,t.decipherOnly=(n&128)===128}else if(t.name==="basicConstraints"){var a=y.fromDer(t.value);a.value.length>0&&a.value[0].type===y.Type.BOOLEAN?t.cA=a.value[0].value.charCodeAt(0)!==0:t.cA=!1;var i=null;a.value.length>0&&a.value[0].type===y.Type.INTEGER?i=a.value[0].value:a.value.length>1&&(i=a.value[1].value),i!==null&&(t.pathLenConstraint=y.derToInteger(i))}else if(t.name==="extKeyUsage")for(var a=y.fromDer(t.value),s=0;s<a.value.length;++s){var u=y.derToOid(a.value[s].value);u in ge?t[ge[u]]=!0:t[u]=!0}else if(t.name==="nsCertType"){var a=y.fromDer(t.value),r=0;a.value.length>1&&(r=a.value.charCodeAt(1)),t.client=(r&128)===128,t.server=(r&64)===64,t.email=(r&32)===32,t.objsign=(r&16)===16,t.reserved=(r&8)===8,t.sslCA=(r&4)===4,t.emailCA=(r&2)===2,t.objCA=(r&1)===1}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.altNames=[];for(var f,a=y.fromDer(t.value),c=0;c<a.value.length;++c){f=a.value[c];var d={type:f.type,value:f.value};switch(t.altNames.push(d),f.type){case 1:case 2:case 6:break;case 7:d.ip=J.util.bytesToIP(f.value);break;case 8:d.oid=y.derToOid(f.value);break;default:}}}else if(t.name==="subjectKeyIdentifier"){var a=y.fromDer(t.value);t.subjectKeyIdentifier=J.util.bytesToHex(a.value)}}return t};z.certificationRequestFromAsn1=function(e,t){var a={},r=[];if(!y.validate(e,ng,a,r)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=r,n}var i=y.derToOid(a.publicKeyOid);if(i!==z.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=z.createCertificationRequest();if(s.version=a.csrVersion?a.csrVersion.charCodeAt(0):0,s.signatureOid=J.asn1.derToOid(a.csrSignatureOid),s.signatureParameters=is(s.signatureOid,a.csrSignatureParams,!0),s.siginfo.algorithmOid=J.asn1.derToOid(a.csrSignatureOid),s.siginfo.parameters=is(s.siginfo.algorithmOid,a.csrSignatureParams,!1),s.signature=a.csrSignature,s.certificationRequestInfo=a.certificationRequestInfo,t){s.md=ss({signatureOid:s.signatureOid,type:"certification request"});var u=y.toDer(s.certificationRequestInfo);s.md.update(u.getBytes())}var f=J.md.sha1.create();return s.subject.getField=function(c){return Kr(s.subject,c)},s.subject.addField=function(c){Ut([c]),s.subject.attributes.push(c)},s.subject.attributes=z.RDNAttributesAsArray(a.certificationRequestInfoSubject,f),s.subject.hash=f.digest().toHex(),s.publicKey=z.publicKeyFromAsn1(a.subjectPublicKeyInfo),s.getAttribute=function(c){return Kr(s,c)},s.addAttribute=function(c){Ut([c]),s.attributes.push(c)},s.attributes=z.CRIAttributesAsArray(a.certificationRequestInfoAttributes||[]),s};z.createCertificationRequest=function(){var e={};return e.version=0,e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return Kr(e.subject,t)},e.subject.addField=function(t){Ut([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return Kr(e,t)},e.addAttribute=function(t){Ut([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){Ut(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){Ut(t),e.attributes=t},e.sign=function(t,a){e.md=a||J.md.sha1.create();var r=ge[e.md.algorithm+"WithRSAEncryption"];if(!r){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=e.md.algorithm,n}e.signatureOid=e.siginfo.algorithmOid=r,e.certificationRequestInfo=z.getCertificationRequestInfo(e);var i=y.toDer(e.certificationRequestInfo);e.md.update(i.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,a=e.md;if(a===null){a=ss({signatureOid:e.signatureOid,type:"certification request"});var r=e.certificationRequestInfo||z.getCertificationRequestInfo(e),n=y.toDer(r);a.update(n.getBytes())}return a!==null&&(t=Tc({certificate:e,md:a,signature:e.signature})),t},e};function Wa(e){for(var t=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),a,r,n=e.attributes,i=0;i<n.length;++i){a=n[i];var s=a.value,u=y.Type.PRINTABLESTRING;"valueTagClass"in a&&(u=a.valueTagClass,u===y.Type.UTF8&&(s=J.util.encodeUtf8(s))),r=y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(a.type).getBytes()),y.create(y.Class.UNIVERSAL,u,!1,s)])]),t.value.push(r)}return t}function Ut(e){for(var t,a=0;a<e.length;++a){if(t=e[a],typeof t.name=="undefined"&&(t.type&&t.type in z.oids?t.name=z.oids[t.type]:t.shortName&&t.shortName in Ke&&(t.name=z.oids[Ke[t.shortName]])),typeof t.type=="undefined")if(t.name&&t.name in z.oids)t.type=z.oids[t.name];else{var r=new Error("Attribute type not specified.");throw r.attribute=t,r}if(typeof t.shortName=="undefined"&&t.name&&t.name in Ke&&(t.shortName=Ke[t.name]),t.type===ge.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=y.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(z.certificateExtensionToAsn1(Ac(t.extensions[n])))}if(typeof t.value=="undefined"){var r=new Error("Attribute value not specified.");throw r.attribute=t,r}}}function Ac(e,t){if(t=t||{},typeof e.name=="undefined"&&e.id&&e.id in z.oids&&(e.name=z.oids[e.id]),typeof e.id=="undefined")if(e.name&&e.name in z.oids)e.id=z.oids[e.name];else{var a=new Error("Extension ID not specified.");throw a.extension=e,a}if(typeof e.value!="undefined")return e;if(e.name==="keyUsage"){var r=0,n=0,i=0;e.digitalSignature&&(n|=128,r=7),e.nonRepudiation&&(n|=64,r=6),e.keyEncipherment&&(n|=32,r=5),e.dataEncipherment&&(n|=16,r=4),e.keyAgreement&&(n|=8,r=3),e.keyCertSign&&(n|=4,r=2),e.cRLSign&&(n|=2,r=1),e.encipherOnly&&(n|=1,r=0),e.decipherOnly&&(i|=128,r=7);var s=String.fromCharCode(r);i!==0?s+=String.fromCharCode(n)+String.fromCharCode(i):n!==0&&(s+=String.fromCharCode(n)),e.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,s)}else if(e.name==="basicConstraints")e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(e.pathLenConstraint).getBytes()));else if(e.name==="extKeyUsage"){e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var u=e.value.value;for(var f in e)e[f]===!0&&(f in ge?u.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(ge[f]).getBytes())):f.indexOf(".")!==-1&&u.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(f).getBytes())))}else if(e.name==="nsCertType"){var r=0,n=0;e.client&&(n|=128,r=7),e.server&&(n|=64,r=6),e.email&&(n|=32,r=5),e.objsign&&(n|=16,r=4),e.reserved&&(n|=8,r=3),e.sslCA&&(n|=4,r=2),e.emailCA&&(n|=2,r=1),e.objCA&&(n|=1,r=0);var s=String.fromCharCode(r);n!==0&&(s+=String.fromCharCode(n)),e.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,s)}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var c,d=0;d<e.altNames.length;++d){c=e.altNames[d];var s=c.value;if(c.type===7&&c.ip){if(s=J.util.bytesFromIP(c.ip),s===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=e,a}}else c.type===8&&(c.oid?s=y.oidToDer(y.oidToDer(c.oid)):s=y.oidToDer(s));e.value.value.push(y.create(y.Class.CONTEXT_SPECIFIC,c.type,!1,s))}}else if(e.name==="nsComment"&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=y.create(y.Class.UNIVERSAL,y.Type.IA5STRING,!1,e.comment)}else if(e.name==="subjectKeyIdentifier"&&t.cert){var h=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=h.toHex(),e.value=y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,h.getBytes())}else if(e.name==="authorityKeyIdentifier"&&t.cert){e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var u=e.value.value;if(e.keyIdentifier){var C=e.keyIdentifier===!0?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;u.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!1,C))}if(e.authorityCertIssuer){var E=[y.create(y.Class.CONTEXT_SPECIFIC,4,!0,[Wa(e.authorityCertIssuer===!0?t.cert.issuer:e.authorityCertIssuer)])];u.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,E))}if(e.serialNumber){var v=J.util.hexToBytes(e.serialNumber===!0?t.cert.serialNumber:e.serialNumber);u.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!1,v))}}else if(e.name==="cRLDistributionPoints"){e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var u=e.value.value,_=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),S=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]),c,d=0;d<e.altNames.length;++d){c=e.altNames[d];var s=c.value;if(c.type===7&&c.ip){if(s=J.util.bytesFromIP(c.ip),s===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=e,a}}else c.type===8&&(c.oid?s=y.oidToDer(y.oidToDer(c.oid)):s=y.oidToDer(s));S.value.push(y.create(y.Class.CONTEXT_SPECIFIC,c.type,!1,s))}_.value.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[S])),u.push(_)}if(typeof e.value=="undefined"){var a=new Error("Extension value not specified.");throw a.extension=e,a}return e}function Lo(e,t){switch(e){case ge["RSASSA-PSS"]:var a=[];return t.hash.algorithmOid!==void 0&&a.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])),t.mgf.algorithmOid!==void 0&&a.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.mgf.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.mgf.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])])),t.saltLength!==void 0&&a.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.saltLength).getBytes())])),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,a);default:return y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")}}function ig(e){var t=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]);if(e.attributes.length===0)return t;for(var a=e.attributes,r=0;r<a.length;++r){var n=a[r],i=n.value,s=y.Type.UTF8;"valueTagClass"in n&&(s=n.valueTagClass),s===y.Type.UTF8&&(i=J.util.encodeUtf8(i));var u=!1;"valueConstructed"in n&&(u=n.valueConstructed);var f=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(n.type).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,s,u,i)])]);t.value.push(f)}return t}var sg=new Date("1950-01-01T00:00:00Z"),og=new Date("2050-01-01T00:00:00Z");function _c(e){return e>=sg&&e<og?y.create(y.Class.UNIVERSAL,y.Type.UTCTIME,!1,y.dateToUtcTime(e)):y.create(y.Class.UNIVERSAL,y.Type.GENERALIZEDTIME,!1,y.dateToGeneralizedTime(e))}z.getTBSCertificate=function(e){var t=_c(e.validity.notBefore),a=_c(e.validity.notAfter),r=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(e.version).getBytes())]),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,J.util.hexToBytes(e.serialNumber)),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.siginfo.algorithmOid).getBytes()),Lo(e.siginfo.algorithmOid,e.siginfo.parameters)]),Wa(e.issuer),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[t,a]),Wa(e.subject),z.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&r.value.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&r.value.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&r.value.push(z.certificateExtensionsToAsn1(e.extensions)),r};z.getCertificationRequestInfo=function(e){var t=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(e.version).getBytes()),Wa(e.subject),z.publicKeyToAsn1(e.publicKey),ig(e)]);return t};z.distinguishedNameToAsn1=function(e){return Wa(e)};z.certificateToAsn1=function(e){var t=e.tbsCertificate||z.getTBSCertificate(e);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[t,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.signatureOid).getBytes()),Lo(e.signatureOid,e.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};z.certificateExtensionsToAsn1=function(e){var t=y.create(y.Class.CONTEXT_SPECIFIC,3,!0,[]),a=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);t.value.push(a);for(var r=0;r<e.length;++r)a.value.push(z.certificateExtensionToAsn1(e[r]));return t};z.certificateExtensionToAsn1=function(e){var t=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);t.value.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.id).getBytes())),e.critical&&t.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255)));var a=e.value;return typeof e.value!="string"&&(a=y.toDer(a).getBytes()),t.value.push(y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,a)),t};z.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||z.getCertificationRequestInfo(e);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[t,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.signatureOid).getBytes()),Lo(e.signatureOid,e.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};z.createCaStore=function(e){var t={certs:{}};t.getIssuer=function(s){var u=a(s.issuer);return u},t.addCertificate=function(s){if(typeof s=="string"&&(s=J.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))if(s.subject.hash in t.certs){var u=t.certs[s.subject.hash];J.util.isArray(u)||(u=[u]),u.push(s),t.certs[s.subject.hash]=u}else t.certs[s.subject.hash]=s},t.hasCertificate=function(s){typeof s=="string"&&(s=J.pki.certificateFromPem(s));var u=a(s.subject);if(!u)return!1;J.util.isArray(u)||(u=[u]);for(var f=y.toDer(z.certificateToAsn1(s)).getBytes(),c=0;c<u.length;++c){var d=y.toDer(z.certificateToAsn1(u[c])).getBytes();if(f===d)return!0}return!1},t.listAllCertificates=function(){var s=[];for(var u in t.certs)if(t.certs.hasOwnProperty(u)){var f=t.certs[u];if(!J.util.isArray(f))s.push(f);else for(var c=0;c<f.length;++c)s.push(f[c])}return s},t.removeCertificate=function(s){var u;if(typeof s=="string"&&(s=J.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))return null;var f=a(s.subject);if(!J.util.isArray(f))return u=t.certs[s.subject.hash],delete t.certs[s.subject.hash],u;for(var c=y.toDer(z.certificateToAsn1(s)).getBytes(),d=0;d<f.length;++d){var h=y.toDer(z.certificateToAsn1(f[d])).getBytes();c===h&&(u=f[d],f.splice(d,1))}return f.length===0&&delete t.certs[s.subject.hash],u};function a(s){return r(s),t.certs[s.hash]||null}function r(s){if(!s.hash){var u=J.md.sha1.create();s.attributes=z.RDNAttributesAsArray(Wa(s),u),s.hash=u.digest().toHex()}}if(e)for(var n=0;n<e.length;++n){var i=e[n];t.addCertificate(i)}return t};z.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};z.verifyCertificateChain=function(e,t,a){typeof a=="function"&&(a={verify:a}),a=a||{},t=t.slice(0);var r=t.slice(0),n=a.validityCheckDate;typeof n=="undefined"&&(n=new Date);var i=!0,s=null,u=0;do{var f=t.shift(),c=null,d=!1;if(n&&(n<f.validity.notBefore||n>f.validity.notAfter)&&(s={message:"Certificate is not valid yet or has expired.",error:z.certificateError.certificate_expired,notBefore:f.validity.notBefore,notAfter:f.validity.notAfter,now:n}),s===null){if(c=t[0]||e.getIssuer(f),c===null&&f.isIssuer(f)&&(d=!0,c=f),c){var h=c;J.util.isArray(h)||(h=[h]);for(var C=!1;!C&&h.length>0;){c=h.shift();try{C=c.verify(f)}catch{}}C||(s={message:"Certificate signature is invalid.",error:z.certificateError.bad_certificate})}s===null&&(!c||d)&&!e.hasCertificate(f)&&(s={message:"Certificate is not trusted.",error:z.certificateError.unknown_ca})}if(s===null&&c&&!f.isIssuer(c)&&(s={message:"Certificate issuer is invalid.",error:z.certificateError.bad_certificate}),s===null)for(var E={keyUsage:!0,basicConstraints:!0},v=0;s===null&&v<f.extensions.length;++v){var _=f.extensions[v];_.critical&&!(_.name in E)&&(s={message:"Certificate has an unsupported critical extension.",error:z.certificateError.unsupported_certificate})}if(s===null&&(!i||t.length===0&&(!c||d))){var S=f.getExtension("basicConstraints"),b=f.getExtension("keyUsage");if(b!==null&&(!b.keyCertSign||S===null)&&(s={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:z.certificateError.bad_certificate}),s===null&&S!==null&&!S.cA&&(s={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:z.certificateError.bad_certificate}),s===null&&b!==null&&"pathLenConstraint"in S){var A=u-1;A>S.pathLenConstraint&&(s={message:"Certificate basicConstraints pathLenConstraint violated.",error:z.certificateError.bad_certificate})}}var w=s===null?!0:s.error,P=a.verify?a.verify(w,u,r):w;if(P===!0)s=null;else throw w===!0&&(s={message:"The application rejected the certificate.",error:z.certificateError.bad_certificate}),(P||P===0)&&(typeof P=="object"&&!J.util.isArray(P)?(P.message&&(s.message=P.message),P.error&&(s.error=P.error)):typeof P=="string"&&(s.error=P)),s;i=!1,++u}while(t.length>0);return!0}});var Po=ae((n1,wc)=>{var ke=ue();Qt();Fa();Vr();Ro();wo();kt();Vn();Ka();me();os();var T=ke.asn1,fe=ke.pki,qn=wc.exports=ke.pkcs12=ke.pkcs12||{},Bc={name:"ContentInfo",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:T.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},ug={name:"PFX",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"version"},Bc,{name:"PFX.macData",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:T.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:T.Class.UNIVERSAL,type:T.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:T.Class.UNIVERSAL,type:T.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},lg={name:"SafeBag",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:T.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:T.Class.UNIVERSAL,type:T.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},fg={name:"Attribute",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:T.Class.UNIVERSAL,type:T.Type.SET,constructed:!0,capture:"values"}]},cg={name:"CertBag",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:T.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:T.Class.UNIVERSAL,type:T.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function Mn(e,t,a,r){for(var n=[],i=0;i<e.length;i++)for(var s=0;s<e[i].safeBags.length;s++){var u=e[i].safeBags[s];if(!(r!==void 0&&u.type!==r)){if(t===null){n.push(u);continue}u.attributes[t]!==void 0&&u.attributes[t].indexOf(a)>=0&&n.push(u)}}return n}qn.pkcs12FromAsn1=function(e,t,a){typeof t=="string"?(a=t,t=!0):t===void 0&&(t=!0);var r={},n=[];if(!T.validate(e,ug,r,n)){var i=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw i.errors=i,i}var s={version:r.version.charCodeAt(0),safeContents:[],getBags:function(S){var b={},A;return"localKeyId"in S?A=S.localKeyId:"localKeyIdHex"in S&&(A=ke.util.hexToBytes(S.localKeyIdHex)),A===void 0&&!("friendlyName"in S)&&"bagType"in S&&(b[S.bagType]=Mn(s.safeContents,null,null,S.bagType)),A!==void 0&&(b.localKeyId=Mn(s.safeContents,"localKeyId",A,S.bagType)),"friendlyName"in S&&(b.friendlyName=Mn(s.safeContents,"friendlyName",S.friendlyName,S.bagType)),b},getBagsByFriendlyName:function(S,b){return Mn(s.safeContents,"friendlyName",S,b)},getBagsByLocalKeyId:function(S,b){return Mn(s.safeContents,"localKeyId",S,b)}};if(r.version.charCodeAt(0)!==3){var i=new Error("PKCS#12 PFX of version other than 3 not supported.");throw i.version=r.version.charCodeAt(0),i}if(T.derToOid(r.contentType)!==fe.oids.data){var i=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw i.oid=T.derToOid(r.contentType),i}var u=r.content.value[0];if(u.tagClass!==T.Class.UNIVERSAL||u.type!==T.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(u=ko(u),r.mac){var f=null,c=0,d=T.derToOid(r.macAlgorithm);switch(d){case fe.oids.sha1:f=ke.md.sha1.create(),c=20;break;case fe.oids.sha256:f=ke.md.sha256.create(),c=32;break;case fe.oids.sha384:f=ke.md.sha384.create(),c=48;break;case fe.oids.sha512:f=ke.md.sha512.create(),c=64;break;case fe.oids.md5:f=ke.md.md5.create(),c=16;break}if(f===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+d);var h=new ke.util.ByteBuffer(r.macSalt),C="macIterations"in r?parseInt(ke.util.bytesToHex(r.macIterations),16):1,E=qn.generateKey(a,h,3,C,c,f),v=ke.hmac.create();v.start(f,E),v.update(u.value);var _=v.getMac();if(_.getBytes()!==r.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return dg(s,u.value,t,a),s};function ko(e){if(e.composed||e.constructed){for(var t=ke.util.createBuffer(),a=0;a<e.value.length;++a)t.putBytes(e.value[a].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function dg(e,t,a,r){if(t=T.fromDer(t,a),t.tagClass!==T.Class.UNIVERSAL||t.type!==T.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var n=0;n<t.value.length;n++){var i=t.value[n],s={},u=[];if(!T.validate(i,Bc,s,u)){var f=new Error("Cannot read ContentInfo.");throw f.errors=u,f}var c={encrypted:!1},d=null,h=s.content.value[0];switch(T.derToOid(s.contentType)){case fe.oids.data:if(h.tagClass!==T.Class.UNIVERSAL||h.type!==T.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");d=ko(h).value;break;case fe.oids.encryptedData:d=hg(h,r),c.encrypted=!0;break;default:var f=new Error("Unsupported PKCS#12 contentType.");throw f.contentType=T.derToOid(s.contentType),f}c.safeBags=pg(d,a,r),e.safeContents.push(c)}}function hg(e,t){var a={},r=[];if(!T.validate(e,ke.pkcs7.asn1.encryptedDataValidator,a,r)){var n=new Error("Cannot read EncryptedContentInfo.");throw n.errors=r,n}var i=T.derToOid(a.contentType);if(i!==fe.oids.data){var n=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw n.oid=i,n}i=T.derToOid(a.encAlgorithm);var s=fe.pbe.getCipher(i,a.encParameter,t),u=ko(a.encryptedContentAsn1),f=ke.util.createBuffer(u.value);if(s.update(f),!s.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return s.output.getBytes()}function pg(e,t,a){if(!t&&e.length===0)return[];if(e=T.fromDer(e,t),e.tagClass!==T.Class.UNIVERSAL||e.type!==T.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var r=[],n=0;n<e.value.length;n++){var i=e.value[n],s={},u=[];if(!T.validate(i,lg,s,u)){var f=new Error("Cannot read SafeBag.");throw f.errors=u,f}var c={type:T.derToOid(s.bagId),attributes:yg(s.bagAttributes)};r.push(c);var d,h,C=s.bagValue.value[0];switch(c.type){case fe.oids.pkcs8ShroudedKeyBag:if(C=fe.decryptPrivateKeyInfo(C,a),C===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case fe.oids.keyBag:try{c.key=fe.privateKeyFromAsn1(C)}catch{c.key=null,c.asn1=C}continue;case fe.oids.certBag:d=cg,h=function(){if(T.derToOid(s.certId)!==fe.oids.x509Certificate){var v=new Error("Unsupported certificate type, only X.509 supported.");throw v.oid=T.derToOid(s.certId),v}var _=T.fromDer(s.cert,t);try{c.cert=fe.certificateFromAsn1(_,!0)}catch{c.cert=null,c.asn1=_}};break;default:var f=new Error("Unsupported PKCS#12 SafeBag type.");throw f.oid=c.type,f}if(d!==void 0&&!T.validate(C,d,s,u)){var f=new Error("Cannot read PKCS#12 "+d.name);throw f.errors=u,f}h()}return r}function yg(e){var t={};if(e!==void 0)for(var a=0;a<e.length;++a){var r={},n=[];if(!T.validate(e[a],fg,r,n)){var i=new Error("Cannot read PKCS#12 BagAttribute.");throw i.errors=n,i}var s=T.derToOid(r.oid);if(fe.oids[s]!==void 0){t[fe.oids[s]]=[];for(var u=0;u<r.values.length;++u)t[fe.oids[s]].push(r.values[u].value)}}return t}qn.toPkcs12Asn1=function(e,t,a,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||r.encAlgorithm||"aes128","useMac"in r||(r.useMac=!0),"localKeyId"in r||(r.localKeyId=null),"generateLocalKeyId"in r||(r.generateLocalKeyId=!0);var n=r.localKeyId,i;if(n!==null)n=ke.util.hexToBytes(n);else if(r.generateLocalKeyId)if(t){var s=ke.util.isArray(t)?t[0]:t;typeof s=="string"&&(s=fe.certificateFromPem(s));var u=ke.md.sha1.create();u.update(T.toDer(fe.certificateToAsn1(s)).getBytes()),n=u.digest().getBytes()}else n=ke.random.getBytes(20);var f=[];n!==null&&f.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.localKeyId).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,n)])])),"friendlyName"in r&&f.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.friendlyName).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[T.create(T.Class.UNIVERSAL,T.Type.BMPSTRING,!1,r.friendlyName)])])),f.length>0&&(i=T.create(T.Class.UNIVERSAL,T.Type.SET,!0,f));var c=[],d=[];t!==null&&(ke.util.isArray(t)?d=t:d=[t]);for(var h=[],C=0;C<d.length;++C){t=d[C],typeof t=="string"&&(t=fe.certificateFromPem(t));var E=C===0?i:void 0,v=fe.certificateToAsn1(t),_=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.certBag).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.x509Certificate).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(v).getBytes())])])]),E]);h.push(_)}if(h.length>0){var S=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,h),b=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.data).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(S).getBytes())])]);c.push(b)}var A=null;if(e!==null){var w=fe.wrapRsaPrivateKey(fe.privateKeyToAsn1(e));a===null?A=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.keyBag).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[w]),i]):A=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.pkcs8ShroudedKeyBag).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[fe.encryptPrivateKeyInfo(w,a,r)]),i]);var P=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[A]),k=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.data).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(P).getBytes())])]);c.push(k)}var N=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,c),G;if(r.useMac){var u=ke.md.sha1.create(),q=new ke.util.ByteBuffer(ke.random.getBytes(r.saltSize)),Y=r.count,e=qn.generateKey(a,q,3,Y,20),H=ke.hmac.create();H.start(u,e),H.update(T.toDer(N).getBytes());var re=H.getMac();G=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.sha1).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")]),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,re.getBytes())]),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,q.getBytes()),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(Y).getBytes())])}return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(3).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.data).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(N).getBytes())])]),G])};qn.generateKey=ke.pbe.generatePkcs12Key});var Uo=ae((i1,Rc)=>{var Hr=ue();Qt();Vr();wo();sa();Xi();Po();ns();Vn();me();os();var Do=Hr.asn1,Ga=Rc.exports=Hr.pki=Hr.pki||{};Ga.pemToDer=function(e){var t=Hr.pem.decode(e)[0];if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Hr.util.createBuffer(t.body)};Ga.privateKeyFromPem=function(e){var t=Hr.pem.decode(e)[0];if(t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var a=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var r=Do.fromDer(t.body);return Ga.privateKeyFromAsn1(r)};Ga.privateKeyToPem=function(e,t){var a={type:"RSA PRIVATE KEY",body:Do.toDer(Ga.privateKeyToAsn1(e)).getBytes()};return Hr.pem.encode(a,{maxline:t})};Ga.privateKeyInfoToPem=function(e,t){var a={type:"PRIVATE KEY",body:Do.toDer(e).getBytes()};return Hr.pem.encode(a,{maxline:t})}});var Ko=ae((s1,Fc)=>{var V=ue();Qt();Fa();Qi();sa();Uo();kt();Ka();me();var us=function(e,t,a,r){var n=V.util.createBuffer(),i=e.length>>1,s=i+(e.length&1),u=e.substr(0,s),f=e.substr(i,s),c=V.util.createBuffer(),d=V.hmac.create();a=t+a;var h=Math.ceil(r/16),C=Math.ceil(r/20);d.start("MD5",u);var E=V.util.createBuffer();c.putBytes(a);for(var v=0;v<h;++v)d.start(null,null),d.update(c.getBytes()),c.putBuffer(d.digest()),d.start(null,null),d.update(c.bytes()+a),E.putBuffer(d.digest());d.start("SHA1",f);var _=V.util.createBuffer();c.clear(),c.putBytes(a);for(var v=0;v<C;++v)d.start(null,null),d.update(c.getBytes()),c.putBuffer(d.digest()),d.start(null,null),d.update(c.bytes()+a),_.putBuffer(d.digest());return n.putBytes(V.util.xorBytes(E.getBytes(),_.getBytes(),r)),n},gg=function(e,t,a){var r=V.hmac.create();r.start("SHA1",e);var n=V.util.createBuffer();return n.putInt32(t[0]),n.putInt32(t[1]),n.putByte(a.type),n.putByte(a.version.major),n.putByte(a.version.minor),n.putInt16(a.length),n.putBytes(a.fragment.bytes()),r.update(n.getBytes()),r.digest().getBytes()},mg=function(e,t,a){var r=!1;try{var n=e.deflate(t.fragment.getBytes());t.fragment=V.util.createBuffer(n),t.length=n.length,r=!0}catch{}return r},vg=function(e,t,a){var r=!1;try{var n=e.inflate(t.fragment.getBytes());t.fragment=V.util.createBuffer(n),t.length=n.length,r=!0}catch{}return r},_t=function(e,t){var a=0;switch(t){case 1:a=e.getByte();break;case 2:a=e.getInt16();break;case 3:a=e.getInt24();break;case 4:a=e.getInt32();break}return V.util.createBuffer(e.getBytes(a))},Ot=function(e,t,a){e.putInt(a.length(),t<<3),e.putBuffer(a)},m={};m.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};m.SupportedVersions=[m.Versions.TLS_1_1,m.Versions.TLS_1_0];m.Version=m.SupportedVersions[0];m.MaxFragment=16384-1024;m.ConnectionEnd={server:0,client:1};m.PRFAlgorithm={tls_prf_sha256:0};m.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};m.CipherType={stream:0,block:1,aead:2};m.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};m.CompressionMethod={none:0,deflate:1};m.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};m.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};m.Alert={};m.Alert.Level={warning:1,fatal:2};m.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};m.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};m.CipherSuites={};m.getCipherSuite=function(e){var t=null;for(var a in m.CipherSuites){var r=m.CipherSuites[a];if(r.id[0]===e.charCodeAt(0)&&r.id[1]===e.charCodeAt(1)){t=r;break}}return t};m.handleUnexpected=function(e,t){var a=!e.open&&e.entity===m.ConnectionEnd.client;a||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.unexpected_message}})};m.handleHelloRequest=function(e,t,a){!e.handshaking&&e.handshakes>0&&(m.queue(e,m.createAlert(e,{level:m.Alert.Level.warning,description:m.Alert.Description.no_renegotiation})),m.flush(e)),e.process()};m.parseHelloMessage=function(e,t,a){var r=null,n=e.entity===m.ConnectionEnd.client;if(a<38)e.error(e,{message:n?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.illegal_parameter}});else{var i=t.fragment,s=i.length();if(r={version:{major:i.getByte(),minor:i.getByte()},random:V.util.createBuffer(i.getBytes(32)),session_id:_t(i,1),extensions:[]},n?(r.cipher_suite=i.getBytes(2),r.compression_method=i.getByte()):(r.cipher_suites=_t(i,2),r.compression_methods=_t(i,1)),s=a-(s-i.length()),s>0){for(var u=_t(i,2);u.length()>0;)r.extensions.push({type:[u.getByte(),u.getByte()],data:_t(u,2)});if(!n)for(var f=0;f<r.extensions.length;++f){var c=r.extensions[f];if(c.type[0]===0&&c.type[1]===0)for(var d=_t(c.data,2);d.length()>0;){var h=d.getByte();if(h!==0)break;e.session.extensions.server_name.serverNameList.push(_t(d,2).getBytes())}}}if(e.session.version&&(r.version.major!==e.session.version.major||r.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.protocol_version}});if(n)e.session.cipherSuite=m.getCipherSuite(r.cipher_suite);else for(var C=V.util.createBuffer(r.cipher_suites.bytes());C.length()>0&&(e.session.cipherSuite=m.getCipherSuite(C.getBytes(2)),e.session.cipherSuite===null););if(e.session.cipherSuite===null)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.handshake_failure},cipherSuite:V.util.bytesToHex(r.cipher_suite)});n?e.session.compressionMethod=r.compression_method:e.session.compressionMethod=m.CompressionMethod.none}return r};m.createSecurityParameters=function(e,t){var a=e.entity===m.ConnectionEnd.client,r=t.random.bytes(),n=a?e.session.sp.client_random:r,i=a?r:m.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:m.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:n,server_random:i}};m.handleServerHello=function(e,t,a){var r=m.parseHelloMessage(e,t,a);if(!e.fail){if(r.version.minor<=e.version.minor)e.version.minor=r.version.minor;else return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.protocol_version}});e.session.version=e.version;var n=r.session_id.bytes();n.length>0&&n===e.session.id?(e.expect=Lc,e.session.resuming=!0,e.session.sp.server_random=r.random.bytes()):(e.expect=Sg,e.session.resuming=!1,m.createSecurityParameters(e,r)),e.session.id=n,e.process()}};m.handleClientHello=function(e,t,a){var r=m.parseHelloMessage(e,t,a);if(!e.fail){var n=r.session_id.bytes(),i=null;if(e.sessionCache&&(i=e.sessionCache.getSession(n),i===null?n="":(i.version.major!==r.version.major||i.version.minor>r.version.minor)&&(i=null,n="")),n.length===0&&(n=V.random.getBytes(32)),e.session.id=n,e.session.clientHelloVersion=r.version,e.session.sp={},i)e.version=e.session.version=i.version,e.session.sp=i.sp;else{for(var s,u=1;u<m.SupportedVersions.length&&(s=m.SupportedVersions[u],!(s.minor<=r.version.minor));++u);e.version={major:s.major,minor:s.minor},e.session.version=e.version}i!==null?(e.expect=Fo,e.session.resuming=!0,e.session.sp.client_random=r.random.bytes()):(e.expect=e.verifyClient!==!1?Ig:Oo,e.session.resuming=!1,m.createSecurityParameters(e,r)),e.open=!0,m.queue(e,m.createRecord(e,{type:m.ContentType.handshake,data:m.createServerHello(e)})),e.session.resuming?(m.queue(e,m.createRecord(e,{type:m.ContentType.change_cipher_spec,data:m.createChangeCipherSpec()})),e.state.pending=m.createConnectionState(e),e.state.current.write=e.state.pending.write,m.queue(e,m.createRecord(e,{type:m.ContentType.handshake,data:m.createFinished(e)}))):(m.queue(e,m.createRecord(e,{type:m.ContentType.handshake,data:m.createCertificate(e)})),e.fail||(m.queue(e,m.createRecord(e,{type:m.ContentType.handshake,data:m.createServerKeyExchange(e)})),e.verifyClient!==!1&&m.queue(e,m.createRecord(e,{type:m.ContentType.handshake,data:m.createCertificateRequest(e)})),m.queue(e,m.createRecord(e,{type:m.ContentType.handshake,data:m.createServerHelloDone(e)})))),m.flush(e),e.process()}};m.handleCertificate=function(e,t,a){if(a<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.illegal_parameter}});var r=t.fragment,n={certificate_list:_t(r,3)},i,s,u=[];try{for(;n.certificate_list.length()>0;)i=_t(n.certificate_list,3),s=V.asn1.fromDer(i),i=V.pki.certificateFromAsn1(s,!0),u.push(i)}catch(c){return e.error(e,{message:"Could not parse certificate list.",cause:c,send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.bad_certificate}})}var f=e.entity===m.ConnectionEnd.client;(f||e.verifyClient===!0)&&u.length===0?e.error(e,{message:f?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.illegal_parameter}}):u.length===0?e.expect=f?Nc:Oo:(f?e.session.serverCertificate=u[0]:e.session.clientCertificate=u[0],m.verifyCertificateChain(e,u)&&(e.expect=f?Nc:Oo)),e.process()};m.handleServerKeyExchange=function(e,t,a){if(a>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.unsupported_certificate}});e.expect=Eg,e.process()};m.handleClientKeyExchange=function(e,t,a){if(a<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.unsupported_certificate}});var r=t.fragment,n={enc_pre_master_secret:_t(r,2).getBytes()},i=null;if(e.getPrivateKey)try{i=e.getPrivateKey(e,e.session.serverCertificate),i=V.pki.privateKeyFromPem(i)}catch(f){e.error(e,{message:"Could not get private key.",cause:f,send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.internal_error}})}if(i===null)return e.error(e,{message:"No private key set.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.internal_error}});try{var s=e.session.sp;s.pre_master_secret=i.decrypt(n.enc_pre_master_secret);var u=e.session.clientHelloVersion;if(u.major!==s.pre_master_secret.charCodeAt(0)||u.minor!==s.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{s.pre_master_secret=V.random.getBytes(48)}e.expect=Fo,e.session.clientCertificate!==null&&(e.expect=Bg),e.process()};m.handleCertificateRequest=function(e,t,a){if(a<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.illegal_parameter}});var r=t.fragment,n={certificate_types:_t(r,1),certificate_authorities:_t(r,2)};e.session.certificateRequest=n,e.expect=bg,e.process()};m.handleCertificateVerify=function(e,t,a){if(a<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.illegal_parameter}});var r=t.fragment;r.read-=4;var n=r.bytes();r.read+=4;var i={signature:_t(r,2).getBytes()},s=V.util.createBuffer();s.putBuffer(e.session.md5.digest()),s.putBuffer(e.session.sha1.digest()),s=s.getBytes();try{var u=e.session.clientCertificate;if(!u.publicKey.verify(s,i.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(n),e.session.sha1.update(n)}catch{return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.handshake_failure}})}e.expect=Fo,e.process()};m.handleServerHelloDone=function(e,t,a){if(a>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.record_overflow}});if(e.serverCertificate===null){var r={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.insufficient_security}},n=0,i=e.verify(e,r.alert.description,n,[]);if(i!==!0)return(i||i===0)&&(typeof i=="object"&&!V.util.isArray(i)?(i.message&&(r.message=i.message),i.alert&&(r.alert.description=i.alert)):typeof i=="number"&&(r.alert.description=i)),e.error(e,r)}e.session.certificateRequest!==null&&(t=m.createRecord(e,{type:m.ContentType.handshake,data:m.createCertificate(e)}),m.queue(e,t)),t=m.createRecord(e,{type:m.ContentType.handshake,data:m.createClientKeyExchange(e)}),m.queue(e,t),e.expect=Ag;var s=function(u,f){u.session.certificateRequest!==null&&u.session.clientCertificate!==null&&m.queue(u,m.createRecord(u,{type:m.ContentType.handshake,data:m.createCertificateVerify(u,f)})),m.queue(u,m.createRecord(u,{type:m.ContentType.change_cipher_spec,data:m.createChangeCipherSpec()})),u.state.pending=m.createConnectionState(u),u.state.current.write=u.state.pending.write,m.queue(u,m.createRecord(u,{type:m.ContentType.handshake,data:m.createFinished(u)})),u.expect=Lc,m.flush(u),u.process()};if(e.session.certificateRequest===null||e.session.clientCertificate===null)return s(e,null);m.getClientSignature(e,s)};m.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1)return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.illegal_parameter}});var a=e.entity===m.ConnectionEnd.client;(e.session.resuming&&a||!e.session.resuming&&!a)&&(e.state.pending=m.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&a||e.session.resuming&&!a)&&(e.state.pending=null),e.expect=a?xg:wg,e.process()};m.handleFinished=function(e,t,a){var r=t.fragment;r.read-=4;var n=r.bytes();r.read+=4;var i=t.fragment.getBytes();r=V.util.createBuffer(),r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest());var s=e.entity===m.ConnectionEnd.client,u=s?"server finished":"client finished",f=e.session.sp,c=12,d=us;if(r=d(f.master_secret,u,r.getBytes(),c),r.getBytes()!==i)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.decrypt_error}});e.session.md5.update(n),e.session.sha1.update(n),(e.session.resuming&&s||!e.session.resuming&&!s)&&(m.queue(e,m.createRecord(e,{type:m.ContentType.change_cipher_spec,data:m.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,m.queue(e,m.createRecord(e,{type:m.ContentType.handshake,data:m.createFinished(e)}))),e.expect=s?Tg:Rg,e.handshaking=!1,++e.handshakes,e.peerCertificate=s?e.session.serverCertificate:e.session.clientCertificate,m.flush(e),e.isConnected=!0,e.connected(e),e.process()};m.handleAlert=function(e,t){var a=t.fragment,r={level:a.getByte(),description:a.getByte()},n;switch(r.description){case m.Alert.Description.close_notify:n="Connection closed.";break;case m.Alert.Description.unexpected_message:n="Unexpected message.";break;case m.Alert.Description.bad_record_mac:n="Bad record MAC.";break;case m.Alert.Description.decryption_failed:n="Decryption failed.";break;case m.Alert.Description.record_overflow:n="Record overflow.";break;case m.Alert.Description.decompression_failure:n="Decompression failed.";break;case m.Alert.Description.handshake_failure:n="Handshake failure.";break;case m.Alert.Description.bad_certificate:n="Bad certificate.";break;case m.Alert.Description.unsupported_certificate:n="Unsupported certificate.";break;case m.Alert.Description.certificate_revoked:n="Certificate revoked.";break;case m.Alert.Description.certificate_expired:n="Certificate expired.";break;case m.Alert.Description.certificate_unknown:n="Certificate unknown.";break;case m.Alert.Description.illegal_parameter:n="Illegal parameter.";break;case m.Alert.Description.unknown_ca:n="Unknown certificate authority.";break;case m.Alert.Description.access_denied:n="Access denied.";break;case m.Alert.Description.decode_error:n="Decode error.";break;case m.Alert.Description.decrypt_error:n="Decrypt error.";break;case m.Alert.Description.export_restriction:n="Export restriction.";break;case m.Alert.Description.protocol_version:n="Unsupported protocol version.";break;case m.Alert.Description.insufficient_security:n="Insufficient security.";break;case m.Alert.Description.internal_error:n="Internal error.";break;case m.Alert.Description.user_canceled:n="User canceled.";break;case m.Alert.Description.no_renegotiation:n="Renegotiation not supported.";break;default:n="Unknown error.";break}if(r.description===m.Alert.Description.close_notify)return e.close();e.error(e,{message:n,send:!1,origin:e.entity===m.ConnectionEnd.client?"server":"client",alert:r}),e.process()};m.handleHandshake=function(e,t){var a=t.fragment,r=a.getByte(),n=a.getInt24();if(n>a.length())return e.fragmented=t,t.fragment=V.util.createBuffer(),a.read-=4,e.process();e.fragmented=null,a.read-=4;var i=a.bytes(n+4);a.read+=4,r in fs[e.entity][e.expect]?(e.entity===m.ConnectionEnd.server&&!e.open&&!e.fail&&(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:V.md.md5.create(),sha1:V.md.sha1.create()}),r!==m.HandshakeType.hello_request&&r!==m.HandshakeType.certificate_verify&&r!==m.HandshakeType.finished&&(e.session.md5.update(i),e.session.sha1.update(i)),fs[e.entity][e.expect][r](e,t,n)):m.handleUnexpected(e,t)};m.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()};m.handleHeartbeat=function(e,t){var a=t.fragment,r=a.getByte(),n=a.getInt16(),i=a.getBytes(n);if(r===m.HeartbeatMessageType.heartbeat_request){if(e.handshaking||n>i.length)return e.process();m.queue(e,m.createRecord(e,{type:m.ContentType.heartbeat,data:m.createHeartbeat(m.HeartbeatMessageType.heartbeat_response,i)})),m.flush(e)}else if(r===m.HeartbeatMessageType.heartbeat_response){if(i!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,V.util.createBuffer(i))}e.process()};var Cg=0,Sg=1,Nc=2,Eg=3,bg=4,Lc=5,xg=6,Tg=7,Ag=8,_g=0,Ig=1,Oo=2,Bg=3,Fo=4,wg=5,Rg=6,g=m.handleUnexpected,kc=m.handleChangeCipherSpec,ut=m.handleAlert,yt=m.handleHandshake,Pc=m.handleApplicationData,lt=m.handleHeartbeat,Vo=[];Vo[m.ConnectionEnd.client]=[[g,ut,yt,g,lt],[g,ut,yt,g,lt],[g,ut,yt,g,lt],[g,ut,yt,g,lt],[g,ut,yt,g,lt],[kc,ut,g,g,lt],[g,ut,yt,g,lt],[g,ut,yt,Pc,lt],[g,ut,yt,g,lt]];Vo[m.ConnectionEnd.server]=[[g,ut,yt,g,lt],[g,ut,yt,g,lt],[g,ut,yt,g,lt],[g,ut,yt,g,lt],[kc,ut,g,g,lt],[g,ut,yt,g,lt],[g,ut,yt,Pc,lt],[g,ut,yt,g,lt]];var zr=m.handleHelloRequest,Ng=m.handleServerHello,Dc=m.handleCertificate,Uc=m.handleServerKeyExchange,qo=m.handleCertificateRequest,ls=m.handleServerHelloDone,Oc=m.handleFinished,fs=[];fs[m.ConnectionEnd.client]=[[g,g,Ng,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[zr,g,g,g,g,g,g,g,g,g,g,Dc,Uc,qo,ls,g,g,g,g,g,g],[zr,g,g,g,g,g,g,g,g,g,g,g,Uc,qo,ls,g,g,g,g,g,g],[zr,g,g,g,g,g,g,g,g,g,g,g,g,qo,ls,g,g,g,g,g,g],[zr,g,g,g,g,g,g,g,g,g,g,g,g,g,ls,g,g,g,g,g,g],[zr,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[zr,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,Oc],[zr,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[zr,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g]];var Lg=m.handleClientHello,kg=m.handleClientKeyExchange,Pg=m.handleCertificateVerify;fs[m.ConnectionEnd.server]=[[g,Lg,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,Dc,g,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,kg,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,Pg,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,Oc],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g]];m.generateKeys=function(e,t){var a=us,r=t.client_random+t.server_random;e.session.resuming||(t.master_secret=a(t.pre_master_secret,"master secret",r,48).bytes(),t.pre_master_secret=null),r=t.server_random+t.client_random;var n=2*t.mac_key_length+2*t.enc_key_length,i=e.version.major===m.Versions.TLS_1_0.major&&e.version.minor===m.Versions.TLS_1_0.minor;i&&(n+=2*t.fixed_iv_length);var s=a(t.master_secret,"key expansion",r,n),u={client_write_MAC_key:s.getBytes(t.mac_key_length),server_write_MAC_key:s.getBytes(t.mac_key_length),client_write_key:s.getBytes(t.enc_key_length),server_write_key:s.getBytes(t.enc_key_length)};return i&&(u.client_write_IV=s.getBytes(t.fixed_iv_length),u.server_write_IV=s.getBytes(t.fixed_iv_length)),u};m.createConnectionState=function(e){var t=e.entity===m.ConnectionEnd.client,a=function(){var i={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(s){return!0},compressionState:null,compressFunction:function(s){return!0},updateSequenceNumber:function(){i.sequenceNumber[1]===4294967295?(i.sequenceNumber[1]=0,++i.sequenceNumber[0]):++i.sequenceNumber[1]}};return i},r={read:a(),write:a()};if(r.read.update=function(i,s){return r.read.cipherFunction(s,r.read)?r.read.compressFunction(i,s,r.read)||i.error(i,{message:"Could not decompress record.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.decompression_failure}}):i.error(i,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.bad_record_mac}}),!i.fail},r.write.update=function(i,s){return r.write.compressFunction(i,s,r.write)?r.write.cipherFunction(s,r.write)||i.error(i,{message:"Could not encrypt record.",send:!1,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.internal_error}}):i.error(i,{message:"Could not compress record.",send:!1,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.internal_error}}),!i.fail},e.session){var n=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(n),n.keys=m.generateKeys(e,n),r.read.macKey=t?n.keys.server_write_MAC_key:n.keys.client_write_MAC_key,r.write.macKey=t?n.keys.client_write_MAC_key:n.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(r,e,n),n.compression_algorithm){case m.CompressionMethod.none:break;case m.CompressionMethod.deflate:r.read.compressFunction=vg,r.write.compressFunction=mg;break;default:throw new Error("Unsupported compression algorithm.")}}return r};m.createRandom=function(){var e=new Date,t=+e+e.getTimezoneOffset()*6e4,a=V.util.createBuffer();return a.putInt32(t),a.putBytes(V.random.getBytes(28)),a};m.createRecord=function(e,t){if(!t.data)return null;var a={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return a};m.createAlert=function(e,t){var a=V.util.createBuffer();return a.putByte(t.level),a.putByte(t.description),m.createRecord(e,{type:m.ContentType.alert,data:a})};m.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=V.util.createBuffer(),a=0;a<e.cipherSuites.length;++a){var r=e.cipherSuites[a];t.putByte(r.id[0]),t.putByte(r.id[1])}var n=t.length(),i=V.util.createBuffer();i.putByte(m.CompressionMethod.none);var s=i.length(),u=V.util.createBuffer();if(e.virtualHost){var f=V.util.createBuffer();f.putByte(0),f.putByte(0);var c=V.util.createBuffer();c.putByte(0),Ot(c,2,V.util.createBuffer(e.virtualHost));var d=V.util.createBuffer();Ot(d,2,c),Ot(f,2,d),u.putBuffer(f)}var h=u.length();h>0&&(h+=2);var C=e.session.id,E=C.length+1+2+4+28+2+n+1+s+h,v=V.util.createBuffer();return v.putByte(m.HandshakeType.client_hello),v.putInt24(E),v.putByte(e.version.major),v.putByte(e.version.minor),v.putBytes(e.session.sp.client_random),Ot(v,1,V.util.createBuffer(C)),Ot(v,2,t),Ot(v,1,i),h>0&&Ot(v,2,u),v};m.createServerHello=function(e){var t=e.session.id,a=t.length+1+2+4+28+2+1,r=V.util.createBuffer();return r.putByte(m.HandshakeType.server_hello),r.putInt24(a),r.putByte(e.version.major),r.putByte(e.version.minor),r.putBytes(e.session.sp.server_random),Ot(r,1,V.util.createBuffer(t)),r.putByte(e.session.cipherSuite.id[0]),r.putByte(e.session.cipherSuite.id[1]),r.putByte(e.session.compressionMethod),r};m.createCertificate=function(e){var t=e.entity===m.ConnectionEnd.client,a=null;if(e.getCertificate){var r;t?r=e.session.certificateRequest:r=e.session.extensions.server_name.serverNameList,a=e.getCertificate(e,r)}var n=V.util.createBuffer();if(a!==null)try{V.util.isArray(a)||(a=[a]);for(var i=null,s=0;s<a.length;++s){var u=V.pem.decode(a[s])[0];if(u.type!=="CERTIFICATE"&&u.type!=="X509 CERTIFICATE"&&u.type!=="TRUSTED CERTIFICATE"){var f=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw f.headerType=u.type,f}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=V.util.createBuffer(u.body);i===null&&(i=V.asn1.fromDer(c.bytes(),!1));var d=V.util.createBuffer();Ot(d,3,c),n.putBuffer(d)}a=V.pki.certificateFromAsn1(i),t?e.session.clientCertificate=a:e.session.serverCertificate=a}catch(E){return e.error(e,{message:"Could not send certificate list.",cause:E,send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.bad_certificate}})}var h=3+n.length(),C=V.util.createBuffer();return C.putByte(m.HandshakeType.certificate),C.putInt24(h),Ot(C,3,n),C};m.createClientKeyExchange=function(e){var t=V.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(V.random.getBytes(46));var a=e.session.sp;a.pre_master_secret=t.getBytes();var r=e.session.serverCertificate.publicKey;t=r.encrypt(a.pre_master_secret);var n=t.length+2,i=V.util.createBuffer();return i.putByte(m.HandshakeType.client_key_exchange),i.putInt24(n),i.putInt16(t.length),i.putBytes(t),i};m.createServerKeyExchange=function(e){var t=0,a=V.util.createBuffer();return t>0&&(a.putByte(m.HandshakeType.server_key_exchange),a.putInt24(t)),a};m.getClientSignature=function(e,t){var a=V.util.createBuffer();a.putBuffer(e.session.md5.digest()),a.putBuffer(e.session.sha1.digest()),a=a.getBytes(),e.getSignature=e.getSignature||function(r,n,i){var s=null;if(r.getPrivateKey)try{s=r.getPrivateKey(r,r.session.clientCertificate),s=V.pki.privateKeyFromPem(s)}catch(u){r.error(r,{message:"Could not get private key.",cause:u,send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.internal_error}})}s===null?r.error(r,{message:"No private key set.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.internal_error}}):n=s.sign(n,null),i(r,n)},e.getSignature(e,a,t)};m.createCertificateVerify=function(e,t){var a=t.length+2,r=V.util.createBuffer();return r.putByte(m.HandshakeType.certificate_verify),r.putInt24(a),r.putInt16(t.length),r.putBytes(t),r};m.createCertificateRequest=function(e){var t=V.util.createBuffer();t.putByte(1);var a=V.util.createBuffer();for(var r in e.caStore.certs){var n=e.caStore.certs[r],i=V.pki.distinguishedNameToAsn1(n.subject),s=V.asn1.toDer(i);a.putInt16(s.length()),a.putBuffer(s)}var u=1+t.length()+2+a.length(),f=V.util.createBuffer();return f.putByte(m.HandshakeType.certificate_request),f.putInt24(u),Ot(f,1,t),Ot(f,2,a),f};m.createServerHelloDone=function(e){var t=V.util.createBuffer();return t.putByte(m.HandshakeType.server_hello_done),t.putInt24(0),t};m.createChangeCipherSpec=function(){var e=V.util.createBuffer();return e.putByte(1),e};m.createFinished=function(e){var t=V.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var a=e.entity===m.ConnectionEnd.client,r=e.session.sp,n=12,i=us,s=a?"client finished":"server finished";t=i(r.master_secret,s,t.getBytes(),n);var u=V.util.createBuffer();return u.putByte(m.HandshakeType.finished),u.putInt24(t.length()),u.putBuffer(t),u};m.createHeartbeat=function(e,t,a){typeof a=="undefined"&&(a=t.length);var r=V.util.createBuffer();r.putByte(e),r.putInt16(a),r.putBytes(t);var n=r.length(),i=Math.max(16,n-a-3);return r.putBytes(V.random.getBytes(i)),r};m.queue=function(e,t){if(!!t&&!(t.fragment.length()===0&&(t.type===m.ContentType.handshake||t.type===m.ContentType.alert||t.type===m.ContentType.change_cipher_spec))){if(t.type===m.ContentType.handshake){var a=t.fragment.bytes();e.session.md5.update(a),e.session.sha1.update(a),a=null}var r;if(t.fragment.length()<=m.MaxFragment)r=[t];else{r=[];for(var n=t.fragment.bytes();n.length>m.MaxFragment;)r.push(m.createRecord(e,{type:t.type,data:V.util.createBuffer(n.slice(0,m.MaxFragment))})),n=n.slice(m.MaxFragment);n.length>0&&r.push(m.createRecord(e,{type:t.type,data:V.util.createBuffer(n)}))}for(var i=0;i<r.length&&!e.fail;++i){var s=r[i],u=e.state.current.write;u.update(e,s)&&e.records.push(s)}}};m.flush=function(e){for(var t=0;t<e.records.length;++t){var a=e.records[t];e.tlsData.putByte(a.type),e.tlsData.putByte(a.version.major),e.tlsData.putByte(a.version.minor),e.tlsData.putInt16(a.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var Mo=function(e){switch(e){case!0:return!0;case V.pki.certificateError.bad_certificate:return m.Alert.Description.bad_certificate;case V.pki.certificateError.unsupported_certificate:return m.Alert.Description.unsupported_certificate;case V.pki.certificateError.certificate_revoked:return m.Alert.Description.certificate_revoked;case V.pki.certificateError.certificate_expired:return m.Alert.Description.certificate_expired;case V.pki.certificateError.certificate_unknown:return m.Alert.Description.certificate_unknown;case V.pki.certificateError.unknown_ca:return m.Alert.Description.unknown_ca;default:return m.Alert.Description.bad_certificate}},Dg=function(e){switch(e){case!0:return!0;case m.Alert.Description.bad_certificate:return V.pki.certificateError.bad_certificate;case m.Alert.Description.unsupported_certificate:return V.pki.certificateError.unsupported_certificate;case m.Alert.Description.certificate_revoked:return V.pki.certificateError.certificate_revoked;case m.Alert.Description.certificate_expired:return V.pki.certificateError.certificate_expired;case m.Alert.Description.certificate_unknown:return V.pki.certificateError.certificate_unknown;case m.Alert.Description.unknown_ca:return V.pki.certificateError.unknown_ca;default:return V.pki.certificateError.bad_certificate}};m.verifyCertificateChain=function(e,t){try{var a={};for(var r in e.verifyOptions)a[r]=e.verifyOptions[r];a.verify=function(i,s,u){var f=Mo(i),c=e.verify(e,i,s,u);if(c!==!0){if(typeof c=="object"&&!V.util.isArray(c)){var d=new Error("The application rejected the certificate.");throw d.send=!0,d.alert={level:m.Alert.Level.fatal,description:m.Alert.Description.bad_certificate},c.message&&(d.message=c.message),c.alert&&(d.alert.description=c.alert),d}c!==i&&(c=Dg(c))}return c},V.pki.verifyCertificateChain(e.caStore,t,a)}catch(i){var n=i;(typeof n!="object"||V.util.isArray(n))&&(n={send:!0,alert:{level:m.Alert.Level.fatal,description:Mo(i)}}),"send"in n||(n.send=!0),"alert"in n||(n.alert={level:m.Alert.Level.fatal,description:Mo(n.error)}),e.error(e,n)}return!e.fail};m.createSessionCache=function(e,t){var a=null;if(e&&e.getSession&&e.setSession&&e.order)a=e;else{a={},a.cache=e||{},a.capacity=Math.max(t||100,1),a.order=[];for(var r in e)a.order.length<=t?a.order.push(r):delete e[r];a.getSession=function(n){var i=null,s=null;if(n?s=V.util.bytesToHex(n):a.order.length>0&&(s=a.order[0]),s!==null&&s in a.cache){i=a.cache[s],delete a.cache[s];for(var u in a.order)if(a.order[u]===s){a.order.splice(u,1);break}}return i},a.setSession=function(n,i){if(a.order.length===a.capacity){var s=a.order.shift();delete a.cache[s]}var s=V.util.bytesToHex(n);a.order.push(s),a.cache[s]=i}}return a};m.createConnection=function(e){var t=null;e.caStore?V.util.isArray(e.caStore)?t=V.pki.createCaStore(e.caStore):t=e.caStore:t=V.pki.createCaStore();var a=e.cipherSuites||null;if(a===null){a=[];for(var r in m.CipherSuites)a.push(m.CipherSuites[r])}var n=e.server?m.ConnectionEnd.server:m.ConnectionEnd.client,i=e.sessionCache?m.createSessionCache(e.sessionCache):null,s={version:{major:m.Version.major,minor:m.Version.minor},entity:n,sessionId:e.sessionId,caStore:t,sessionCache:i,cipherSuites:a,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(d,h,C,E){return h},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:V.util.createBuffer(),tlsData:V.util.createBuffer(),data:V.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(d,h){h.origin=h.origin||(d.entity===m.ConnectionEnd.client?"client":"server"),h.send&&(m.queue(d,m.createAlert(d,h.alert)),m.flush(d));var C=h.fatal!==!1;C&&(d.fail=!0),e.error(d,h),C&&d.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null};s.reset=function(d){s.version={major:m.Version.major,minor:m.Version.minor},s.record=null,s.session=null,s.peerCertificate=null,s.state={pending:null,current:null},s.expect=s.entity===m.ConnectionEnd.client?Cg:_g,s.fragmented=null,s.records=[],s.open=!1,s.handshakes=0,s.handshaking=!1,s.isConnected=!1,s.fail=!(d||typeof d=="undefined"),s.input.clear(),s.tlsData.clear(),s.data.clear(),s.state.current=m.createConnectionState(s)},s.reset();var u=function(d,h){var C=h.type-m.ContentType.change_cipher_spec,E=Vo[d.entity][d.expect];C in E?E[C](d,h):m.handleUnexpected(d,h)},f=function(d){var h=0,C=d.input,E=C.length();if(E<5)h=5-E;else{d.record={type:C.getByte(),version:{major:C.getByte(),minor:C.getByte()},length:C.getInt16(),fragment:V.util.createBuffer(),ready:!1};var v=d.record.version.major===d.version.major;v&&d.session&&d.session.version&&(v=d.record.version.minor===d.version.minor),v||d.error(d,{message:"Incompatible TLS version.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.protocol_version}})}return h},c=function(d){var h=0,C=d.input,E=C.length();if(E<d.record.length)h=d.record.length-E;else{d.record.fragment.putBytes(C.getBytes(d.record.length)),C.compact();var v=d.state.current.read;v.update(d,d.record)&&(d.fragmented!==null&&(d.fragmented.type===d.record.type?(d.fragmented.fragment.putBuffer(d.record.fragment),d.record=d.fragmented):d.error(d,{message:"Invalid fragmented record.",send:!0,alert:{level:m.Alert.Level.fatal,description:m.Alert.Description.unexpected_message}})),d.record.ready=!0)}return h};return s.handshake=function(d){if(s.entity!==m.ConnectionEnd.client)s.error(s,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(s.handshaking)s.error(s,{message:"Handshake already in progress.",fatal:!1});else{s.fail&&!s.open&&s.handshakes===0&&(s.fail=!1),s.handshaking=!0,d=d||"";var h=null;d.length>0&&(s.sessionCache&&(h=s.sessionCache.getSession(d)),h===null&&(d="")),d.length===0&&s.sessionCache&&(h=s.sessionCache.getSession(),h!==null&&(d=h.id)),s.session={id:d,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:V.md.md5.create(),sha1:V.md.sha1.create()},h&&(s.version=h.version,s.session.sp=h.sp),s.session.sp.client_random=m.createRandom().getBytes(),s.open=!0,m.queue(s,m.createRecord(s,{type:m.ContentType.handshake,data:m.createClientHello(s)})),m.flush(s)}},s.process=function(d){var h=0;return d&&s.input.putBytes(d),s.fail||(s.record!==null&&s.record.ready&&s.record.fragment.isEmpty()&&(s.record=null),s.record===null&&(h=f(s)),!s.fail&&s.record!==null&&!s.record.ready&&(h=c(s)),!s.fail&&s.record!==null&&s.record.ready&&u(s,s.record)),h},s.prepare=function(d){return m.queue(s,m.createRecord(s,{type:m.ContentType.application_data,data:V.util.createBuffer(d)})),m.flush(s)},s.prepareHeartbeatRequest=function(d,h){return d instanceof V.util.ByteBuffer&&(d=d.bytes()),typeof h=="undefined"&&(h=d.length),s.expectedHeartbeatPayload=d,m.queue(s,m.createRecord(s,{type:m.ContentType.heartbeat,data:m.createHeartbeat(m.HeartbeatMessageType.heartbeat_request,d,h)})),m.flush(s)},s.close=function(d){if(!s.fail&&s.sessionCache&&s.session){var h={id:s.session.id,version:s.session.version,sp:s.session.sp};h.sp.keys=null,s.sessionCache.setSession(h.id,h)}s.open&&(s.open=!1,s.input.clear(),(s.isConnected||s.handshaking)&&(s.isConnected=s.handshaking=!1,m.queue(s,m.createAlert(s,{level:m.Alert.Level.warning,description:m.Alert.Description.close_notify})),m.flush(s)),s.closed(s)),s.reset(d)},s};Fc.exports=V.tls=V.tls||{};for(cs in m)typeof m[cs]!="function"&&(V.tls[cs]=m[cs]);var cs;V.tls.prf_tls1=us;V.tls.hmac_sha1=gg;V.tls.createSessionCache=m.createSessionCache;V.tls.createConnection=m.createConnection});var Mc=ae((o1,qc)=>{var Wr=ue();Fr();Ko();var Ft=qc.exports=Wr.tls;Ft.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=Ft.BulkCipherAlgorithm.aes,e.cipher_type=Ft.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=Ft.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Vc};Ft.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=Ft.BulkCipherAlgorithm.aes,e.cipher_type=Ft.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=Ft.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Vc};function Vc(e,t,a){var r=t.entity===Wr.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:Wr.cipher.createDecipher("AES-CBC",r?a.keys.server_write_key:a.keys.client_write_key),iv:r?a.keys.server_write_IV:a.keys.client_write_IV},e.write.cipherState={init:!1,cipher:Wr.cipher.createCipher("AES-CBC",r?a.keys.client_write_key:a.keys.server_write_key),iv:r?a.keys.client_write_IV:a.keys.server_write_IV},e.read.cipherFunction=Vg,e.write.cipherFunction=Ug,e.read.macLength=e.write.macLength=a.mac_length,e.read.macFunction=e.write.macFunction=Ft.hmac_sha1}function Ug(e,t){var a=!1,r=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(r),t.updateSequenceNumber();var n;e.version.minor===Ft.Versions.TLS_1_0.minor?n=t.cipherState.init?null:t.cipherState.iv:n=Wr.random.getBytesSync(16),t.cipherState.init=!0;var i=t.cipherState.cipher;return i.start({iv:n}),e.version.minor>=Ft.Versions.TLS_1_1.minor&&i.output.putBytes(n),i.update(e.fragment),i.finish(Og)&&(e.fragment=i.output,e.length=e.fragment.length(),a=!0),a}function Og(e,t,a){if(!a){var r=e-t.length()%e;t.fillWithByte(r-1,r)}return!0}function Fg(e,t,a){var r=!0;if(a){for(var n=t.length(),i=t.last(),s=n-1-i;s<n-1;++s)r=r&&t.at(s)==i;r&&t.truncate(i+1)}return r}function Vg(e,t){var a=!1,r;e.version.minor===Ft.Versions.TLS_1_0.minor?r=t.cipherState.init?null:t.cipherState.iv:r=e.fragment.getBytes(16),t.cipherState.init=!0;var n=t.cipherState.cipher;n.start({iv:r}),n.update(e.fragment),a=n.finish(Fg);var i=t.macLength,s=Wr.random.getBytesSync(i),u=n.output.length();u>=i?(e.fragment=n.output.getBytes(u-i),s=n.output.getBytes(i)):e.fragment=n.output.getBytes(),e.fragment=Wr.util.createBuffer(e.fragment),e.length=e.fragment.length();var f=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),a=qg(t.macKey,s,f)&&a,a}function qg(e,t,a){var r=Wr.hmac.create();return r.start("SHA1",e),r.update(t),t=r.digest().getBytes(),r.start(null,null),r.update(a),a=r.digest().getBytes(),t===a}});var Wo=ae((u1,Wc)=>{var De=ue();Jt();me();var Kn=Wc.exports=De.sha512=De.sha512||{};De.md.sha512=De.md.algorithms.sha512=Kn;var Kc=De.sha384=De.sha512.sha384=De.sha512.sha384||{};Kc.create=function(){return Kn.create("SHA-384")};De.md.sha384=De.md.algorithms.sha384=Kc;De.sha512.sha256=De.sha512.sha256||{create:function(){return Kn.create("SHA-512/256")}};De.md["sha512/256"]=De.md.algorithms["sha512/256"]=De.sha512.sha256;De.sha512.sha224=De.sha512.sha224||{create:function(){return Kn.create("SHA-512/224")}};De.md["sha512/224"]=De.md.algorithms["sha512/224"]=De.sha512.sha224;Kn.create=function(e){if(Hc||Mg(),typeof e=="undefined"&&(e="SHA-512"),!(e in da))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=da[e],a=null,r=De.util.createBuffer(),n=new Array(80),i=0;i<80;++i)n[i]=new Array(2);var s=64;switch(e){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var u={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return u.start=function(){u.messageLength=0,u.fullMessageLength=u.messageLength128=[];for(var f=u.messageLengthSize/4,c=0;c<f;++c)u.fullMessageLength.push(0);r=De.util.createBuffer(),a=new Array(t.length);for(var c=0;c<t.length;++c)a[c]=t[c].slice(0);return u},u.start(),u.update=function(f,c){c==="utf8"&&(f=De.util.encodeUtf8(f));var d=f.length;u.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var h=u.fullMessageLength.length-1;h>=0;--h)u.fullMessageLength[h]+=d[1],d[1]=d[0]+(u.fullMessageLength[h]/4294967296>>>0),u.fullMessageLength[h]=u.fullMessageLength[h]>>>0,d[0]=d[1]/4294967296>>>0;return r.putBytes(f),zc(a,n,r),(r.read>2048||r.length()===0)&&r.compact(),u},u.digest=function(){var f=De.util.createBuffer();f.putBytes(r.bytes());var c=u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize,d=c&u.blockLength-1;f.putBytes(Ho.substr(0,u.blockLength-d));for(var h,C,E=u.fullMessageLength[0]*8,v=0;v<u.fullMessageLength.length-1;++v)h=u.fullMessageLength[v+1]*8,C=h/4294967296>>>0,E+=C,f.putInt32(E>>>0),E=h>>>0;f.putInt32(E);for(var _=new Array(a.length),v=0;v<a.length;++v)_[v]=a[v].slice(0);zc(_,n,f);var S=De.util.createBuffer(),b;e==="SHA-512"?b=_.length:e==="SHA-384"?b=_.length-2:b=_.length-4;for(var v=0;v<b;++v)S.putInt32(_[v][0]),(v!==b-1||e!=="SHA-512/224")&&S.putInt32(_[v][1]);return S},u};var Ho=null,Hc=!1,zo=null,da=null;function Mg(){Ho=String.fromCharCode(128),Ho+=De.util.fillString(String.fromCharCode(0),128),zo=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],da={},da["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],da["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],da["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],da["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Hc=!0}function zc(e,t,a){for(var r,n,i,s,u,f,c,d,h,C,E,v,_,S,b,A,w,P,k,N,G,q,Y,H,re,K,xe,Pe,Te,Ue,Z,$t,fr,qe,Oe,Me=a.length();Me>=128;){for(Te=0;Te<16;++Te)t[Te][0]=a.getInt32()>>>0,t[Te][1]=a.getInt32()>>>0;for(;Te<80;++Te)$t=t[Te-2],Ue=$t[0],Z=$t[1],r=((Ue>>>19|Z<<13)^(Z>>>29|Ue<<3)^Ue>>>6)>>>0,n=((Ue<<13|Z>>>19)^(Z<<3|Ue>>>29)^(Ue<<26|Z>>>6))>>>0,qe=t[Te-15],Ue=qe[0],Z=qe[1],i=((Ue>>>1|Z<<31)^(Ue>>>8|Z<<24)^Ue>>>7)>>>0,s=((Ue<<31|Z>>>1)^(Ue<<24|Z>>>8)^(Ue<<25|Z>>>7))>>>0,fr=t[Te-7],Oe=t[Te-16],Z=n+fr[1]+s+Oe[1],t[Te][0]=r+fr[0]+i+Oe[0]+(Z/4294967296>>>0)>>>0,t[Te][1]=Z>>>0;for(_=e[0][0],S=e[0][1],b=e[1][0],A=e[1][1],w=e[2][0],P=e[2][1],k=e[3][0],N=e[3][1],G=e[4][0],q=e[4][1],Y=e[5][0],H=e[5][1],re=e[6][0],K=e[6][1],xe=e[7][0],Pe=e[7][1],Te=0;Te<80;++Te)c=((G>>>14|q<<18)^(G>>>18|q<<14)^(q>>>9|G<<23))>>>0,d=((G<<18|q>>>14)^(G<<14|q>>>18)^(q<<23|G>>>9))>>>0,h=(re^G&(Y^re))>>>0,C=(K^q&(H^K))>>>0,u=((_>>>28|S<<4)^(S>>>2|_<<30)^(S>>>7|_<<25))>>>0,f=((_<<4|S>>>28)^(S<<30|_>>>2)^(S<<25|_>>>7))>>>0,E=(_&b|w&(_^b))>>>0,v=(S&A|P&(S^A))>>>0,Z=Pe+d+C+zo[Te][1]+t[Te][1],r=xe+c+h+zo[Te][0]+t[Te][0]+(Z/4294967296>>>0)>>>0,n=Z>>>0,Z=f+v,i=u+E+(Z/4294967296>>>0)>>>0,s=Z>>>0,xe=re,Pe=K,re=Y,K=H,Y=G,H=q,Z=N+n,G=k+r+(Z/4294967296>>>0)>>>0,q=Z>>>0,k=w,N=P,w=b,P=A,b=_,A=S,Z=n+s,_=r+i+(Z/4294967296>>>0)>>>0,S=Z>>>0;Z=e[0][1]+S,e[0][0]=e[0][0]+_+(Z/4294967296>>>0)>>>0,e[0][1]=Z>>>0,Z=e[1][1]+A,e[1][0]=e[1][0]+b+(Z/4294967296>>>0)>>>0,e[1][1]=Z>>>0,Z=e[2][1]+P,e[2][0]=e[2][0]+w+(Z/4294967296>>>0)>>>0,e[2][1]=Z>>>0,Z=e[3][1]+N,e[3][0]=e[3][0]+k+(Z/4294967296>>>0)>>>0,e[3][1]=Z>>>0,Z=e[4][1]+q,e[4][0]=e[4][0]+G+(Z/4294967296>>>0)>>>0,e[4][1]=Z>>>0,Z=e[5][1]+H,e[5][0]=e[5][0]+Y+(Z/4294967296>>>0)>>>0,e[5][1]=Z>>>0,Z=e[6][1]+K,e[6][0]=e[6][0]+re+(Z/4294967296>>>0)>>>0,e[6][1]=Z>>>0,Z=e[7][1]+Pe,e[7][0]=e[7][0]+xe+(Z/4294967296>>>0)>>>0,e[7][1]=Z>>>0,Me-=128}}});var Gc=ae(Go=>{var Kg=ue();Qt();var it=Kg.asn1;Go.privateKeyValidator={name:"PrivateKeyInfo",tagClass:it.Class.UNIVERSAL,type:it.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:it.Class.UNIVERSAL,type:it.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:it.Class.UNIVERSAL,type:it.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:it.Class.UNIVERSAL,type:it.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:it.Class.UNIVERSAL,type:it.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};Go.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:it.Class.UNIVERSAL,type:it.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:it.Class.UNIVERSAL,type:it.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:it.Class.UNIVERSAL,type:it.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:it.Class.UNIVERSAL,type:it.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var i0=ae((f1,n0)=>{var ft=ue();Fn();kt();Wo();me();var Qc=Gc(),Hg=Qc.publicKeyValidator,zg=Qc.privateKeyValidator;typeof jc=="undefined"&&(jc=ft.jsbn.BigInteger);var jc,Qo=ft.util.ByteBuffer,bt=typeof Buffer=="undefined"?Uint8Array:Buffer;ft.pki=ft.pki||{};n0.exports=ft.pki.ed25519=ft.ed25519=ft.ed25519||{};var ce=ft.ed25519;ce.constants={};ce.constants.PUBLIC_KEY_BYTE_LENGTH=32;ce.constants.PRIVATE_KEY_BYTE_LENGTH=64;ce.constants.SEED_BYTE_LENGTH=32;ce.constants.SIGN_BYTE_LENGTH=64;ce.constants.HASH_BYTE_LENGTH=64;ce.generateKeyPair=function(e){e=e||{};var t=e.seed;if(t===void 0)t=ft.random.getBytesSync(ce.constants.SEED_BYTE_LENGTH);else if(typeof t=="string"){if(t.length!==ce.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+ce.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=Er({message:t,encoding:"binary"});for(var a=new bt(ce.constants.PUBLIC_KEY_BYTE_LENGTH),r=new bt(ce.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)r[n]=t[n];return jg(a,r),{publicKey:a,privateKey:r}};ce.privateKeyFromAsn1=function(e){var t={},a=[],r=ft.asn1.validate(e,zg,t,a);if(!r){var n=new Error("Invalid Key.");throw n.errors=a,n}var i=ft.asn1.derToOid(t.privateKeyOid),s=ft.oids.EdDSA25519;if(i!==s)throw new Error('Invalid OID "'+i+'"; OID must be "'+s+'".');var u=t.privateKey,f=Er({message:ft.asn1.fromDer(u).value,encoding:"binary"});return{privateKeyBytes:f}};ce.publicKeyFromAsn1=function(e){var t={},a=[],r=ft.asn1.validate(e,Hg,t,a);if(!r){var n=new Error("Invalid Key.");throw n.errors=a,n}var i=ft.asn1.derToOid(t.publicKeyOid),s=ft.oids.EdDSA25519;if(i!==s)throw new Error('Invalid OID "'+i+'"; OID must be "'+s+'".');var u=t.ed25519PublicKey;if(u.length!==ce.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Er({message:u,encoding:"binary"})};ce.publicKeyFromPrivateKey=function(e){e=e||{};var t=Er({message:e.privateKey,encoding:"binary"});if(t.length!==ce.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+ce.constants.PRIVATE_KEY_BYTE_LENGTH);for(var a=new bt(ce.constants.PUBLIC_KEY_BYTE_LENGTH),r=0;r<a.length;++r)a[r]=t[32+r];return a};ce.sign=function(e){e=e||{};var t=Er(e),a=Er({message:e.privateKey,encoding:"binary"});if(a.length===ce.constants.SEED_BYTE_LENGTH){var r=ce.generateKeyPair({seed:a});a=r.privateKey}else if(a.length!==ce.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+ce.constants.SEED_BYTE_LENGTH+" or "+ce.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new bt(ce.constants.SIGN_BYTE_LENGTH+t.length);$g(n,t,t.length,a);for(var i=new bt(ce.constants.SIGN_BYTE_LENGTH),s=0;s<i.length;++s)i[s]=n[s];return i};ce.verify=function(e){e=e||{};var t=Er(e);if(e.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var a=Er({message:e.signature,encoding:"binary"});if(a.length!==ce.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+ce.constants.SIGN_BYTE_LENGTH);var r=Er({message:e.publicKey,encoding:"binary"});if(r.length!==ce.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+ce.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new bt(ce.constants.SIGN_BYTE_LENGTH+t.length),i=new bt(ce.constants.SIGN_BYTE_LENGTH+t.length),s;for(s=0;s<ce.constants.SIGN_BYTE_LENGTH;++s)n[s]=a[s];for(s=0;s<t.length;++s)n[s+ce.constants.SIGN_BYTE_LENGTH]=t[s];return Yg(i,n,n.length,r)>=0};function Er(e){var t=e.message;if(t instanceof Uint8Array||t instanceof bt)return t;var a=e.encoding;if(t===void 0)if(e.md)t=e.md.digest().getBytes(),a="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof t=="string"&&!a)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof t=="string"){if(typeof Buffer!="undefined")return Buffer.from(t,a);t=new Qo(t,a)}else if(!(t instanceof Qo))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var r=new bt(t.length()),n=0;n<r.length;++n)r[n]=t.at(n);return r}var jo=te(),ds=te([1]),Wg=te([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Gg=te([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),$c=te([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Yc=te([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$o=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),Qg=te([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Hn(e,t){var a=ft.md.sha512.create(),r=new Qo(e);a.update(r.getBytes(t),"binary");var n=a.digest().getBytes();if(typeof Buffer!="undefined")return Buffer.from(n,"binary");for(var i=new bt(ce.constants.HASH_BYTE_LENGTH),s=0;s<64;++s)i[s]=n.charCodeAt(s);return i}function jg(e,t){var a=[te(),te(),te(),te()],r,n=Hn(t,32);for(n[0]&=248,n[31]&=127,n[31]|=64,Jo(a,n),Zo(e,a),r=0;r<32;++r)t[r+32]=e[r];return 0}function $g(e,t,a,r){var n,i,s=new Float64Array(64),u=[te(),te(),te(),te()],f=Hn(r,32);f[0]&=248,f[31]&=127,f[31]|=64;var c=a+64;for(n=0;n<a;++n)e[64+n]=t[n];for(n=0;n<32;++n)e[32+n]=f[32+n];var d=Hn(e.subarray(32),a+32);for(Yo(d),Jo(u,d),Zo(e,u),n=32;n<64;++n)e[n]=r[n];var h=Hn(e,a+64);for(Yo(h),n=32;n<64;++n)s[n]=0;for(n=0;n<32;++n)s[n]=d[n];for(n=0;n<32;++n)for(i=0;i<32;i++)s[n+i]+=h[n]*f[i];return Xc(e.subarray(32),s),c}function Yg(e,t,a,r){var n,i,s=new bt(32),u=[te(),te(),te(),te()],f=[te(),te(),te(),te()];if(i=-1,a<64||Xg(f,r))return-1;for(n=0;n<a;++n)e[n]=t[n];for(n=0;n<32;++n)e[n+32]=r[n];var c=Hn(e,a);if(Yo(c),r0(u,f,c),Jo(f,t.subarray(32)),Xo(u,f),Zo(s,u),a-=64,e0(t,0,s,0)){for(n=0;n<a;++n)e[n]=0;return-1}for(n=0;n<a;++n)e[n]=t[n+64];return i=a,i}function Xc(e,t){var a,r,n,i;for(r=63;r>=32;--r){for(a=0,n=r-32,i=r-12;n<i;++n)t[n]+=a-16*t[r]*$o[n-(r-32)],a=t[n]+128>>8,t[n]-=a*256;t[n]+=a,t[r]=0}for(a=0,n=0;n<32;++n)t[n]+=a-(t[31]>>4)*$o[n],a=t[n]>>8,t[n]&=255;for(n=0;n<32;++n)t[n]-=a*$o[n];for(r=0;r<32;++r)t[r+1]+=t[r]>>8,e[r]=t[r]&255}function Yo(e){for(var t=new Float64Array(64),a=0;a<64;++a)t[a]=e[a],e[a]=0;Xc(e,t)}function Xo(e,t){var a=te(),r=te(),n=te(),i=te(),s=te(),u=te(),f=te(),c=te(),d=te();ja(a,e[1],e[0]),ja(d,t[1],t[0]),_e(a,a,d),Qa(r,e[0],e[1]),Qa(d,t[0],t[1]),_e(r,r,d),_e(n,e[3],t[3]),_e(n,n,Gg),_e(i,e[2],t[2]),Qa(i,i,i),ja(s,r,a),ja(u,i,n),Qa(f,i,n),Qa(c,r,a),_e(e[0],s,u),_e(e[1],c,f),_e(e[2],f,u),_e(e[3],s,c)}function Zc(e,t,a){for(var r=0;r<4;++r)a0(e[r],t[r],a)}function Zo(e,t){var a=te(),r=te(),n=te();tm(n,t[2]),_e(a,t[0],n),_e(r,t[1],n),hs(e,r),e[31]^=t0(a)<<7}function hs(e,t){var a,r,n,i=te(),s=te();for(a=0;a<16;++a)s[a]=t[a];for(eu(s),eu(s),eu(s),r=0;r<2;++r){for(i[0]=s[0]-65517,a=1;a<15;++a)i[a]=s[a]-65535-(i[a-1]>>16&1),i[a-1]&=65535;i[15]=s[15]-32767-(i[14]>>16&1),n=i[15]>>16&1,i[14]&=65535,a0(s,i,1-n)}for(a=0;a<16;a++)e[2*a]=s[a]&255,e[2*a+1]=s[a]>>8}function Xg(e,t){var a=te(),r=te(),n=te(),i=te(),s=te(),u=te(),f=te();return Gr(e[2],ds),Zg(e[1],t),ha(n,e[1]),_e(i,n,Wg),ja(n,n,e[2]),Qa(i,e[2],i),ha(s,i),ha(u,s),_e(f,u,s),_e(a,f,n),_e(a,a,i),Jg(a,a),_e(a,a,n),_e(a,a,i),_e(a,a,i),_e(e[0],a,i),ha(r,e[0]),_e(r,r,i),Jc(r,n)&&_e(e[0],e[0],Qg),ha(r,e[0]),_e(r,r,i),Jc(r,n)?-1:(t0(e[0])===t[31]>>7&&ja(e[0],jo,e[0]),_e(e[3],e[0],e[1]),0)}function Zg(e,t){var a;for(a=0;a<16;++a)e[a]=t[2*a]+(t[2*a+1]<<8);e[15]&=32767}function Jg(e,t){var a=te(),r;for(r=0;r<16;++r)a[r]=t[r];for(r=250;r>=0;--r)ha(a,a),r!==1&&_e(a,a,t);for(r=0;r<16;++r)e[r]=a[r]}function Jc(e,t){var a=new bt(32),r=new bt(32);return hs(a,e),hs(r,t),e0(a,0,r,0)}function e0(e,t,a,r){return em(e,t,a,r,32)}function em(e,t,a,r,n){var i,s=0;for(i=0;i<n;++i)s|=e[t+i]^a[r+i];return(1&s-1>>>8)-1}function t0(e){var t=new bt(32);return hs(t,e),t[0]&1}function r0(e,t,a){var r,n;for(Gr(e[0],jo),Gr(e[1],ds),Gr(e[2],ds),Gr(e[3],jo),n=255;n>=0;--n)r=a[n/8|0]>>(n&7)&1,Zc(e,t,r),Xo(t,e),Xo(e,e),Zc(e,t,r)}function Jo(e,t){var a=[te(),te(),te(),te()];Gr(a[0],$c),Gr(a[1],Yc),Gr(a[2],ds),_e(a[3],$c,Yc),r0(e,a,t)}function Gr(e,t){var a;for(a=0;a<16;a++)e[a]=t[a]|0}function tm(e,t){var a=te(),r;for(r=0;r<16;++r)a[r]=t[r];for(r=253;r>=0;--r)ha(a,a),r!==2&&r!==4&&_e(a,a,t);for(r=0;r<16;++r)e[r]=a[r]}function eu(e){var t,a,r=1;for(t=0;t<16;++t)a=e[t]+r+65535,r=Math.floor(a/65536),e[t]=a-r*65536;e[0]+=r-1+37*(r-1)}function a0(e,t,a){for(var r,n=~(a-1),i=0;i<16;++i)r=n&(e[i]^t[i]),e[i]^=r,t[i]^=r}function te(e){var t,a=new Float64Array(16);if(e)for(t=0;t<e.length;++t)a[t]=e[t];return a}function Qa(e,t,a){for(var r=0;r<16;++r)e[r]=t[r]+a[r]}function ja(e,t,a){for(var r=0;r<16;++r)e[r]=t[r]-a[r]}function ha(e,t){_e(e,t,t)}function _e(e,t,a){var r,n,i=0,s=0,u=0,f=0,c=0,d=0,h=0,C=0,E=0,v=0,_=0,S=0,b=0,A=0,w=0,P=0,k=0,N=0,G=0,q=0,Y=0,H=0,re=0,K=0,xe=0,Pe=0,Te=0,Ue=0,Z=0,$t=0,fr=0,qe=a[0],Oe=a[1],Me=a[2],Qe=a[3],Xe=a[4],Ze=a[5],Ie=a[6],Ae=a[7],Je=a[8],je=a[9],Be=a[10],He=a[11],ze=a[12],$e=a[13],et=a[14],Ye=a[15];r=t[0],i+=r*qe,s+=r*Oe,u+=r*Me,f+=r*Qe,c+=r*Xe,d+=r*Ze,h+=r*Ie,C+=r*Ae,E+=r*Je,v+=r*je,_+=r*Be,S+=r*He,b+=r*ze,A+=r*$e,w+=r*et,P+=r*Ye,r=t[1],s+=r*qe,u+=r*Oe,f+=r*Me,c+=r*Qe,d+=r*Xe,h+=r*Ze,C+=r*Ie,E+=r*Ae,v+=r*Je,_+=r*je,S+=r*Be,b+=r*He,A+=r*ze,w+=r*$e,P+=r*et,k+=r*Ye,r=t[2],u+=r*qe,f+=r*Oe,c+=r*Me,d+=r*Qe,h+=r*Xe,C+=r*Ze,E+=r*Ie,v+=r*Ae,_+=r*Je,S+=r*je,b+=r*Be,A+=r*He,w+=r*ze,P+=r*$e,k+=r*et,N+=r*Ye,r=t[3],f+=r*qe,c+=r*Oe,d+=r*Me,h+=r*Qe,C+=r*Xe,E+=r*Ze,v+=r*Ie,_+=r*Ae,S+=r*Je,b+=r*je,A+=r*Be,w+=r*He,P+=r*ze,k+=r*$e,N+=r*et,G+=r*Ye,r=t[4],c+=r*qe,d+=r*Oe,h+=r*Me,C+=r*Qe,E+=r*Xe,v+=r*Ze,_+=r*Ie,S+=r*Ae,b+=r*Je,A+=r*je,w+=r*Be,P+=r*He,k+=r*ze,N+=r*$e,G+=r*et,q+=r*Ye,r=t[5],d+=r*qe,h+=r*Oe,C+=r*Me,E+=r*Qe,v+=r*Xe,_+=r*Ze,S+=r*Ie,b+=r*Ae,A+=r*Je,w+=r*je,P+=r*Be,k+=r*He,N+=r*ze,G+=r*$e,q+=r*et,Y+=r*Ye,r=t[6],h+=r*qe,C+=r*Oe,E+=r*Me,v+=r*Qe,_+=r*Xe,S+=r*Ze,b+=r*Ie,A+=r*Ae,w+=r*Je,P+=r*je,k+=r*Be,N+=r*He,G+=r*ze,q+=r*$e,Y+=r*et,H+=r*Ye,r=t[7],C+=r*qe,E+=r*Oe,v+=r*Me,_+=r*Qe,S+=r*Xe,b+=r*Ze,A+=r*Ie,w+=r*Ae,P+=r*Je,k+=r*je,N+=r*Be,G+=r*He,q+=r*ze,Y+=r*$e,H+=r*et,re+=r*Ye,r=t[8],E+=r*qe,v+=r*Oe,_+=r*Me,S+=r*Qe,b+=r*Xe,A+=r*Ze,w+=r*Ie,P+=r*Ae,k+=r*Je,N+=r*je,G+=r*Be,q+=r*He,Y+=r*ze,H+=r*$e,re+=r*et,K+=r*Ye,r=t[9],v+=r*qe,_+=r*Oe,S+=r*Me,b+=r*Qe,A+=r*Xe,w+=r*Ze,P+=r*Ie,k+=r*Ae,N+=r*Je,G+=r*je,q+=r*Be,Y+=r*He,H+=r*ze,re+=r*$e,K+=r*et,xe+=r*Ye,r=t[10],_+=r*qe,S+=r*Oe,b+=r*Me,A+=r*Qe,w+=r*Xe,P+=r*Ze,k+=r*Ie,N+=r*Ae,G+=r*Je,q+=r*je,Y+=r*Be,H+=r*He,re+=r*ze,K+=r*$e,xe+=r*et,Pe+=r*Ye,r=t[11],S+=r*qe,b+=r*Oe,A+=r*Me,w+=r*Qe,P+=r*Xe,k+=r*Ze,N+=r*Ie,G+=r*Ae,q+=r*Je,Y+=r*je,H+=r*Be,re+=r*He,K+=r*ze,xe+=r*$e,Pe+=r*et,Te+=r*Ye,r=t[12],b+=r*qe,A+=r*Oe,w+=r*Me,P+=r*Qe,k+=r*Xe,N+=r*Ze,G+=r*Ie,q+=r*Ae,Y+=r*Je,H+=r*je,re+=r*Be,K+=r*He,xe+=r*ze,Pe+=r*$e,Te+=r*et,Ue+=r*Ye,r=t[13],A+=r*qe,w+=r*Oe,P+=r*Me,k+=r*Qe,N+=r*Xe,G+=r*Ze,q+=r*Ie,Y+=r*Ae,H+=r*Je,re+=r*je,K+=r*Be,xe+=r*He,Pe+=r*ze,Te+=r*$e,Ue+=r*et,Z+=r*Ye,r=t[14],w+=r*qe,P+=r*Oe,k+=r*Me,N+=r*Qe,G+=r*Xe,q+=r*Ze,Y+=r*Ie,H+=r*Ae,re+=r*Je,K+=r*je,xe+=r*Be,Pe+=r*He,Te+=r*ze,Ue+=r*$e,Z+=r*et,$t+=r*Ye,r=t[15],P+=r*qe,k+=r*Oe,N+=r*Me,G+=r*Qe,q+=r*Xe,Y+=r*Ze,H+=r*Ie,re+=r*Ae,K+=r*Je,xe+=r*je,Pe+=r*Be,Te+=r*He,Ue+=r*ze,Z+=r*$e,$t+=r*et,fr+=r*Ye,i+=38*k,s+=38*N,u+=38*G,f+=38*q,c+=38*Y,d+=38*H,h+=38*re,C+=38*K,E+=38*xe,v+=38*Pe,_+=38*Te,S+=38*Ue,b+=38*Z,A+=38*$t,w+=38*fr,n=1,r=i+n+65535,n=Math.floor(r/65536),i=r-n*65536,r=s+n+65535,n=Math.floor(r/65536),s=r-n*65536,r=u+n+65535,n=Math.floor(r/65536),u=r-n*65536,r=f+n+65535,n=Math.floor(r/65536),f=r-n*65536,r=c+n+65535,n=Math.floor(r/65536),c=r-n*65536,r=d+n+65535,n=Math.floor(r/65536),d=r-n*65536,r=h+n+65535,n=Math.floor(r/65536),h=r-n*65536,r=C+n+65535,n=Math.floor(r/65536),C=r-n*65536,r=E+n+65535,n=Math.floor(r/65536),E=r-n*65536,r=v+n+65535,n=Math.floor(r/65536),v=r-n*65536,r=_+n+65535,n=Math.floor(r/65536),_=r-n*65536,r=S+n+65535,n=Math.floor(r/65536),S=r-n*65536,r=b+n+65535,n=Math.floor(r/65536),b=r-n*65536,r=A+n+65535,n=Math.floor(r/65536),A=r-n*65536,r=w+n+65535,n=Math.floor(r/65536),w=r-n*65536,r=P+n+65535,n=Math.floor(r/65536),P=r-n*65536,i+=n-1+37*(n-1),n=1,r=i+n+65535,n=Math.floor(r/65536),i=r-n*65536,r=s+n+65535,n=Math.floor(r/65536),s=r-n*65536,r=u+n+65535,n=Math.floor(r/65536),u=r-n*65536,r=f+n+65535,n=Math.floor(r/65536),f=r-n*65536,r=c+n+65535,n=Math.floor(r/65536),c=r-n*65536,r=d+n+65535,n=Math.floor(r/65536),d=r-n*65536,r=h+n+65535,n=Math.floor(r/65536),h=r-n*65536,r=C+n+65535,n=Math.floor(r/65536),C=r-n*65536,r=E+n+65535,n=Math.floor(r/65536),E=r-n*65536,r=v+n+65535,n=Math.floor(r/65536),v=r-n*65536,r=_+n+65535,n=Math.floor(r/65536),_=r-n*65536,r=S+n+65535,n=Math.floor(r/65536),S=r-n*65536,r=b+n+65535,n=Math.floor(r/65536),b=r-n*65536,r=A+n+65535,n=Math.floor(r/65536),A=r-n*65536,r=w+n+65535,n=Math.floor(r/65536),w=r-n*65536,r=P+n+65535,n=Math.floor(r/65536),P=r-n*65536,i+=n-1+37*(n-1),e[0]=i,e[1]=s,e[2]=u,e[3]=f,e[4]=c,e[5]=d,e[6]=h,e[7]=C,e[8]=E,e[9]=v,e[10]=_,e[11]=S,e[12]=b,e[13]=A,e[14]=w,e[15]=P}});var l0=ae((c1,u0)=>{var It=ue();me();kt();Fn();u0.exports=It.kem=It.kem||{};var s0=It.jsbn.BigInteger;It.kem.rsa={};It.kem.rsa.create=function(e,t){t=t||{};var a=t.prng||It.random,r={};return r.encrypt=function(n,i){var s=Math.ceil(n.n.bitLength()/8),u;do u=new s0(It.util.bytesToHex(a.getBytesSync(s)),16).mod(n.n);while(u.compareTo(s0.ONE)<=0);u=It.util.hexToBytes(u.toString(16));var f=s-u.length;f>0&&(u=It.util.fillString(String.fromCharCode(0),f)+u);var c=n.encrypt(u,"NONE"),d=e.generate(u,i);return{encapsulation:c,key:d}},r.decrypt=function(n,i,s){var u=n.decrypt(i,"NONE");return e.generate(u,s)},r};It.kem.kdf1=function(e,t){o0(this,e,0,t||e.digestLength)};It.kem.kdf2=function(e,t){o0(this,e,1,t||e.digestLength)};function o0(e,t,a,r){e.generate=function(n,i){for(var s=new It.util.ByteBuffer,u=Math.ceil(i/r)+a,f=new It.util.ByteBuffer,c=a;c<u;++c){f.putInt32(c),t.start(),t.update(n+f.getBytes());var d=t.digest();s.putBytes(d.getBytes(r))}return s.truncate(s.length()-i),s.getBytes()}}});var h0=ae((d1,d0)=>{var he=ue();me();d0.exports=he.log=he.log||{};he.log.levels=["none","error","warning","info","debug","verbose","max"];var ps={},tu=[],zn=null;he.log.LEVEL_LOCKED=1<<1;he.log.NO_LEVEL_CHECK=1<<2;he.log.INTERPOLATE=1<<3;for(or=0;or<he.log.levels.length;++or)ru=he.log.levels[or],ps[ru]={index:or,name:ru.toUpperCase()};var ru,or;he.log.logMessage=function(e){for(var t=ps[e.level].index,a=0;a<tu.length;++a){var r=tu[a];if(r.flags&he.log.NO_LEVEL_CHECK)r.f(e);else{var n=ps[r.level].index;t<=n&&r.f(r,e)}}};he.log.prepareStandard=function(e){"standard"in e||(e.standard=ps[e.level].name+" ["+e.category+"] "+e.message)};he.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]),e.full=he.util.format.apply(this,t)}};he.log.prepareStandardFull=function(e){"standardFull"in e||(he.log.prepareStandard(e),e.standardFull=e.standard)};for(au=["error","warning","info","debug","verbose"],or=0;or<au.length;++or)(function(t){he.log[t]=function(a,r){var n=Array.prototype.slice.call(arguments).slice(2),i={timestamp:new Date,level:t,category:a,message:r,arguments:n};he.log.logMessage(i)}})(au[or]);var au,or;he.log.makeLogger=function(e){var t={flags:0,f:e};return he.log.setLevel(t,"none"),t};he.log.setLevel=function(e,t){var a=!1;if(e&&!(e.flags&he.log.LEVEL_LOCKED))for(var r=0;r<he.log.levels.length;++r){var n=he.log.levels[r];if(t==n){e.level=t,a=!0;break}}return a};he.log.lock=function(e,t){typeof t=="undefined"||t?e.flags|=he.log.LEVEL_LOCKED:e.flags&=~he.log.LEVEL_LOCKED};he.log.addLogger=function(e){tu.push(e)};typeof console!="undefined"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(f0={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},Wn=function(e,t){he.log.prepareStandard(t);var a=f0[t.level],r=[t.standard];r=r.concat(t.arguments.slice()),a.apply(console,r)},$a=he.log.makeLogger(Wn)):(Wn=function(t,a){he.log.prepareStandardFull(a),console.log(a.standardFull)},$a=he.log.makeLogger(Wn)),he.log.setLevel($a,"debug"),he.log.addLogger($a),zn=$a):console={log:function(){}};var $a,f0,Wn;zn!==null&&(typeof window!="undefined"&&window.location?pa=new URL(window.location.href).searchParams:pa=new URLSearchParams,pa.has("console.level")&&he.log.setLevel(zn,pa.get("console.level").slice(-1)[0]),pa.has("console.lock")&&(c0=pa.get("console.lock").slice(-1)[0],c0=="true"&&he.log.lock(zn)));var pa,c0;he.log.consoleLogger=zn});var y0=ae((h1,p0)=>{p0.exports=Jt();Qi();Ka();go();Wo()});var v0=ae((p1,m0)=>{var W=ue();Fr();Qt();Un();Vr();sa();Ro();kt();me();os();var I=W.asn1,gt=m0.exports=W.pkcs7=W.pkcs7||{};gt.messageFromPem=function(e){var t=W.pem.decode(e)[0];if(t.type!=="PKCS7"){var a=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var r=I.fromDer(t.body);return gt.messageFromAsn1(r)};gt.messageToPem=function(e,t){var a={type:"PKCS7",body:I.toDer(e.toAsn1()).getBytes()};return W.pem.encode(a,{maxline:t})};gt.messageFromAsn1=function(e){var t={},a=[];if(!I.validate(e,gt.asn1.contentInfoValidator,t,a)){var r=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw r.errors=a,r}var n=I.derToOid(t.contentType),i;switch(n){case W.pki.oids.envelopedData:i=gt.createEnvelopedData();break;case W.pki.oids.encryptedData:i=gt.createEncryptedData();break;case W.pki.oids.signedData:i=gt.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return i.fromAsn1(t.content.value[0]),i};gt.createSignedData=function(){var e=null;return e={type:W.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(r){if(iu(e,r,gt.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var n=e.rawCapture.certificates.value,i=0;i<n.length;++i)e.certificates.push(W.pki.certificateFromAsn1(n[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var r=[],n=0;n<e.certificates.length;++n)r.push(W.pki.certificateToAsn1(e.certificates[n]));var i=[],s=I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return r.length>0&&s.value[0].value.push(I.create(I.Class.CONTEXT_SPECIFIC,0,!0,r)),i.length>0&&s.value[0].value.push(I.create(I.Class.CONTEXT_SPECIFIC,1,!0,i)),s.value[0].value.push(I.create(I.Class.UNIVERSAL,I.Type.SET,!0,e.signerInfos)),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.type).getBytes()),s])},addSigner:function(r){var n=r.issuer,i=r.serialNumber;if(r.certificate){var s=r.certificate;typeof s=="string"&&(s=W.pki.certificateFromPem(s)),n=s.issuer.attributes,i=s.serialNumber}var u=r.key;if(!u)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof u=="string"&&(u=W.pki.privateKeyFromPem(u));var f=r.digestAlgorithm||W.pki.oids.sha1;switch(f){case W.pki.oids.sha1:case W.pki.oids.sha256:case W.pki.oids.sha384:case W.pki.oids.sha512:case W.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+f)}var c=r.authenticatedAttributes||[];if(c.length>0){for(var d=!1,h=!1,C=0;C<c.length;++C){var E=c[C];if(!d&&E.type===W.pki.oids.contentType){if(d=!0,h)break;continue}if(!h&&E.type===W.pki.oids.messageDigest){if(h=!0,d)break;continue}}if(!d||!h)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:u,version:1,issuer:n,serialNumber:i,digestAlgorithm:f,signatureAlgorithm:W.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(r){if(r=r||{},(typeof e.content!="object"||e.contentInfo===null)&&(e.contentInfo=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(W.pki.oids.data).getBytes())]),"content"in e)){var n;e.content instanceof W.util.ByteBuffer?n=e.content.bytes():typeof e.content=="string"&&(n=W.util.encodeUtf8(e.content)),r.detached?e.detachedContent=I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,n):e.contentInfo.value.push(I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,n)]))}if(e.signers.length!==0){var i=t();a(i)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(r){typeof r=="string"&&(r=W.pki.certificateFromPem(r)),e.certificates.push(r)},addCertificateRevokationList:function(r){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var r={},n=0;n<e.signers.length;++n){var i=e.signers[n],s=i.digestAlgorithm;s in r||(r[s]=W.md[W.pki.oids[s]].create()),i.authenticatedAttributes.length===0?i.md=r[s]:i.md=W.md[W.pki.oids[s]].create()}e.digestAlgorithmIdentifiers=[];for(var s in r)e.digestAlgorithmIdentifiers.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(s).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]));return r}function a(r){var n;if(e.detachedContent?n=e.detachedContent:(n=e.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i=I.derToOid(e.contentInfo.value[0].value),s=I.toDer(n);s.getByte(),I.getBerValueLength(s),s=s.getBytes();for(var u in r)r[u].start().update(s);for(var f=new Date,c=0;c<e.signers.length;++c){var d=e.signers[c];if(d.authenticatedAttributes.length===0){if(i!==W.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[]),C=0;C<d.authenticatedAttributes.length;++C){var E=d.authenticatedAttributes[C];E.type===W.pki.oids.messageDigest?E.value=r[d.digestAlgorithm].digest():E.type===W.pki.oids.signingTime&&(E.value||(E.value=f)),h.value.push(nu(E)),d.authenticatedAttributesAsn1.value.push(nu(E))}s=I.toDer(h).getBytes(),d.md.start().update(s)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=om(e.signers)}};gt.createEncryptedData=function(){var e=null;return e={type:W.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:W.pki.oids["aes256-CBC"]},fromAsn1:function(t){iu(e,t,gt.asn1.encryptedDataValidator)},decrypt:function(t){t!==void 0&&(e.encryptedContent.key=t),g0(e)}},e};gt.createEnvelopedData=function(){var e=null;return e={type:W.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:W.pki.oids["aes256-CBC"]},fromAsn1:function(t){var a=iu(e,t,gt.asn1.envelopedDataValidator);e.recipients=nm(a.recipientInfos.value)},toAsn1:function(){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.type).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,im(e.recipients)),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,um(e.encryptedContent))])])])},findRecipient:function(t){for(var a=t.issuer.attributes,r=0;r<e.recipients.length;++r){var n=e.recipients[r],i=n.issuer;if(n.serialNumber===t.serialNumber&&i.length===a.length){for(var s=!0,u=0;u<a.length;++u)if(i[u].type!==a[u].type||i[u].value!==a[u].value){s=!1;break}if(s)return n}}return null},decrypt:function(t,a){if(e.encryptedContent.key===void 0&&t!==void 0&&a!==void 0)switch(t.encryptedContent.algorithm){case W.pki.oids.rsaEncryption:case W.pki.oids.desCBC:var r=a.decrypt(t.encryptedContent.content);e.encryptedContent.key=W.util.createBuffer(r);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}g0(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:W.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,a){if(e.encryptedContent.content===void 0){a=a||e.encryptedContent.algorithm,t=t||e.encryptedContent.key;var r,n,i;switch(a){case W.pki.oids["aes128-CBC"]:r=16,n=16,i=W.aes.createEncryptionCipher;break;case W.pki.oids["aes192-CBC"]:r=24,n=16,i=W.aes.createEncryptionCipher;break;case W.pki.oids["aes256-CBC"]:r=32,n=16,i=W.aes.createEncryptionCipher;break;case W.pki.oids["des-EDE3-CBC"]:r=24,n=8,i=W.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+a)}if(t===void 0)t=W.util.createBuffer(W.random.getBytes(r));else if(t.length()!=r)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+r+".");e.encryptedContent.algorithm=a,e.encryptedContent.key=t,e.encryptedContent.parameter=W.util.createBuffer(W.random.getBytes(n));var s=i(t);if(s.start(e.encryptedContent.parameter.copy()),s.update(e.content),!s.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=s.output}for(var u=0;u<e.recipients.length;++u){var f=e.recipients[u];if(f.encryptedContent.content===void 0)switch(f.encryptedContent.algorithm){case W.pki.oids.rsaEncryption:f.encryptedContent.content=f.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+f.encryptedContent.algorithm)}}}},e};function rm(e){var t={},a=[];if(!I.validate(e,gt.asn1.recipientInfoValidator,t,a)){var r=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw r.errors=a,r}return{version:t.version.charCodeAt(0),issuer:W.pki.RDNAttributesAsArray(t.issuer),serialNumber:W.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:I.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function am(e){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[W.pki.distinguishedNameToAsn1({attributes:e.issuer}),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,W.util.hexToBytes(e.serialNumber))]),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.encryptedContent.algorithm).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function nm(e){for(var t=[],a=0;a<e.length;++a)t.push(rm(e[a]));return t}function im(e){for(var t=[],a=0;a<e.length;++a)t.push(am(e[a]));return t}function sm(e){var t=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[W.pki.distinguishedNameToAsn1({attributes:e.issuer}),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,W.util.hexToBytes(e.serialNumber))]),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.digestAlgorithm).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.signatureAlgorithm).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")])),t.value.push(I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var a=I.create(I.Class.CONTEXT_SPECIFIC,1,!0,[]),r=0;r<e.unauthenticatedAttributes.length;++r){var n=e.unauthenticatedAttributes[r];a.values.push(nu(n))}t.value.push(a)}return t}function om(e){for(var t=[],a=0;a<e.length;++a)t.push(sm(e[a]));return t}function nu(e){var t;if(e.type===W.pki.oids.contentType)t=I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.value).getBytes());else if(e.type===W.pki.oids.messageDigest)t=I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===W.pki.oids.signingTime){var a=new Date("1950-01-01T00:00:00Z"),r=new Date("2050-01-01T00:00:00Z"),n=e.value;if(typeof n=="string"){var i=Date.parse(n);isNaN(i)?n.length===13?n=I.utcTimeToDate(n):n=I.generalizedTimeToDate(n):n=new Date(i)}n>=a&&n<r?t=I.create(I.Class.UNIVERSAL,I.Type.UTCTIME,!1,I.dateToUtcTime(n)):t=I.create(I.Class.UNIVERSAL,I.Type.GENERALIZEDTIME,!1,I.dateToGeneralizedTime(n))}return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.type).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[t])])}function um(e){return[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(W.pki.oids.data).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.algorithm).getBytes()),e.parameter?I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.parameter.getBytes()):void 0]),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.content.getBytes())])]}function iu(e,t,a){var r={},n=[];if(!I.validate(t,a,r,n)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw i.errors=i,i}var s=I.derToOid(r.contentType);if(s!==W.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(r.encryptedContent){var u="";if(W.util.isArray(r.encryptedContent))for(var f=0;f<r.encryptedContent.length;++f){if(r.encryptedContent[f].type!==I.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");u+=r.encryptedContent[f].value}else u=r.encryptedContent;e.encryptedContent={algorithm:I.derToOid(r.encAlgorithm),parameter:W.util.createBuffer(r.encParameter.value),content:W.util.createBuffer(u)}}if(r.content){var u="";if(W.util.isArray(r.content))for(var f=0;f<r.content.length;++f){if(r.content[f].type!==I.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");u+=r.content[f].value}else u=r.content;e.content=W.util.createBuffer(u)}return e.version=r.version.charCodeAt(0),e.rawCapture=r,r}function g0(e){if(e.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(e.content===void 0){var t;switch(e.encryptedContent.algorithm){case W.pki.oids["aes128-CBC"]:case W.pki.oids["aes192-CBC"]:case W.pki.oids["aes256-CBC"]:t=W.aes.createDecryptionCipher(e.encryptedContent.key);break;case W.pki.oids.desCBC:case W.pki.oids["des-EDE3-CBC"]:t=W.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}});var S0=ae((y1,C0)=>{var Ge=ue();Fr();Fa();Qi();Ka();me();var ys=C0.exports=Ge.ssh=Ge.ssh||{};ys.privateKeyToPutty=function(e,t,a){a=a||"",t=t||"";var r="ssh-rsa",n=t===""?"none":"aes256-cbc",i="PuTTY-User-Key-File-2: "+r+`\r
`;i+="Encryption: "+n+`\r
`,i+="Comment: "+a+`\r
`;var s=Ge.util.createBuffer();Ya(s,r),ur(s,e.e),ur(s,e.n);var u=Ge.util.encode64(s.bytes(),64),f=Math.floor(u.length/66)+1;i+="Public-Lines: "+f+`\r
`,i+=u;var c=Ge.util.createBuffer();ur(c,e.d),ur(c,e.p),ur(c,e.q),ur(c,e.qInv);var d;if(!t)d=Ge.util.encode64(c.bytes(),64);else{var h=c.length()+16-1;h-=h%16;var C=gs(c.bytes());C.truncate(C.length()-h+c.length()),c.putBuffer(C);var E=Ge.util.createBuffer();E.putBuffer(gs("\0\0\0\0",t)),E.putBuffer(gs("\0\0\0",t));var v=Ge.aes.createEncryptionCipher(E.truncate(8),"CBC");v.start(Ge.util.createBuffer().fillWithByte(0,16)),v.update(c.copy()),v.finish();var _=v.output;_.truncate(16),d=Ge.util.encode64(_.bytes(),64)}f=Math.floor(d.length/66)+1,i+=`\r
Private-Lines: `+f+`\r
`,i+=d;var S=gs("putty-private-key-file-mac-key",t),b=Ge.util.createBuffer();Ya(b,r),Ya(b,n),Ya(b,a),b.putInt32(s.length()),b.putBuffer(s),b.putInt32(c.length()),b.putBuffer(c);var A=Ge.hmac.create();return A.start("sha1",S),A.update(b.bytes()),i+=`\r
Private-MAC: `+A.digest().toHex()+`\r
`,i};ys.publicKeyToOpenSSH=function(e,t){var a="ssh-rsa";t=t||"";var r=Ge.util.createBuffer();return Ya(r,a),ur(r,e.e),ur(r,e.n),a+" "+Ge.util.encode64(r.bytes())+" "+t};ys.privateKeyToOpenSSH=function(e,t){return t?Ge.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):Ge.pki.privateKeyToPem(e)};ys.getPublicKeyFingerprint=function(e,t){t=t||{};var a=t.md||Ge.md.md5.create(),r="ssh-rsa",n=Ge.util.createBuffer();Ya(n,r),ur(n,e.e),ur(n,e.n),a.start(),a.update(n.getBytes());var i=a.digest();if(t.encoding==="hex"){var s=i.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return i.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return i};function ur(e,t){var a=t.toString(16);a[0]>="8"&&(a="00"+a);var r=Ge.util.hexToBytes(a);e.putInt32(r.length),e.putBytes(r)}function Ya(e,t){e.putInt32(t.length),e.putString(t)}function gs(){for(var e=Ge.md.sha1.create(),t=arguments.length,a=0;a<t;++a)e.update(arguments[a]);return e.digest()}});var b0=ae((g1,E0)=>{E0.exports=ue();Fr();Mc();Qt();qi();Un();i0();Fa();l0();h0();y0();No();Xi();sa();Ao();Po();v0();Uo();Io();mo();ns();kt();So();S0();Ko();me()});var uu=ae(Za=>{Za.icondir="icons";var ou={amazon:[],aws:["amazonaws"],authy:[],bitcoin:[],circle:[],cloudflare:[],coinbase:[],dashlane:[],digitalocean:[],discord:[],dropbox:[],ea:[],evernote:[],facebook:[],github:[],gmail:[],google:["google apps"],heroku:[],hootsuite:[],hubspot:[],ifttt:[],kickstarter:[],lastpass:[],linode:[],logmein:[],mailchimp:[],microsoft:[],okta:[],salesforce:[],slack:[],snapchat:[],stripe:[],teamviewer:[],tumblr:[],twitch:[],twitter:[],wordpress:[],npm:[],twilio:[],synology:[],namecheap:[]};Za.logos=[...Object.keys(ou),...Object.values(ou).flat()];Za.logoAliases=Object.entries(ou).reduce((e,[t,a])=>{if(a.length)for(let r of a)e[r]=t;return e},{});Za.genericColors=[{name:"black",value:"#464646"},{name:"blue",value:"#098FCE"},{name:"green",value:"#3DA329"},{name:"orange",value:"#F59E27"},{name:"purple",value:"#7408B4"},{name:"red",value:"#DF1112"}];Za.icons=["key"]});var xm={};Sl(xm,{default:()=>ms});var Gn=require("react"),k0=require("@raycast/api");var Jr=require("@raycast/api"),wr="services",Rr="apps",hr="requestId",pr="deviceId",yr="secretSeed",vn="authyId";async function Nr(e){return await(0,Jr.getLocalStorageItem)(e)!=null}async function Ht(e){let t=await(0,Jr.getLocalStorageItem)(e);if(t!=null)return JSON.parse(t);throw new Error(`${e} not found`)}async function Xt(e,t){return await(0,Jr.setLocalStorageItem)(e,JSON.stringify(t))}async function Rt(e){return await(0,Jr.removeLocalStorageItem)(e)}var w0=require("react");var Da=require("url"),rf=dt(require("crypto")),to=dt(require("os"));var ef=dt(require("http"),1),tf=dt(require("https"),1),na=dt(require("zlib"),1),At=dt(require("stream"),1);function ih(e){if(!/^data:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');e=e.replace(/\r?\n/g,"");let t=e.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let a=e.substring(5,t).split(";"),r="",n=!1,i=a[0]||"text/plain",s=i;for(let d=1;d<a.length;d++)a[d]==="base64"?n=!0:(s+=`;${a[d]}`,a[d].indexOf("charset=")===0&&(r=a[d].substring(8)));!a[0]&&!r.length&&(s+=";charset=US-ASCII",r="US-ASCII");let u=n?"base64":"ascii",f=unescape(e.substring(t+1)),c=Buffer.from(f,u);return c.type=i,c.typeFull=s,c.charset=r,c}var xl=ih;var zt=dt(require("stream"),1),La=require("util");Sn();$s();var Lr=class extends Error{constructor(t,a){super(t);Error.captureStackTrace(this,this.constructor),this.type=a}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var Lt=class extends Lr{constructor(t,a,r){super(t,a);r&&(this.code=this.errno=r.code,this.erroredSysCall=r.syscall)}};var Ii=Symbol.toStringTag,Ys=e=>typeof e=="object"&&typeof e.append=="function"&&typeof e.delete=="function"&&typeof e.get=="function"&&typeof e.getAll=="function"&&typeof e.has=="function"&&typeof e.set=="function"&&typeof e.sort=="function"&&e[Ii]==="URLSearchParams",An=e=>e&&typeof e=="object"&&typeof e.arrayBuffer=="function"&&typeof e.type=="string"&&typeof e.stream=="function"&&typeof e.constructor=="function"&&/^(Blob|File)$/.test(e[Ii]),Pl=e=>typeof e=="object"&&(e[Ii]==="AbortSignal"||e[Ii]==="EventTarget");var Ct=Symbol("Body internals"),mr=class{constructor(t,{size:a=0}={}){let r=null;t===null?t=null:Ys(t)?t=Buffer.from(t.toString()):An(t)||Buffer.isBuffer(t)||(La.types.isAnyArrayBuffer(t)?t=Buffer.from(t):ArrayBuffer.isView(t)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof zt.default||(t instanceof Ra?(t=Ll(t),r=t.type.split("=")[1]):t=Buffer.from(String(t))));let n=t;Buffer.isBuffer(t)?n=zt.default.Readable.from(t):An(t)&&(n=zt.default.Readable.from(t.stream())),this[Ct]={body:t,stream:n,boundary:r,disturbed:!1,error:null},this.size=a,t instanceof zt.default&&t.on("error",i=>{let s=i instanceof Lr?i:new Lt(`Invalid response body while trying to fetch ${this.url}: ${i.message}`,"system",i);this[Ct].error=s})}get body(){return this[Ct].stream}get bodyUsed(){return this[Ct].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:a,byteLength:r}=await Ri(this);return t.slice(a,a+r)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let r=new Ra,n=new URLSearchParams(await this.text());for(let[i,s]of n)r.append(i,s);return r}let{toFormData:a}=await Promise.resolve().then(()=>(ql(),Vl));return a(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[Ct].body&&this[Ct].body.type||"",a=await this.buffer();return new ea([a],{type:t})}async json(){let t=await Ri(this);return JSON.parse(t.toString())}async text(){return(await Ri(this)).toString()}buffer(){return Ri(this)}};mr.prototype.buffer=(0,La.deprecate)(mr.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(mr.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});async function Ri(e){if(e[Ct].disturbed)throw new TypeError(`body used already for: ${e.url}`);if(e[Ct].disturbed=!0,e[Ct].error)throw e[Ct].error;let{body:t}=e;if(t===null||!(t instanceof zt.default))return Buffer.alloc(0);let a=[],r=0;try{for await(let n of t){if(e.size>0&&r+n.length>e.size){let i=new Lt(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(i),i}r+=n.length,a.push(n)}}catch(n){throw n instanceof Lr?n:new Lt(`Invalid response body while trying to fetch ${e.url}: ${n.message}`,"system",n)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return a.every(n=>typeof n=="string")?Buffer.from(a.join("")):Buffer.concat(a,r)}catch(n){throw new Lt(`Could not create Buffer from response body for ${e.url}: ${n.message}`,"system",n)}else throw new Lt(`Premature close of server response while trying to fetch ${e.url}`)}var ka=(e,t)=>{let a,r,{body:n}=e[Ct];if(e.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof zt.default&&typeof n.getBoundary!="function"&&(a=new zt.PassThrough({highWaterMark:t}),r=new zt.PassThrough({highWaterMark:t}),n.pipe(a),n.pipe(r),e[Ct].stream=a,n=r),n},xh=(0,La.deprecate)(e=>e.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Ni=(e,t)=>e===null?null:typeof e=="string"?"text/plain;charset=UTF-8":Ys(e)?"application/x-www-form-urlencoded;charset=UTF-8":An(e)?e.type||null:Buffer.isBuffer(e)||La.types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e instanceof Ra?`multipart/form-data; boundary=${t[Ct].boundary}`:e&&typeof e.getBoundary=="function"?`multipart/form-data;boundary=${xh(e)}`:e instanceof zt.default?null:"text/plain;charset=UTF-8",Ml=e=>{let{body:t}=e[Ct];return t===null?0:An(t)?t.size:Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},Kl=(e,{body:t})=>{t===null?e.end():t.pipe(e)};var Zs=require("util"),Bn=dt(require("http"),1),Li=typeof Bn.default.validateHeaderName=="function"?Bn.default.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let t=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},Js=typeof Bn.default.validateHeaderValue=="function"?Bn.default.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let a=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(a,"code",{value:"ERR_INVALID_CHAR"}),a}},Tt=class extends URLSearchParams{constructor(t){let a=[];if(t instanceof Tt){let r=t.raw();for(let[n,i]of Object.entries(r))a.push(...i.map(s=>[n,s]))}else if(t!=null)if(typeof t=="object"&&!Zs.types.isBoxedPrimitive(t)){let r=t[Symbol.iterator];if(r==null)a.push(...Object.entries(t));else{if(typeof r!="function")throw new TypeError("Header pairs must be iterable");a=[...t].map(n=>{if(typeof n!="object"||Zs.types.isBoxedPrimitive(n))throw new TypeError("Each header pair must be an iterable object");return[...n]}).map(n=>{if(n.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...n]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");a=a.length>0?a.map(([r,n])=>(Li(r),Js(r,String(n)),[String(r).toLowerCase(),String(n)])):void 0;super(a);return new Proxy(this,{get(r,n,i){switch(n){case"append":case"set":return(s,u)=>(Li(s),Js(s,String(u)),URLSearchParams.prototype[n].call(r,String(s).toLowerCase(),String(u)));case"delete":case"has":case"getAll":return s=>(Li(s),URLSearchParams.prototype[n].call(r,String(s).toLowerCase()));case"keys":return()=>(r.sort(),new Set(URLSearchParams.prototype.keys.call(r)).keys());default:return Reflect.get(r,n,i)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let a=this.getAll(t);if(a.length===0)return null;let r=a.join(", ");return/^content-encoding$/i.test(t)&&(r=r.toLowerCase()),r}forEach(t,a=void 0){for(let r of this.keys())Reflect.apply(t,a,[this.get(r),r,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,a)=>(t[a]=this.getAll(a),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,a)=>{let r=this.getAll(a);return a==="host"?t[a]=r[0]:t[a]=r.length>1?r:r[0],t},{})}};Object.defineProperties(Tt.prototype,["get","entries","forEach","values"].reduce((e,t)=>(e[t]={enumerable:!0},e),{}));function Hl(e=[]){return new Tt(e.reduce((t,a,r,n)=>(r%2===0&&t.push(n.slice(r,r+2)),t),[]).filter(([t,a])=>{try{return Li(t),Js(t,String(a)),!0}catch{return!1}}))}var Th=new Set([301,302,303,307,308]),ki=e=>Th.has(e);var Wt=Symbol("Response internals"),St=class extends mr{constructor(t=null,a={}){super(t,a);let r=a.status!=null?a.status:200,n=new Tt(a.headers);if(t!==null&&!n.has("Content-Type")){let i=Ni(t,this);i&&n.append("Content-Type",i)}this[Wt]={type:"default",url:a.url,status:r,statusText:a.statusText||"",headers:n,counter:a.counter,highWaterMark:a.highWaterMark}}get type(){return this[Wt].type}get url(){return this[Wt].url||""}get status(){return this[Wt].status}get ok(){return this[Wt].status>=200&&this[Wt].status<300}get redirected(){return this[Wt].counter>0}get statusText(){return this[Wt].statusText}get headers(){return this[Wt].headers}get highWaterMark(){return this[Wt].highWaterMark}clone(){return new St(ka(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,a=302){if(!ki(a))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new St(null,{headers:{location:new URL(t).toString()},status:a})}static error(){let t=new St(null,{status:0,statusText:""});return t[Wt].type="error",t}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(St.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Zl=require("url");var zl=e=>{if(e.search)return e.search;let t=e.href.length-1,a=e.hash||(e.href[t]==="#"?"#":"");return e.href[t-a.length]==="?"?"?":""};var Wl=require("net");function Gl(e,t=!1){return e==null||(e=new URL(e),/^(about|blob|data):$/.test(e.protocol))?"no-referrer":(e.username="",e.password="",e.hash="",t&&(e.pathname="",e.search=""),e)}var Ql=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),jl="strict-origin-when-cross-origin";function $l(e){if(!Ql.has(e))throw new TypeError(`Invalid referrerPolicy: ${e}`);return e}function Ah(e){if(/^(http|ws)s:$/.test(e.protocol))return!0;let t=e.host.replace(/(^\[)|(]$)/g,""),a=(0,Wl.isIP)(t);return a===4&&/^127\./.test(t)||a===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:/^(.+\.)*localhost$/.test(e.host)?!1:e.protocol==="file:"}function Pa(e){return/^about:(blank|srcdoc)$/.test(e)||e.protocol==="data:"||/^(blob|filesystem):$/.test(e.protocol)?!0:Ah(e)}function Yl(e,{referrerURLCallback:t,referrerOriginCallback:a}={}){if(e.referrer==="no-referrer"||e.referrerPolicy==="")return null;let r=e.referrerPolicy;if(e.referrer==="about:client")return"no-referrer";let n=e.referrer,i=Gl(n),s=Gl(n,!0);i.toString().length>4096&&(i=s),t&&(i=t(i)),a&&(s=a(s));let u=new URL(e.url);switch(r){case"no-referrer":return"no-referrer";case"origin":return s;case"unsafe-url":return i;case"strict-origin":return Pa(i)&&!Pa(u)?"no-referrer":s.toString();case"strict-origin-when-cross-origin":return i.origin===u.origin?i:Pa(i)&&!Pa(u)?"no-referrer":s;case"same-origin":return i.origin===u.origin?i:"no-referrer";case"origin-when-cross-origin":return i.origin===u.origin?i:s;case"no-referrer-when-downgrade":return Pa(i)&&!Pa(u)?"no-referrer":i;default:throw new TypeError(`Invalid referrerPolicy: ${r}`)}}function Xl(e){let t=(e.get("referrer-policy")||"").split(/[,\s]+/),a="";for(let r of t)r&&Ql.has(r)&&(a=r);return a}var tt=Symbol("Request internals"),Pi=e=>typeof e=="object"&&typeof e[tt]=="object",Pr=class extends mr{constructor(t,a={}){let r;if(Pi(t)?r=new URL(t.url):(r=new URL(t),t={}),r.username!==""||r.password!=="")throw new TypeError(`${r} is an url with embedded credentails.`);let n=a.method||t.method||"GET";if(n=n.toUpperCase(),(a.body!=null||Pi(t))&&t.body!==null&&(n==="GET"||n==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let i=a.body?a.body:Pi(t)&&t.body!==null?ka(t):null;super(i,{size:a.size||t.size||0});let s=new Tt(a.headers||t.headers||{});if(i!==null&&!s.has("Content-Type")){let c=Ni(i,this);c&&s.set("Content-Type",c)}let u=Pi(t)?t.signal:null;if("signal"in a&&(u=a.signal),u!=null&&!Pl(u))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let f=a.referrer==null?t.referrer:a.referrer;if(f==="")f="no-referrer";else if(f){let c=new URL(f);f=/^about:(\/\/)?client$/.test(c)?"client":c}else f=void 0;this[tt]={method:n,redirect:a.redirect||t.redirect||"follow",headers:s,parsedURL:r,signal:u,referrer:f},this.follow=a.follow===void 0?t.follow===void 0?20:t.follow:a.follow,this.compress=a.compress===void 0?t.compress===void 0?!0:t.compress:a.compress,this.counter=a.counter||t.counter||0,this.agent=a.agent||t.agent,this.highWaterMark=a.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=a.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=a.referrerPolicy||t.referrerPolicy||""}get method(){return this[tt].method}get url(){return(0,Zl.format)(this[tt].parsedURL)}get headers(){return this[tt].headers}get redirect(){return this[tt].redirect}get signal(){return this[tt].signal}get referrer(){if(this[tt].referrer==="no-referrer")return"";if(this[tt].referrer==="client")return"about:client";if(this[tt].referrer)return this[tt].referrer.toString()}get referrerPolicy(){return this[tt].referrerPolicy}set referrerPolicy(t){this[tt].referrerPolicy=$l(t)}clone(){return new Pr(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Pr.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var Jl=e=>{let{parsedURL:t}=e[tt],a=new Tt(e[tt].headers);a.has("Accept")||a.set("Accept","*/*");let r=null;if(e.body===null&&/^(post|put)$/i.test(e.method)&&(r="0"),e.body!==null){let u=Ml(e);typeof u=="number"&&!Number.isNaN(u)&&(r=String(u))}r&&a.set("Content-Length",r),e.referrerPolicy===""&&(e.referrerPolicy=jl),e.referrer&&e.referrer!=="no-referrer"?e[tt].referrer=Yl(e):e[tt].referrer="no-referrer",e[tt].referrer instanceof URL&&a.set("Referer",e.referrer),a.has("User-Agent")||a.set("User-Agent","node-fetch"),e.compress&&!a.has("Accept-Encoding")&&a.set("Accept-Encoding","gzip,deflate,br");let{agent:n}=e;typeof n=="function"&&(n=n(t)),!a.has("Connection")&&!n&&a.set("Connection","close");let i=zl(t),s={path:t.pathname+i,method:e.method,headers:a[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:n};return{parsedURL:t,options:s}};var eo=class extends Lr{constructor(t,a="aborted"){super(t,a)}};var _h=new Set(["data:","http:","https:"]);async function Dr(e,t){return new Promise((a,r)=>{let n=new Pr(e,t),{parsedURL:i,options:s}=Jl(n);if(!_h.has(i.protocol))throw new TypeError(`node-fetch cannot load ${e}. URL scheme "${i.protocol.replace(/:$/,"")}" is not supported.`);if(i.protocol==="data:"){let v=xl(n.url),_=new St(v,{headers:{"Content-Type":v.typeFull}});a(_);return}let u=(i.protocol==="https:"?tf.default:ef.default).request,{signal:f}=n,c=null,d=()=>{let v=new eo("The operation was aborted.");r(v),n.body&&n.body instanceof At.default.Readable&&n.body.destroy(v),!(!c||!c.body)&&c.body.emit("error",v)};if(f&&f.aborted){d();return}let h=()=>{d(),E()},C=u(i,s);f&&f.addEventListener("abort",h);let E=()=>{C.abort(),f&&f.removeEventListener("abort",h)};C.on("error",v=>{r(new Lt(`request to ${n.url} failed, reason: ${v.message}`,"system",v)),E()}),Ih(C,v=>{c.body.destroy(v)}),process.version<"v14"&&C.on("socket",v=>{let _;v.prependListener("end",()=>{_=v._eventsCount}),v.prependListener("close",S=>{if(c&&_<v._eventsCount&&!S){let b=new Error("Premature close");b.code="ERR_STREAM_PREMATURE_CLOSE",c.body.emit("error",b)}})}),C.on("response",v=>{C.setTimeout(0);let _=Hl(v.rawHeaders);if(ki(v.statusCode)){let P=_.get("Location"),k=P===null?null:new URL(P,n.url);switch(n.redirect){case"error":r(new Lt(`uri requested responds with a redirect, redirect mode is set to error: ${n.url}`,"no-redirect")),E();return;case"manual":k!==null&&_.set("Location",k);break;case"follow":{if(k===null)break;if(n.counter>=n.follow){r(new Lt(`maximum redirect reached at: ${n.url}`,"max-redirect")),E();return}let N={headers:new Tt(n.headers),follow:n.follow,counter:n.counter+1,agent:n.agent,compress:n.compress,method:n.method,body:ka(n),signal:n.signal,size:n.size,referrer:n.referrer,referrerPolicy:n.referrerPolicy};if(v.statusCode!==303&&n.body&&t.body instanceof At.default.Readable){r(new Lt("Cannot follow redirect with body being a readable stream","unsupported-redirect")),E();return}(v.statusCode===303||(v.statusCode===301||v.statusCode===302)&&n.method==="POST")&&(N.method="GET",N.body=void 0,N.headers.delete("content-length"));let G=Xl(_);G&&(N.referrerPolicy=G),a(Dr(new Pr(k,N))),E();return}default:return r(new TypeError(`Redirect option '${n.redirect}' is not a valid value of RequestRedirect`))}}f&&v.once("end",()=>{f.removeEventListener("abort",h)});let S=(0,At.pipeline)(v,new At.PassThrough,r);process.version<"v12.10"&&v.on("aborted",h);let b={url:n.url,status:v.statusCode,statusText:v.statusMessage,headers:_,size:n.size,counter:n.counter,highWaterMark:n.highWaterMark},A=_.get("Content-Encoding");if(!n.compress||n.method==="HEAD"||A===null||v.statusCode===204||v.statusCode===304){c=new St(S,b),a(c);return}let w={flush:na.default.Z_SYNC_FLUSH,finishFlush:na.default.Z_SYNC_FLUSH};if(A==="gzip"||A==="x-gzip"){S=(0,At.pipeline)(S,na.default.createGunzip(w),r),c=new St(S,b),a(c);return}if(A==="deflate"||A==="x-deflate"){(0,At.pipeline)(v,new At.PassThrough,r).once("data",k=>{S=(k[0]&15)===8?(0,At.pipeline)(S,na.default.createInflate(),r):(0,At.pipeline)(S,na.default.createInflateRaw(),r),c=new St(S,b),a(c)});return}if(A==="br"){S=(0,At.pipeline)(S,na.default.createBrotliDecompress(),r),c=new St(S,b),a(c);return}c=new St(S,b),a(c)}),Kl(C,n)})}function Ih(e,t){let a=Buffer.from(`0\r
\r
`),r=!1,n=!1,i;e.on("response",s=>{let{headers:u}=s;r=u["transfer-encoding"]==="chunked"&&!u["content-length"]}),e.on("socket",s=>{let u=()=>{if(r&&!n){let f=new Error("Premature close");f.code="ERR_STREAM_PREMATURE_CLOSE",t(f)}};s.prependListener("close",u),e.on("abort",()=>{s.removeListener("close",u)}),s.on("data",f=>{n=Buffer.compare(f.slice(-5),a)===0,!n&&i&&(n=Buffer.compare(i.slice(-3),a.slice(0,3))===0&&Buffer.compare(f.slice(-2),a.slice(3))===0),i=f})})}var wn="https://api.authy.com/json",Rn="37b312a3d682b823c439522e1fd31c82",Nn=rf.default.randomBytes(32).toString("hex");async function af(e){let t=new Da.URLSearchParams;t.set("api_key",Rn),t.set("via","push"),t.set("device_app","Raycast Authy Extension"),t.set("device_name",`Raycast Authy Extension on ${to.default.hostname()}`),t.set("signature",Nn);let a=await Dr(`${wn}/users/${e}/devices/registration/start`,{method:"POST",body:t});if(a.ok)return await a.json();throw new Error((await a.json()).message)}async function nf(e,t){let a=new Da.URLSearchParams;a.set("api_key",Rn),a.set("signature",Nn),a.set("locale","en-GB");let r=await Dr(`${wn}/users/${e}/devices/registration/${t}/status?`+a,{method:"GET"});if(r.ok)return await r.json();{let n=await r.json();throw new Error(n.message)}}async function sf(e,t){let a=new Da.URLSearchParams;a.set("pin",t),a.set("api_key",Rn),a.set("signature",Nn),a.set("device_app","Raycast Authy Extension"),a.set("device_name",`Raycast Authy Extension on ${to.default.hostname()}`);let r=await Dr(`${wn}/users/${e}/devices/registration/complete`,{method:"POST",body:a});if(r.ok)return await r.json();throw new Error((await r.json()).message)}async function Di(e,t,a){let r=new Da.URLSearchParams;r.set("api_key",Rn),r.set("signature",Nn),r.set("device_id",`${t}`),r.set("locale","en-GB"),r.set("otp1",`${a[0]}`),r.set("otp2",`${a[1]}`),r.set("otp3",`${a[2]}`);let n=await Dr(`${wn}/users/${e}/devices/${t}/apps/sync`,{method:"POST",body:r});if(n.ok)return await n.json();throw new Error((await n.json()).message)}async function Ui(e,t,a){let r=new Da.URLSearchParams;r.set("api_key",Rn),r.set("signature",Nn),r.set("device_id",`${t}`),r.set("apps",""),r.set("otp1",`${a[0]}`),r.set("otp2",`${a[1]}`),r.set("otp3",`${a[2]}`);let n=await Dr(`${wn}/users/${e}/authenticator_tokens?`+r);if(n.ok)return await n.json();throw new Error((await n.json()).message)}var Ce=require("@raycast/api");var A0=dt(Fi()),lr=dt(b0());var x0=require("crypto"),T0=dt(Fi());function lm(e,t){let a=(0,x0.createHmac)("sha1",e),r=Buffer.alloc(8);return r.writeBigInt64BE(t),a.update(r),a.digest()}function fm(e,t){let a=e[e.length-1]&15;return(e.slice(a,a+4).readUInt32BE()&2147483647)%Math.pow(10,t)}function ya(e,t){let a=t.timestamp||new Date().getTime();a=Math.floor(a/1e3/t.period);let r=T0.decode.asBytes(e.toUpperCase());return fm(lm(Buffer.from(r),BigInt(a)),t.digits).toString().padStart(t.digits,"0")}function Xa(e){let t=(0,A0.encode)(Buffer.from(e,"hex")),a=new Date;return[ya(t,{digits:7,period:10,timestamp:a.getTime()}),ya(t,{digits:7,period:10,timestamp:a.getTime()+10*1e3}),ya(t,{digits:7,period:10,timestamp:a.getTime()+10*2*1e3})]}function _0(e,t,a){let r=B0(t,a,e,!1);if((r===null||!I0(r))&&(r=B0(t,a,e,!0),r===null||!I0(r)))throw new Error("Couldn't decrypt service tokens. Seems like Backup Password is wrong");return r}function I0(e){return e.replace(/-|\s/g,"").match(/^[a-zA-Z2-7]+=*$/)!==null}function cm(e,t,a){return a.decodeSalt&&(t=lr.default.util.hexToBytes(t)),a.withoutEncoding?lr.default.pkcs5.pbkdf2(e,t,a.iterations,a.keySize):lr.default.pkcs5.pbkdf2(unescape(encodeURIComponent(e)),t,a.iterations,a.keySize)}function dm(e,t){let a=lr.default.util.createBuffer(lr.default.util.decodeUtf8("\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0")),r=lr.default.util.createBuffer(e),n=lr.default.util.createBuffer(lr.default.util.decode64(t)),i=lr.default.cipher.createDecipher("AES-CBC",r);return i.start({iv:a}),i.update(n),i.finish()?i.output.data:null}function B0(e,t,a,r){let n=cm(t,e,{iterations:1e3,keySize:32,decodeSalt:!1,withoutEncoding:r});return dm(n,a)}var hm=`
## Approval request has been sent
To continue approve request at any other device and press \u23CE to continue.

![approve](file://${Ce.environment.assetsPath}/approve.png)

Or press \u2318 + \u23CE to start this process from scratch 
`;async function pm(){let e=await(0,Ce.showToast)(Ce.ToastStyle.Animated,"Authy","Waiting for Approval");try{if(!await Nr(hr)){let{authyId:a}=(0,Ce.getPreferenceValues)(),r=await af(a);await Xt(hr,r.request_id)}}catch(t){if(t instanceof Error)await e.hide(),await(0,Ce.showToast)(Ce.ToastStyle.Failure,"Authy",t.message);else throw t}}async function ym(e){let t=await(0,Ce.showToast)(Ce.ToastStyle.Animated,"Checking request status");try{let{authyId:a}=(0,Ce.getPreferenceValues)();if(!await Nr(pr)||!await Nr(yr)){let u=await Ht(hr),f=await nf(a,u);if(f.status=="rejected"&&(await t.hide(),await(0,Ce.showToast)(Ce.ToastStyle.Failure,"Authy","Seems like you rejected registration request"),await Rt(hr)),f.status=="pending")return await t.hide(),await(0,Ce.showToast)(Ce.ToastStyle.Failure,"Authy","Seems like you didn't approve registration request"),Promise.resolve();let c=await sf(a,f.pin);await Xt(pr,c.device.id),await Xt(yr,c.device.secret_seed)}let r=await Ht(pr),n=await Ht(yr),i=await Di(a,r,Xa(n));await Xt(Rr,i);let s=await Ui(a,r,Xa(n));return await Xt(wr,s),await Xt(vn,a),e(!0),await t.hide(),await(0,Ce.showToast)(Ce.ToastStyle.Success,"Authy","Success Login"),Promise.resolve()}catch(a){if(a instanceof Error)await Rt(hr),await t.hide(),await(0,Ce.showToast)(Ce.ToastStyle.Failure,"Authy",a.message);else throw a}}async function gm(){await Rt(hr),await Rt(pr),await Rt(yr),await(0,Ce.render)(_jsx(ms,null))}function su(e){return(0,w0.useEffect)(()=>{(async()=>await pm())()}),_jsx(Ce.Detail,{markdown:`${hm}`,actions:_jsx(Ce.ActionPanel,null,_jsx(Ce.SubmitFormAction,{icon:Ce.Icon.Clipboard,title:"Agree",onSubmit:()=>ym(e.setLogin)}),_jsx(Ce.ActionPanel.Item,{icon:Ce.Icon.ExclamationMark,title:"Start From Scratch",onAction:gm}))})}var ot=require("@raycast/api"),Ss=require("react");var N0=dt(Fi());var ga=e=>e.trim().toLocaleLowerCase(),vs=(e,t)=>ga(e).localeCompare(ga(t));var en=require("react");var st=require("@raycast/api"),fu=dt(uu());var Ja=require("@raycast/api"),Vt=dt(uu());var mm=["logo","accountType","name"],vm=Vt.genericColors.map(e=>`authenticator_${e.name}`);function Cm(e){if(typeof e!="string")return;let t=ga(e);if(vm.includes(t))return`${Ja.environment.assetsPath}/${Vt.icondir}/${lu}.png`;if(Vt.logos.includes(t)){let a=Vt.logoAliases[t]||t;return{source:{light:`${Ja.environment.assetsPath}/${Vt.icondir}/light/brand/${a}.png`,dark:`${Ja.environment.assetsPath}/${Vt.icondir}/dark/brand/${a}.png`}}}}function lu(e){if(e===void 0)return`${Ja.environment.assetsPath}/${Vt.icondir}/authenticator_blue.png`;for(let t of mm){let a=Cm(e[t]);if(a)return a}return`${Ja.environment.assetsPath}/${Vt.icondir}/authenticator_blue.png`}var{primaryActionIsCopy:R0}=(0,st.getPreferenceValues)();function Sm({pin:e}){return R0?_jsx(st.CopyToClipboardAction,{title:"Copy OTP",content:e}):_jsx(st.PasteAction,{title:"Output OTP",content:e})}function Em({pin:e}){return R0?_jsx(st.PasteAction,{title:"Output OTP",content:e}):_jsx(st.CopyToClipboardAction,{title:"Copy OTP",content:e})}function cu({item:e,basis:t,timeLeft:a,refresh:r}){let n=e.generate(),i=e.issuer||e.accountType||"",s=i.match("authenticator")||!vs(i,e.name)?"":i,u=`pie-${t===30?a:a*3}`;return _jsx(st.List.Item,{title:e.name,accessoryTitle:`${n}`,subtitle:s,accessoryIcon:{source:{light:`${st.environment.assetsPath}/${fu.icondir}/light/${u}.png`,dark:`${st.environment.assetsPath}/${fu.icondir}/dark/${u}.png`}},icon:lu(e),keywords:[i],actions:_jsx(st.ActionPanel,null,_jsx(Sm,{pin:n??""}),_jsx(Em,{pin:n??""}),_jsx(st.ActionPanel.Item,{title:"Sync",icon:st.Icon.ArrowClockwise,shortcut:{modifiers:["cmd"],key:"r"},onAction:()=>r()}))})}function Cs(e){return e-new Date().getSeconds()%e}function du({items:e,refresh:t}){let[{timeLeft10:a,timeLeft30:r},n]=(0,en.useState)({timeLeft10:Cs(10),timeLeft30:Cs(30)});return(0,en.useEffect)(()=>{let i=setInterval(()=>new Date().getMilliseconds()<250&&n({timeLeft10:Cs(10),timeLeft30:Cs(30)}),250);return()=>clearInterval(i)},[]),_jsx(en.Fragment,null,e.sort((i,s)=>vs(i.name,s.name)).map((i,s)=>_jsx(cu,{key:s,item:i,basis:i.type==="service"?30:10,timeLeft:i.type==="service"?r:a,refresh:t})))}var{preferCustomName:bm}=(0,ot.getPreferenceValues)();function L0(e){let[{apps:t,services:a},r]=(0,Ss.useState)({apps:[],services:[]});async function n(){let f=await(0,ot.showToast)(ot.ToastStyle.Animated,"Authy","Refreshing");await f.show(),r({apps:[],services:[]});try{let{authyId:c}=(0,ot.getPreferenceValues)(),d=await Ht(pr),h=await Ht(yr),C=await Di(c,d,Xa(h));await Xt(Rr,C);let E=await Ui(c,d,Xa(h));await Xt(wr,E)}catch(c){if(c instanceof Error)await(0,ot.showToast)(ot.ToastStyle.Failure,"Authy",c.message),await(0,ot.popToRoot)();else throw c}await i(),await f.hide(),await(0,ot.showToast)(ot.ToastStyle.Success,"Authy","Data was successful refreshed")}async function i(){try{if(!e.isLogin)return;let f=await Ht(wr),c=await Ht(Rr),{authyPassword:d,excludeNames:h=""}=(0,ot.getPreferenceValues)(),C=f.authenticator_tokens.map(v=>{let _=_0(v.encrypted_seed,v.salt,d);return{type:"service",name:bm?v.name||v.original_name:v.original_name||v.name,accountType:v.account_type,issuer:v.issuer,logo:v.logo,digits:v.digits,generate:()=>ya(_,{digits:v.digits,period:30})}}),E=c.apps.map(v=>({type:"app",name:v.name,digits:v.digits,generate:()=>ya((0,N0.encode)(Buffer.from(v.secret_seed,"hex")),{digits:v.digits,period:10})}));if(h){let v=h.split(",").map(ga).filter(Boolean),_=({name:S})=>!v.includes(ga(S));C=C.filter(_),E=E.filter(_)}r({apps:E,services:C})}catch(f){if(f instanceof Error)await(0,ot.showToast)(ot.ToastStyle.Failure,"Authy",f.message);else throw f}}(0,Ss.useEffect)(()=>{i()},[e.isLogin]);let s=[...t,...a],u=s.length===0;return _jsx(ot.List,{searchBarPlaceholder:"Search",isLoading:u},_jsx(du,{refresh:n,items:s}))}function ms(){let[e,t]=(0,Gn.useState)();return(0,Gn.useEffect)(()=>{async function a(){let r=await Nr(wr),n=await Nr(Rr);t(r||n)}a()},[]),(0,Gn.useEffect)(()=>{async function a(){if(await Nr(vn)){let{authyId:n}=(0,k0.getPreferenceValues)(),i=await Ht(vn);n!=i&&(await Rt(yr),await Rt(pr),await Rt(wr),await Rt(Rr),await Rt(hr),t(!1))}}a()}),e==!1?_jsx(su,{setLogin:t}):_jsx(L0,{isLogin:e,setLogin:t})}module.exports=nh(xm);0&&(module.exports={});
/*
 * [hi-base32]{@link https://github.com/emn178/hi-base32}
 *
 * @version 0.5.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */
/*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */
/*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */
